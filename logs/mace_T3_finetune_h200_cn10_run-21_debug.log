2025-07-28 15:07:33.070 INFO: ===========VERIFYING SETTINGS===========
2025-07-28 15:07:33.070 INFO: MACE version: 0.3.13
2025-07-28 15:07:33.070 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=4, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=61, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-28 15:07:33.605 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-28 15:07:33.816 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 15:07:33.901 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 15:07:34.181 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-28 15:07:35.545 DEBUG: Current Git commit: 3dffafbc60bfd9a4c8a29135bf65ce152e41c510
2025-07-28 15:07:36.101 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-28 15:07:36.108 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-28 15:07:36.108 INFO: ===========LOADING INPUT DATA===========
2025-07-28 15:07:36.108 INFO: Using heads: ['Default']
2025-07-28 15:07:36.108 INFO: Using the key specifications to parse data:
2025-07-28 15:07:36.108 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-28 15:07:36.108 INFO: =============    Processing head Default     ===========
2025-07-28 15:07:37.479 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz
2025-07-28 15:07:46.192 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 15:07:46.198 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 15:07:53.011 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 15:07:53.014 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 15:07:53.014 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-07-28 15:07:53.111 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-28 15:07:53.111 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-28 15:07:53.111 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-28 15:07:53.111 INFO: Processing datasets for head 'Default'
2025-07-28 15:08:12.721 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz']
2025-07-28 15:08:12.721 INFO: Combining 1 list datasets for head 'Default'
2025-07-28 15:08:21.503 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-28 15:08:21.503 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-28 15:08:21.504 INFO: Combined validation datasets for Default
2025-07-28 15:08:21.504 INFO: Head 'Default' training dataset size: 1612
2025-07-28 15:08:21.504 INFO: Computing average number of neighbors
2025-07-28 15:08:23.011 INFO: Average number of neighbors: 67.30184267634576
2025-07-28 15:08:23.011 INFO: During training the following quantities will be reported: energy, forces
2025-07-28 15:08:23.011 INFO: ===========MODEL DETAILS===========
2025-07-28 15:08:24.306 INFO: Loading FOUNDATION model
2025-07-28 15:08:24.307 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-28 15:08:24.307 INFO: Model configuration extracted from foundation model
2025-07-28 15:08:24.307 INFO: Using universal loss function for fine-tuning
2025-07-28 15:08:24.307 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-28 15:08:24.307 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-28 15:08:24.307 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-28 15:08:24.307 INFO: Distance transform for radial basis functions: None
2025-07-28 15:08:25.665 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-28 15:08:25.666 INFO: Total number of parameters: 894362
2025-07-28 15:08:25.666 INFO: 
2025-07-28 15:08:25.666 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-28 15:08:25.666 INFO: Using ADAM as parameter optimizer
2025-07-28 15:08:25.666 INFO: Batch size: 4
2025-07-28 15:08:25.666 INFO: Number of gradient updates: 24583
2025-07-28 15:08:25.667 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-28 15:08:25.667 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=100.000)
2025-07-28 15:08:25.791 WARNING: Cannot find checkpoint with tag 'mace_T3_finetune_h200_cn10_run-21' in './checkpoints'
2025-07-28 15:08:25.791 INFO: Using gradient clipping with tolerance=10.000
2025-07-28 15:08:25.791 INFO: 
2025-07-28 15:08:25.791 INFO: ===========TRAINING===========
2025-07-28 15:08:25.791 INFO: Started training, reporting errors on validation set
2025-07-28 15:08:25.791 INFO: Loss metrics on validation set
2025-07-28 15:09:41.099 INFO: Initial: head: Default, loss=89.80636489, RMSE_E_per_atom= 1245.40 meV, RMSE_F=  959.54 meV / A
2025-07-28 15:10:49.860 INFO: ===========VERIFYING SETTINGS===========
2025-07-28 15:10:49.860 INFO: MACE version: 0.3.13
2025-07-28 15:10:49.860 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=61, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-28 15:10:50.788 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-28 15:10:50.872 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 15:10:50.876 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 15:10:50.884 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-28 15:10:50.891 DEBUG: Current Git commit: 3dffafbc60bfd9a4c8a29135bf65ce152e41c510
2025-07-28 15:10:51.277 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-28 15:10:51.278 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-28 15:10:51.278 INFO: ===========LOADING INPUT DATA===========
2025-07-28 15:10:51.278 INFO: Using heads: ['Default']
2025-07-28 15:10:51.278 INFO: Using the key specifications to parse data:
2025-07-28 15:10:51.278 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-28 15:10:51.278 INFO: =============    Processing head Default     ===========
2025-07-28 15:10:51.280 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz
2025-07-28 15:10:56.718 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 15:10:56.722 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 15:10:59.100 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 15:10:59.102 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 15:10:59.102 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-07-28 15:10:59.199 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-28 15:10:59.199 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-28 15:10:59.199 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-28 15:10:59.199 INFO: Processing datasets for head 'Default'
2025-07-28 15:11:18.781 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz']
2025-07-28 15:11:18.781 INFO: Combining 1 list datasets for head 'Default'
2025-07-28 15:11:27.576 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-28 15:11:27.577 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-28 15:11:27.577 INFO: Combined validation datasets for Default
2025-07-28 15:11:27.577 INFO: Head 'Default' training dataset size: 1612
2025-07-28 15:11:27.578 INFO: Computing average number of neighbors
2025-07-28 15:11:29.542 INFO: Average number of neighbors: 67.30184267634576
2025-07-28 15:11:29.542 INFO: During training the following quantities will be reported: energy, forces
2025-07-28 15:11:29.542 INFO: ===========MODEL DETAILS===========
2025-07-28 15:11:31.151 INFO: Loading FOUNDATION model
2025-07-28 15:11:31.152 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-28 15:11:31.152 INFO: Model configuration extracted from foundation model
2025-07-28 15:11:31.152 INFO: Using universal loss function for fine-tuning
2025-07-28 15:11:31.152 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-28 15:11:31.152 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-28 15:11:31.152 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-28 15:11:31.152 INFO: Distance transform for radial basis functions: None
2025-07-28 15:11:32.419 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-28 15:11:32.420 INFO: Total number of parameters: 894362
2025-07-28 15:11:32.420 INFO: 
2025-07-28 15:11:32.420 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-28 15:11:32.420 INFO: Using ADAM as parameter optimizer
2025-07-28 15:11:32.420 INFO: Batch size: 2
2025-07-28 15:11:32.420 INFO: Number of gradient updates: 49166
2025-07-28 15:11:32.420 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-28 15:11:32.420 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=100.000)
2025-07-28 15:11:32.424 WARNING: Cannot find checkpoint with tag 'mace_T3_finetune_h200_cn10_run-21' in './checkpoints'
2025-07-28 15:11:32.424 INFO: Using gradient clipping with tolerance=10.000
2025-07-28 15:11:32.424 INFO: 
2025-07-28 15:11:32.424 INFO: ===========TRAINING===========
2025-07-28 15:11:32.424 INFO: Started training, reporting errors on validation set
2025-07-28 15:11:32.424 INFO: Loss metrics on validation set
2025-07-28 15:12:47.282 INFO: Initial: head: Default, loss=89.80636489, RMSE_E_per_atom= 1245.40 meV, RMSE_F=  959.54 meV / A
2025-07-28 15:21:38.558 INFO: Epoch 0: head: Default, loss=0.30130133, RMSE_E_per_atom=   41.83 meV, RMSE_F=   57.14 meV / A
2025-07-28 15:21:38.560 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-0.pt
2025-07-28 15:30:27.334 INFO: Epoch 1: head: Default, loss=0.23974599, RMSE_E_per_atom=   34.93 meV, RMSE_F=   51.15 meV / A
2025-07-28 15:30:27.336 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-0.pt
2025-07-28 15:30:27.594 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-1.pt
2025-07-28 15:39:16.579 INFO: Epoch 2: head: Default, loss=0.23998814, RMSE_E_per_atom=   39.99 meV, RMSE_F=   50.48 meV / A
2025-07-28 15:48:05.340 INFO: Epoch 3: head: Default, loss=0.20085718, RMSE_E_per_atom=   36.23 meV, RMSE_F=   46.44 meV / A
2025-07-28 15:48:05.342 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-1.pt
2025-07-28 15:48:05.542 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-3.pt
2025-07-28 15:56:54.492 INFO: Epoch 4: head: Default, loss=0.19028749, RMSE_E_per_atom=   34.45 meV, RMSE_F=   45.25 meV / A
2025-07-28 15:56:54.493 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-3.pt
2025-07-28 15:56:54.565 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-4.pt
2025-07-28 16:05:43.391 INFO: Epoch 5: head: Default, loss=0.18692211, RMSE_E_per_atom=   34.16 meV, RMSE_F=   44.93 meV / A
2025-07-28 16:05:43.393 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-4.pt
2025-07-28 16:05:43.596 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-5.pt
2025-07-28 16:14:32.896 INFO: Epoch 6: head: Default, loss=0.18832311, RMSE_E_per_atom=   33.24 meV, RMSE_F=   45.26 meV / A
2025-07-28 16:23:21.862 INFO: Epoch 7: head: Default, loss=0.16634281, RMSE_E_per_atom=   33.52 meV, RMSE_F=   42.19 meV / A
2025-07-28 16:23:21.864 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-5.pt
2025-07-28 16:23:22.009 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-7.pt
2025-07-28 16:32:10.904 INFO: Epoch 8: head: Default, loss=0.15391967, RMSE_E_per_atom=   32.96 meV, RMSE_F=   40.62 meV / A
2025-07-28 16:32:10.906 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-7.pt
2025-07-28 16:32:11.182 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-8.pt
2025-07-28 16:41:01.571 INFO: Epoch 9: head: Default, loss=0.16786996, RMSE_E_per_atom=   43.66 meV, RMSE_F=   41.42 meV / A
2025-07-28 16:49:50.609 INFO: Epoch 10: head: Default, loss=0.16889659, RMSE_E_per_atom=   35.81 meV, RMSE_F=   42.57 meV / A
2025-07-28 16:58:39.413 INFO: Epoch 11: head: Default, loss=0.14396806, RMSE_E_per_atom=   34.68 meV, RMSE_F=   38.97 meV / A
2025-07-28 16:58:39.415 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-8.pt
2025-07-28 16:58:39.567 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-11.pt
2025-07-28 17:07:28.568 INFO: Epoch 12: head: Default, loss=0.15500131, RMSE_E_per_atom=   32.33 meV, RMSE_F=   40.58 meV / A
2025-07-28 17:16:17.595 INFO: Epoch 13: head: Default, loss=0.14879042, RMSE_E_per_atom=   33.24 meV, RMSE_F=   39.79 meV / A
2025-07-28 17:25:06.592 INFO: Epoch 14: head: Default, loss=0.13512075, RMSE_E_per_atom=   31.67 meV, RMSE_F=   37.95 meV / A
2025-07-28 17:25:06.594 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-11.pt
2025-07-28 17:25:07.119 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-14.pt
2025-07-28 17:33:57.482 INFO: Epoch 15: head: Default, loss=0.14268351, RMSE_E_per_atom=   32.38 meV, RMSE_F=   38.84 meV / A
2025-07-28 17:42:46.562 INFO: Epoch 16: head: Default, loss=0.13252570, RMSE_E_per_atom=   32.07 meV, RMSE_F=   37.49 meV / A
2025-07-28 17:42:46.564 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-14.pt
2025-07-28 17:42:46.831 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-16.pt
2025-07-28 17:51:35.892 INFO: Epoch 17: head: Default, loss=0.15115403, RMSE_E_per_atom=   39.70 meV, RMSE_F=   39.61 meV / A
2025-07-28 18:00:24.817 INFO: Epoch 18: head: Default, loss=0.13680771, RMSE_E_per_atom=   32.08 meV, RMSE_F=   37.98 meV / A
2025-07-28 18:09:13.976 INFO: Epoch 19: head: Default, loss=0.13127576, RMSE_E_per_atom=   33.76 meV, RMSE_F=   37.08 meV / A
2025-07-28 18:09:13.978 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-16.pt
2025-07-28 18:09:14.169 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-19.pt
2025-07-28 18:18:03.131 INFO: Epoch 20: head: Default, loss=0.12906200, RMSE_E_per_atom=   30.85 meV, RMSE_F=   37.09 meV / A
2025-07-28 18:18:03.133 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-19.pt
2025-07-28 18:18:03.241 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-20.pt
2025-07-28 18:26:52.216 INFO: Epoch 21: head: Default, loss=0.12552696, RMSE_E_per_atom=   30.65 meV, RMSE_F=   36.56 meV / A
2025-07-28 18:26:52.218 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-20.pt
2025-07-28 18:26:52.334 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-21.pt
2025-07-28 18:35:41.468 INFO: Epoch 22: head: Default, loss=0.13508788, RMSE_E_per_atom=   34.78 meV, RMSE_F=   37.66 meV / A
2025-07-28 18:44:30.925 INFO: Epoch 23: head: Default, loss=0.12266712, RMSE_E_per_atom=   31.93 meV, RMSE_F=   35.91 meV / A
2025-07-28 18:44:30.927 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-21.pt
2025-07-28 18:44:31.422 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-23.pt
2025-07-28 18:53:21.092 INFO: Epoch 24: head: Default, loss=0.12503600, RMSE_E_per_atom=   31.86 meV, RMSE_F=   36.39 meV / A
2025-07-28 19:02:10.835 INFO: Epoch 25: head: Default, loss=0.12100503, RMSE_E_per_atom=   30.19 meV, RMSE_F=   35.89 meV / A
2025-07-28 19:02:10.837 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-23.pt
2025-07-28 19:02:11.235 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-25.pt
2025-07-28 19:11:00.563 INFO: Epoch 26: head: Default, loss=0.12744017, RMSE_E_per_atom=   31.00 meV, RMSE_F=   36.91 meV / A
2025-07-28 19:19:49.581 INFO: Epoch 27: head: Default, loss=0.13022665, RMSE_E_per_atom=   30.01 meV, RMSE_F=   37.00 meV / A
2025-07-28 19:28:38.693 INFO: Epoch 28: head: Default, loss=0.12116020, RMSE_E_per_atom=   32.17 meV, RMSE_F=   35.69 meV / A
2025-07-28 19:37:28.410 INFO: Epoch 29: head: Default, loss=0.11871823, RMSE_E_per_atom=   31.14 meV, RMSE_F=   35.30 meV / A
2025-07-28 19:37:28.412 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-25.pt
2025-07-28 19:37:28.881 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-29.pt
2025-07-28 19:46:17.878 INFO: Epoch 30: head: Default, loss=0.11598514, RMSE_E_per_atom=   29.58 meV, RMSE_F=   35.11 meV / A
2025-07-28 19:46:17.880 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-29.pt
2025-07-28 19:46:18.095 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-30.pt
2025-07-28 19:48:50.534 INFO: ===========VERIFYING SETTINGS===========
2025-07-28 19:48:50.534 INFO: MACE version: 0.3.13
2025-07-28 19:48:50.534 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=60.0, swa_forces_weight=100.0, energy_weight=60.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=61, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-28 19:48:51.715 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-28 19:48:52.171 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 19:48:52.175 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 19:48:52.471 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-28 19:48:52.600 DEBUG: Current Git commit: 3dffafbc60bfd9a4c8a29135bf65ce152e41c510
2025-07-28 19:48:53.085 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-28 19:48:53.086 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-28 19:48:53.086 INFO: ===========LOADING INPUT DATA===========
2025-07-28 19:48:53.086 INFO: Using heads: ['Default']
2025-07-28 19:48:53.086 INFO: Using the key specifications to parse data:
2025-07-28 19:48:53.086 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-28 19:48:53.086 INFO: =============    Processing head Default     ===========
2025-07-28 19:48:53.282 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz
2025-07-28 19:48:58.714 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 19:48:58.718 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 19:49:01.039 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 19:49:01.041 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 19:49:01.041 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-07-28 19:49:01.136 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-28 19:49:01.137 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-28 19:49:01.137 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-28 19:49:01.137 INFO: Processing datasets for head 'Default'
2025-07-28 19:49:20.765 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz']
2025-07-28 19:49:20.765 INFO: Combining 1 list datasets for head 'Default'
2025-07-28 19:49:29.550 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-28 19:49:29.550 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-28 19:49:29.551 INFO: Combined validation datasets for Default
2025-07-28 19:49:29.551 INFO: Head 'Default' training dataset size: 1612
2025-07-28 19:49:29.551 INFO: Computing average number of neighbors
2025-07-28 19:49:31.476 INFO: Average number of neighbors: 67.30184267634576
2025-07-28 19:49:31.476 INFO: During training the following quantities will be reported: energy, forces
2025-07-28 19:49:31.476 INFO: ===========MODEL DETAILS===========
2025-07-28 19:49:33.087 INFO: Loading FOUNDATION model
2025-07-28 19:49:33.088 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-28 19:49:33.088 INFO: Model configuration extracted from foundation model
2025-07-28 19:49:33.088 INFO: Using universal loss function for fine-tuning
2025-07-28 19:49:33.088 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-28 19:49:33.088 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-28 19:49:33.089 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-28 19:49:33.089 INFO: Distance transform for radial basis functions: None
2025-07-28 19:49:34.348 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-28 19:49:34.350 INFO: Total number of parameters: 894362
2025-07-28 19:49:34.350 INFO: 
2025-07-28 19:49:34.350 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-28 19:49:34.350 INFO: Using ADAM as parameter optimizer
2025-07-28 19:49:34.350 INFO: Batch size: 2
2025-07-28 19:49:34.350 INFO: Number of gradient updates: 49166
2025-07-28 19:49:34.350 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-28 19:49:34.350 INFO: WeightedEnergyForcesLoss(energy_weight=60.000, forces_weight=60.000)
2025-07-28 19:49:34.525 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-28 19:49:34.526 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-30.pt
2025-07-28 19:49:39.448 INFO: Using gradient clipping with tolerance=10.000
2025-07-28 19:49:39.448 INFO: 
2025-07-28 19:49:39.448 INFO: ===========TRAINING===========
2025-07-28 19:49:39.448 INFO: Started training, reporting errors on validation set
2025-07-28 19:49:39.448 INFO: Loss metrics on validation set
2025-07-28 19:50:54.421 INFO: Initial: head: Default, loss=0.11683925, RMSE_E_per_atom=   29.58 meV, RMSE_F=   35.11 meV / A
2025-07-28 19:59:46.192 INFO: Epoch 30: head: Default, loss=0.12107123, RMSE_E_per_atom=   28.02 meV, RMSE_F=   37.28 meV / A
2025-07-28 19:59:46.194 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-30.pt
2025-07-28 20:08:35.978 INFO: Epoch 31: head: Default, loss=0.12307057, RMSE_E_per_atom=   26.44 meV, RMSE_F=   38.69 meV / A
2025-07-28 20:12:35.555 INFO: ===========VERIFYING SETTINGS===========
2025-07-28 20:12:35.555 INFO: MACE version: 0.3.13
2025-07-28 20:12:35.555 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=60.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=61, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-28 20:12:36.836 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-28 20:12:37.079 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 20:12:37.084 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 20:12:37.293 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-28 20:12:37.409 DEBUG: Current Git commit: 3dffafbc60bfd9a4c8a29135bf65ce152e41c510
2025-07-28 20:12:37.820 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-28 20:12:37.821 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-28 20:12:37.821 INFO: ===========LOADING INPUT DATA===========
2025-07-28 20:12:37.821 INFO: Using heads: ['Default']
2025-07-28 20:12:37.821 INFO: Using the key specifications to parse data:
2025-07-28 20:12:37.821 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-28 20:12:37.821 INFO: =============    Processing head Default     ===========
2025-07-28 20:12:37.839 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz
2025-07-28 20:12:43.282 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 20:12:43.286 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 20:12:45.596 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 20:12:45.597 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 20:12:45.598 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-07-28 20:12:45.693 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-28 20:12:45.693 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-28 20:12:45.693 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-28 20:12:45.694 INFO: Processing datasets for head 'Default'
2025-07-28 20:13:05.276 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz']
2025-07-28 20:13:05.276 INFO: Combining 1 list datasets for head 'Default'
2025-07-28 20:13:14.034 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-28 20:13:14.034 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-28 20:13:14.034 INFO: Combined validation datasets for Default
2025-07-28 20:13:14.034 INFO: Head 'Default' training dataset size: 1612
2025-07-28 20:13:14.035 INFO: Computing average number of neighbors
2025-07-28 20:13:15.990 INFO: Average number of neighbors: 67.30184267634576
2025-07-28 20:13:15.990 INFO: During training the following quantities will be reported: energy, forces
2025-07-28 20:13:15.990 INFO: ===========MODEL DETAILS===========
2025-07-28 20:13:17.639 INFO: Loading FOUNDATION model
2025-07-28 20:13:17.640 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-28 20:13:17.640 INFO: Model configuration extracted from foundation model
2025-07-28 20:13:17.640 INFO: Using universal loss function for fine-tuning
2025-07-28 20:13:17.640 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-28 20:13:17.640 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-28 20:13:17.640 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-28 20:13:17.640 INFO: Distance transform for radial basis functions: None
2025-07-28 20:13:18.972 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-28 20:13:18.973 INFO: Total number of parameters: 894362
2025-07-28 20:13:18.973 INFO: 
2025-07-28 20:13:18.973 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-28 20:13:18.973 INFO: Using ADAM as parameter optimizer
2025-07-28 20:13:18.973 INFO: Batch size: 2
2025-07-28 20:13:18.973 INFO: Number of gradient updates: 49166
2025-07-28 20:13:18.973 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-28 20:13:18.973 INFO: WeightedEnergyForcesLoss(energy_weight=60.000, forces_weight=100.000)
2025-07-28 20:13:19.109 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-28 20:13:19.110 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-30.pt
2025-07-28 20:13:19.145 INFO: Using gradient clipping with tolerance=10.000
2025-07-28 20:13:19.145 INFO: 
2025-07-28 20:13:19.145 INFO: ===========TRAINING===========
2025-07-28 20:13:19.145 INFO: Started training, reporting errors on validation set
2025-07-28 20:13:19.145 INFO: Loss metrics on validation set
2025-07-28 20:14:33.750 INFO: Initial: head: Default, loss=0.17038279, RMSE_E_per_atom=   28.02 meV, RMSE_F=   37.28 meV / A
2025-07-28 20:23:24.964 INFO: Epoch 30: head: Default, loss=0.17168889, RMSE_E_per_atom=   27.13 meV, RMSE_F=   37.84 meV / A
2025-07-28 20:23:24.966 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-30.pt
2025-07-28 20:32:13.911 INFO: Epoch 31: head: Default, loss=0.15492643, RMSE_E_per_atom=   25.54 meV, RMSE_F=   36.28 meV / A
2025-07-28 20:32:13.913 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-30.pt
2025-07-28 20:32:14.195 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-31.pt
2025-07-28 20:41:03.582 INFO: Epoch 32: head: Default, loss=0.15856304, RMSE_E_per_atom=   26.69 meV, RMSE_F=   36.29 meV / A
2025-07-28 20:49:52.751 INFO: Epoch 33: head: Default, loss=0.17909954, RMSE_E_per_atom=   24.33 meV, RMSE_F=   39.91 meV / A
2025-07-28 20:58:41.593 INFO: Epoch 34: head: Default, loss=0.15339178, RMSE_E_per_atom=   24.48 meV, RMSE_F=   36.52 meV / A
2025-07-28 20:58:41.595 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-31.pt
2025-07-28 20:58:41.979 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-34.pt
2025-07-28 21:07:30.834 INFO: Epoch 35: head: Default, loss=0.15283666, RMSE_E_per_atom=   25.49 meV, RMSE_F=   36.06 meV / A
2025-07-28 21:07:30.836 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-34.pt
2025-07-28 21:07:30.991 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-35.pt
2025-07-28 21:16:20.180 INFO: Epoch 36: head: Default, loss=0.14750033, RMSE_E_per_atom=   23.37 meV, RMSE_F=   36.10 meV / A
2025-07-28 21:16:20.182 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-35.pt
2025-07-28 21:16:20.262 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-36.pt
2025-07-28 21:25:09.143 INFO: Epoch 37: head: Default, loss=0.14210612, RMSE_E_per_atom=   23.01 meV, RMSE_F=   35.44 meV / A
2025-07-28 21:25:09.146 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-36.pt
2025-07-28 21:25:09.282 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-37.pt
2025-07-28 21:33:58.144 INFO: Epoch 38: head: Default, loss=0.13566512, RMSE_E_per_atom=   21.85 meV, RMSE_F=   34.97 meV / A
2025-07-28 21:33:58.145 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-37.pt
2025-07-28 21:33:58.377 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-38.pt
2025-07-28 21:42:47.718 INFO: Epoch 39: head: Default, loss=0.16492850, RMSE_E_per_atom=   29.34 meV, RMSE_F=   35.97 meV / A
2025-07-28 21:51:36.826 INFO: Epoch 40: head: Default, loss=0.14482412, RMSE_E_per_atom=   24.91 meV, RMSE_F=   35.09 meV / A
2025-07-28 22:00:25.525 INFO: Epoch 41: head: Default, loss=0.14743150, RMSE_E_per_atom=   26.56 meV, RMSE_F=   34.67 meV / A
2025-07-28 22:09:14.302 INFO: Epoch 42: head: Default, loss=0.12859644, RMSE_E_per_atom=   19.40 meV, RMSE_F=   34.79 meV / A
2025-07-28 22:09:14.303 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-38.pt
2025-07-28 22:09:14.460 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-42.pt
2025-07-28 22:24:47.039 INFO: ===========VERIFYING SETTINGS===========
2025-07-28 22:24:47.039 INFO: MACE version: 0.3.13
2025-07-28 22:24:47.040 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=50.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=61, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=5.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-28 22:24:47.814 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-28 22:24:47.910 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 22:24:47.915 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 22:24:47.924 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-28 22:24:48.002 DEBUG: Current Git commit: 3dffafbc60bfd9a4c8a29135bf65ce152e41c510
2025-07-28 22:24:48.652 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-28 22:24:48.654 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-28 22:24:48.654 INFO: ===========LOADING INPUT DATA===========
2025-07-28 22:24:48.655 INFO: Using heads: ['Default']
2025-07-28 22:24:48.655 INFO: Using the key specifications to parse data:
2025-07-28 22:24:48.655 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-28 22:24:48.655 INFO: =============    Processing head Default     ===========
2025-07-28 22:24:48.656 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz
2025-07-28 22:24:54.089 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 22:24:54.093 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 22:24:56.434 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 22:24:56.436 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 22:24:56.436 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-07-28 22:24:56.532 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-28 22:24:56.533 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-28 22:24:56.533 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-28 22:24:56.533 INFO: Processing datasets for head 'Default'
2025-07-28 22:25:16.122 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz']
2025-07-28 22:25:16.122 INFO: Combining 1 list datasets for head 'Default'
2025-07-28 22:25:24.882 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-28 22:25:24.882 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-28 22:25:24.882 INFO: Combined validation datasets for Default
2025-07-28 22:25:24.882 INFO: Head 'Default' training dataset size: 1612
2025-07-28 22:25:24.883 INFO: Computing average number of neighbors
2025-07-28 22:25:26.773 INFO: Average number of neighbors: 67.30184267634576
2025-07-28 22:25:26.774 INFO: During training the following quantities will be reported: energy, forces
2025-07-28 22:25:26.774 INFO: ===========MODEL DETAILS===========
2025-07-28 22:25:28.392 INFO: Loading FOUNDATION model
2025-07-28 22:25:28.393 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-28 22:25:28.393 INFO: Model configuration extracted from foundation model
2025-07-28 22:25:28.393 INFO: Using universal loss function for fine-tuning
2025-07-28 22:25:28.393 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-28 22:25:28.393 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-28 22:25:28.393 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-28 22:25:28.393 INFO: Distance transform for radial basis functions: None
2025-07-28 22:25:29.630 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-28 22:25:29.631 INFO: Total number of parameters: 894362
2025-07-28 22:25:29.631 INFO: 
2025-07-28 22:25:29.632 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-28 22:25:29.632 INFO: Using ADAM as parameter optimizer
2025-07-28 22:25:29.632 INFO: Batch size: 2
2025-07-28 22:25:29.632 INFO: Number of gradient updates: 49166
2025-07-28 22:25:29.632 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-28 22:25:29.632 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=50.000)
2025-07-28 22:25:29.634 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-28 22:25:29.634 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-42.pt
2025-07-28 22:25:29.688 INFO: Using gradient clipping with tolerance=5.000
2025-07-28 22:25:29.688 INFO: 
2025-07-28 22:25:29.688 INFO: ===========TRAINING===========
2025-07-28 22:25:29.689 INFO: Started training, reporting errors on validation set
2025-07-28 22:25:29.689 INFO: Loss metrics on validation set
2025-07-28 22:26:44.511 INFO: Initial: head: Default, loss=0.09063670, RMSE_E_per_atom=   19.40 meV, RMSE_F=   34.79 meV / A
2025-07-28 22:35:35.914 INFO: Epoch 42: head: Default, loss=0.09425803, RMSE_E_per_atom=   19.29 meV, RMSE_F=   35.98 meV / A
2025-07-28 22:35:35.916 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-42.pt
2025-07-28 22:44:24.895 INFO: Epoch 43: head: Default, loss=0.09452911, RMSE_E_per_atom=   18.28 meV, RMSE_F=   36.97 meV / A
2025-07-28 22:53:13.844 INFO: Epoch 44: head: Default, loss=0.09704259, RMSE_E_per_atom=   19.58 meV, RMSE_F=   36.33 meV / A
2025-07-28 23:02:02.797 INFO: Epoch 45: head: Default, loss=0.12068511, RMSE_E_per_atom=   22.64 meV, RMSE_F=   39.20 meV / A
2025-07-28 23:04:58.099 INFO: ===========VERIFYING SETTINGS===========
2025-07-28 23:04:58.099 INFO: MACE version: 0.3.13
2025-07-28 23:04:58.099 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=50.0, swa_forces_weight=100.0, energy_weight=75.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=61, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-28 23:04:58.839 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-28 23:04:58.983 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 23:04:58.987 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-28 23:04:59.067 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-28 23:04:59.120 DEBUG: Current Git commit: 3dffafbc60bfd9a4c8a29135bf65ce152e41c510
2025-07-28 23:04:59.594 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-28 23:04:59.595 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-28 23:04:59.595 INFO: ===========LOADING INPUT DATA===========
2025-07-28 23:04:59.595 INFO: Using heads: ['Default']
2025-07-28 23:04:59.595 INFO: Using the key specifications to parse data:
2025-07-28 23:04:59.595 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-28 23:04:59.595 INFO: =============    Processing head Default     ===========
2025-07-28 23:04:59.597 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz
2025-07-28 23:05:05.000 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 23:05:05.004 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-28 23:05:07.357 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 23:05:07.359 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-28 23:05:07.359 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-07-28 23:05:07.455 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-28 23:05:07.455 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-28 23:05:07.455 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-28 23:05:07.455 INFO: Processing datasets for head 'Default'
2025-07-28 23:05:27.087 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz']
2025-07-28 23:05:27.087 INFO: Combining 1 list datasets for head 'Default'
2025-07-28 23:05:35.873 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-28 23:05:35.873 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-28 23:05:35.874 INFO: Combined validation datasets for Default
2025-07-28 23:05:35.874 INFO: Head 'Default' training dataset size: 1612
2025-07-28 23:05:35.874 INFO: Computing average number of neighbors
2025-07-28 23:05:37.842 INFO: Average number of neighbors: 67.30184267634576
2025-07-28 23:05:37.843 INFO: During training the following quantities will be reported: energy, forces
2025-07-28 23:05:37.843 INFO: ===========MODEL DETAILS===========
2025-07-28 23:05:39.485 INFO: Loading FOUNDATION model
2025-07-28 23:05:39.486 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-28 23:05:39.486 INFO: Model configuration extracted from foundation model
2025-07-28 23:05:39.486 INFO: Using universal loss function for fine-tuning
2025-07-28 23:05:39.486 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-28 23:05:39.486 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-28 23:05:39.486 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-28 23:05:39.486 INFO: Distance transform for radial basis functions: None
2025-07-28 23:05:40.762 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-28 23:05:40.763 INFO: Total number of parameters: 894362
2025-07-28 23:05:40.763 INFO: 
2025-07-28 23:05:40.763 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-28 23:05:40.763 INFO: Using ADAM as parameter optimizer
2025-07-28 23:05:40.763 INFO: Batch size: 2
2025-07-28 23:05:40.763 INFO: Number of gradient updates: 49166
2025-07-28 23:05:40.763 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-28 23:05:40.763 INFO: WeightedEnergyForcesLoss(energy_weight=75.000, forces_weight=50.000)
2025-07-28 23:05:40.767 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-28 23:05:40.767 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-42.pt
2025-07-28 23:05:40.802 INFO: Using gradient clipping with tolerance=10.000
2025-07-28 23:05:40.802 INFO: 
2025-07-28 23:05:40.802 INFO: ===========TRAINING===========
2025-07-28 23:05:40.802 INFO: Started training, reporting errors on validation set
2025-07-28 23:05:40.802 INFO: Loss metrics on validation set
2025-07-28 23:06:55.416 INFO: Initial: head: Default, loss=0.08495643, RMSE_E_per_atom=   19.29 meV, RMSE_F=   35.98 meV / A
2025-07-28 23:15:46.820 INFO: Epoch 42: head: Default, loss=0.07902091, RMSE_E_per_atom=   17.69 meV, RMSE_F=   35.53 meV / A
2025-07-28 23:15:46.822 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-42.pt
2025-07-28 23:24:35.502 INFO: Epoch 43: head: Default, loss=0.07585757, RMSE_E_per_atom=   16.11 meV, RMSE_F=   35.73 meV / A
2025-07-28 23:24:35.504 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-42.pt
2025-07-28 23:24:35.612 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-43.pt
2025-07-28 23:33:24.534 INFO: Epoch 44: head: Default, loss=0.08677163, RMSE_E_per_atom=   19.14 meV, RMSE_F=   36.45 meV / A
2025-07-28 23:42:13.287 INFO: Epoch 45: head: Default, loss=0.09543377, RMSE_E_per_atom=   20.56 meV, RMSE_F=   37.72 meV / A
2025-07-28 23:51:02.113 INFO: Epoch 46: head: Default, loss=0.07735254, RMSE_E_per_atom=   14.54 meV, RMSE_F=   37.06 meV / A
2025-07-28 23:59:50.994 INFO: Epoch 47: head: Default, loss=0.07156244, RMSE_E_per_atom=   14.77 meV, RMSE_F=   35.43 meV / A
2025-07-28 23:59:50.996 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-43.pt
2025-07-28 23:59:51.153 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-47.pt
2025-07-29 00:08:40.186 INFO: Epoch 48: head: Default, loss=0.06779019, RMSE_E_per_atom=   13.52 meV, RMSE_F=   35.02 meV / A
2025-07-29 00:08:40.188 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-47.pt
2025-07-29 00:08:40.524 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-48.pt
2025-07-29 00:17:29.382 INFO: Epoch 49: head: Default, loss=0.06908746, RMSE_E_per_atom=   13.60 meV, RMSE_F=   35.40 meV / A
2025-07-29 00:26:17.742 INFO: Epoch 50: head: Default, loss=0.06634247, RMSE_E_per_atom=   12.74 meV, RMSE_F=   35.09 meV / A
2025-07-29 00:26:17.744 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-48.pt
2025-07-29 00:26:17.860 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-50.pt
2025-07-29 00:35:06.635 INFO: Epoch 51: head: Default, loss=0.07379209, RMSE_E_per_atom=   12.25 meV, RMSE_F=   37.41 meV / A
2025-07-29 00:43:55.294 INFO: Epoch 52: head: Default, loss=0.07645046, RMSE_E_per_atom=   12.92 meV, RMSE_F=   37.80 meV / A
2025-07-29 00:52:45.294 INFO: Epoch 53: head: Default, loss=0.07249616, RMSE_E_per_atom=   11.24 meV, RMSE_F=   37.52 meV / A
2025-07-29 01:01:37.988 INFO: Epoch 54: head: Default, loss=0.07054327, RMSE_E_per_atom=   10.94 meV, RMSE_F=   37.01 meV / A
2025-07-29 01:10:30.773 INFO: Epoch 55: head: Default, loss=0.06066848, RMSE_E_per_atom=   10.44 meV, RMSE_F=   34.57 meV / A
2025-07-29 01:10:30.775 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-50.pt
2025-07-29 01:10:30.853 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-55.pt
2025-07-29 01:19:28.173 INFO: Epoch 56: head: Default, loss=0.07431296, RMSE_E_per_atom=   15.60 meV, RMSE_F=   35.60 meV / A
2025-07-29 01:28:16.995 INFO: Epoch 57: head: Default, loss=0.05942801, RMSE_E_per_atom=    9.62 meV, RMSE_F=   34.55 meV / A
2025-07-29 01:28:16.997 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-55.pt
2025-07-29 01:28:17.196 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-57.pt
2025-07-29 01:37:06.133 INFO: Epoch 58: head: Default, loss=0.06204682, RMSE_E_per_atom=   10.65 meV, RMSE_F=   34.89 meV / A
2025-07-29 01:45:55.449 INFO: Epoch 59: head: Default, loss=0.06376050, RMSE_E_per_atom=    9.94 meV, RMSE_F=   35.70 meV / A
2025-07-29 01:54:44.806 INFO: Epoch 60: head: Default, loss=0.06480264, RMSE_E_per_atom=   11.73 meV, RMSE_F=   35.12 meV / A
2025-07-29 01:54:44.807 INFO: Training complete
2025-07-29 01:54:44.807 INFO: 
2025-07-29 01:54:44.807 INFO: ===========RESULTS===========
2025-07-29 01:54:45.012 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-57.pt
2025-07-29 01:54:45.043 INFO: Loaded Stage one model from epoch 57 for evaluation
2025-07-29 01:54:45.043 INFO: Saving model to checkpoints/mace_T3_finetune_h200_cn10_run-21.model
2025-07-29 01:54:45.274 INFO: Compiling model, saving metadata to mace_T3_finetune_h200_cn10_compiled.model
2025-07-29 01:54:46.335 INFO: Computing metrics for training, validation, and test sets
2025-07-29 01:54:46.335 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-29 01:54:46.335 INFO: Evaluating train_Default ...
2025-07-29 01:56:47.062 INFO: ===========VERIFYING SETTINGS===========
2025-07-29 01:56:47.062 INFO: MACE version: 0.3.13
2025-07-29 01:56:47.062 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=50.0, swa_forces_weight=100.0, energy_weight=75.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=110, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-29 01:56:47.812 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-29 01:56:48.038 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-29 01:56:48.042 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-29 01:56:48.188 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-29 01:56:48.380 DEBUG: Current Git commit: 3dffafbc60bfd9a4c8a29135bf65ce152e41c510
2025-07-29 01:56:48.973 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-29 01:56:48.974 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-29 01:56:48.974 INFO: ===========LOADING INPUT DATA===========
2025-07-29 01:56:48.974 INFO: Using heads: ['Default']
2025-07-29 01:56:48.974 INFO: Using the key specifications to parse data:
2025-07-29 01:56:48.974 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-29 01:56:48.974 INFO: =============    Processing head Default     ===========
2025-07-29 01:56:48.987 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz
2025-07-29 01:56:54.503 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-29 01:56:54.507 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, forces: 1612, charges: 0]
2025-07-29 01:56:56.824 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-29 01:56:56.826 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-29 01:56:56.826 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-07-29 01:56:56.922 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-29 01:56:56.922 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-29 01:56:56.922 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-29 01:56:56.922 INFO: Processing datasets for head 'Default'
2025-07-29 01:57:16.543 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T3_chgnet_labeled.extxyz']
2025-07-29 01:57:16.543 INFO: Combining 1 list datasets for head 'Default'
2025-07-29 01:57:25.332 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-29 01:57:25.332 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-29 01:57:25.332 INFO: Combined validation datasets for Default
2025-07-29 01:57:25.332 INFO: Head 'Default' training dataset size: 1612
2025-07-29 01:57:25.333 INFO: Computing average number of neighbors
2025-07-29 01:57:27.272 INFO: Average number of neighbors: 67.30184267634576
2025-07-29 01:57:27.273 INFO: During training the following quantities will be reported: energy, forces
2025-07-29 01:57:27.273 INFO: ===========MODEL DETAILS===========
2025-07-29 01:57:28.922 INFO: Loading FOUNDATION model
2025-07-29 01:57:28.922 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-29 01:57:28.922 INFO: Model configuration extracted from foundation model
2025-07-29 01:57:28.923 INFO: Using universal loss function for fine-tuning
2025-07-29 01:57:28.923 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-29 01:57:28.923 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-29 01:57:28.923 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-29 01:57:28.923 INFO: Distance transform for radial basis functions: None
2025-07-29 01:57:30.254 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-29 01:57:30.256 INFO: Total number of parameters: 894362
2025-07-29 01:57:30.256 INFO: 
2025-07-29 01:57:30.256 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-29 01:57:30.256 INFO: Using ADAM as parameter optimizer
2025-07-29 01:57:30.256 INFO: Batch size: 2
2025-07-29 01:57:30.256 INFO: Number of gradient updates: 88660
2025-07-29 01:57:30.256 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-29 01:57:30.256 INFO: WeightedEnergyForcesLoss(energy_weight=75.000, forces_weight=50.000)
2025-07-29 01:57:30.287 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-29 01:57:30.288 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-57.pt
2025-07-29 01:57:30.348 INFO: Using gradient clipping with tolerance=10.000
2025-07-29 01:57:30.348 INFO: 
2025-07-29 01:57:30.348 INFO: ===========TRAINING===========
2025-07-29 01:57:30.348 INFO: Started training, reporting errors on validation set
2025-07-29 01:57:30.348 INFO: Loss metrics on validation set
2025-07-29 01:58:45.745 INFO: Initial: head: Default, loss=0.05942801, RMSE_E_per_atom=    9.62 meV, RMSE_F=   34.55 meV / A
2025-07-29 02:07:37.746 INFO: Epoch 57: head: Default, loss=0.06014303, RMSE_E_per_atom=   10.16 meV, RMSE_F=   34.55 meV / A
2025-07-29 02:07:37.748 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-57.pt
2025-07-29 02:16:27.990 INFO: Epoch 58: head: Default, loss=0.07229100, RMSE_E_per_atom=   12.94 meV, RMSE_F=   36.54 meV / A
2025-07-29 02:25:18.698 INFO: Epoch 59: head: Default, loss=0.06645601, RMSE_E_per_atom=   12.67 meV, RMSE_F=   35.07 meV / A
2025-07-29 02:34:09.489 INFO: Epoch 60: head: Default, loss=0.06598509, RMSE_E_per_atom=   11.59 meV, RMSE_F=   35.51 meV / A
2025-07-29 02:43:00.412 INFO: Epoch 61: head: Default, loss=0.06749153, RMSE_E_per_atom=   11.05 meV, RMSE_F=   36.16 meV / A
2025-07-29 02:51:50.157 INFO: Epoch 62: head: Default, loss=0.05841290, RMSE_E_per_atom=    8.40 meV, RMSE_F=   34.81 meV / A
2025-07-29 02:51:50.159 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-57.pt
2025-07-29 02:51:50.245 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-62.pt
2025-07-29 03:00:40.862 INFO: Epoch 63: head: Default, loss=0.05907608, RMSE_E_per_atom=    8.64 meV, RMSE_F=   34.80 meV / A
2025-07-29 03:09:30.159 INFO: Epoch 64: head: Default, loss=0.05836215, RMSE_E_per_atom=    8.08 meV, RMSE_F=   34.81 meV / A
2025-07-29 03:09:30.161 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-62.pt
2025-07-29 03:09:30.244 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-64.pt
2025-07-29 03:18:18.985 INFO: Epoch 65: head: Default, loss=0.05380382, RMSE_E_per_atom=    6.48 meV, RMSE_F=   34.00 meV / A
2025-07-29 03:18:18.987 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-64.pt
2025-07-29 03:18:19.342 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-65.pt
2025-07-29 03:27:09.578 INFO: Epoch 66: head: Default, loss=0.05636863, RMSE_E_per_atom=    7.08 meV, RMSE_F=   34.64 meV / A
2025-07-29 03:36:00.261 INFO: Epoch 67: head: Default, loss=0.05525418, RMSE_E_per_atom=    5.69 meV, RMSE_F=   34.64 meV / A
2025-07-29 03:44:50.990 INFO: Epoch 68: head: Default, loss=0.05371073, RMSE_E_per_atom=    5.81 meV, RMSE_F=   34.14 meV / A
2025-07-29 03:44:50.992 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-65.pt
2025-07-29 03:44:51.117 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-68.pt
2025-07-29 03:53:41.759 INFO: Epoch 69: head: Default, loss=0.05310400, RMSE_E_per_atom=    5.75 meV, RMSE_F=   33.95 meV / A
2025-07-29 03:53:41.761 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-68.pt
2025-07-29 03:53:41.810 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-69.pt
2025-07-29 04:02:32.324 INFO: Epoch 70: head: Default, loss=0.05198883, RMSE_E_per_atom=    5.05 meV, RMSE_F=   33.82 meV / A
2025-07-29 04:02:32.326 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-69.pt
2025-07-29 04:02:32.356 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-70.pt
2025-07-29 04:11:21.083 INFO: Epoch 71: head: Default, loss=0.05178036, RMSE_E_per_atom=    4.61 meV, RMSE_F=   33.84 meV / A
2025-07-29 04:11:21.085 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-70.pt
2025-07-29 04:11:21.140 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-71.pt
2025-07-29 04:20:10.218 INFO: Epoch 72: head: Default, loss=0.05730037, RMSE_E_per_atom=    9.07 meV, RMSE_F=   34.09 meV / A
2025-07-29 04:28:59.024 INFO: Epoch 73: head: Default, loss=0.05309944, RMSE_E_per_atom=    6.46 meV, RMSE_F=   33.75 meV / A
2025-07-29 04:37:47.902 INFO: Epoch 74: head: Default, loss=0.05061659, RMSE_E_per_atom=    3.86 meV, RMSE_F=   33.63 meV / A
2025-07-29 04:37:47.904 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-71.pt
2025-07-29 04:37:47.974 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-74.pt
2025-07-29 04:46:37.026 INFO: Epoch 75: head: Default, loss=0.05003032, RMSE_E_per_atom=    3.85 meV, RMSE_F=   33.44 meV / A
2025-07-29 04:46:37.028 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-74.pt
2025-07-29 04:46:37.173 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-75.pt
2025-07-29 04:55:26.351 INFO: Epoch 76: head: Default, loss=0.05153796, RMSE_E_per_atom=    5.69 meV, RMSE_F=   33.49 meV / A
2025-07-29 05:04:15.187 INFO: Epoch 77: head: Default, loss=0.05136449, RMSE_E_per_atom=    3.93 meV, RMSE_F=   33.89 meV / A
2025-07-29 05:13:03.943 INFO: Epoch 78: head: Default, loss=0.05413702, RMSE_E_per_atom=    6.79 meV, RMSE_F=   33.99 meV / A
2025-07-29 05:21:52.902 INFO: Epoch 79: head: Default, loss=0.04922692, RMSE_E_per_atom=    3.40 meV, RMSE_F=   33.26 meV / A
2025-07-29 05:21:52.904 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-75.pt
2025-07-29 05:21:53.026 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-79.pt
2025-07-29 05:30:41.868 INFO: Epoch 80: head: Default, loss=0.04825256, RMSE_E_per_atom=    2.94 meV, RMSE_F=   33.00 meV / A
2025-07-29 05:30:41.870 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-79.pt
2025-07-29 05:30:41.947 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-80.pt
2025-07-29 05:39:30.540 INFO: Epoch 81: head: Default, loss=0.04980179, RMSE_E_per_atom=    4.32 meV, RMSE_F=   33.30 meV / A
2025-07-29 05:48:19.328 INFO: Epoch 82: head: Default, loss=0.04861638, RMSE_E_per_atom=    3.23 meV, RMSE_F=   33.05 meV / A
2025-07-29 05:57:08.215 INFO: Epoch 83: head: Default, loss=0.04983082, RMSE_E_per_atom=    2.73 meV, RMSE_F=   33.49 meV / A
2025-07-29 06:05:56.854 INFO: Epoch 84: head: Default, loss=0.04798915, RMSE_E_per_atom=    3.00 meV, RMSE_F=   32.87 meV / A
2025-07-29 06:05:56.856 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-80.pt
2025-07-29 06:05:56.950 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-84.pt
2025-07-29 06:14:46.180 INFO: Epoch 85: head: Default, loss=0.04856723, RMSE_E_per_atom=    3.54 meV, RMSE_F=   33.01 meV / A
2025-07-29 06:23:35.171 INFO: Epoch 86: head: Default, loss=0.04780546, RMSE_E_per_atom=    3.95 meV, RMSE_F=   32.67 meV / A
2025-07-29 06:23:35.173 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-84.pt
2025-07-29 06:23:35.259 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-86.pt
2025-07-29 06:32:24.095 INFO: Epoch 87: head: Default, loss=0.04725816, RMSE_E_per_atom=    2.49 meV, RMSE_F=   32.70 meV / A
2025-07-29 06:32:24.097 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-86.pt
2025-07-29 06:32:24.169 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-87.pt
2025-07-29 06:41:13.316 INFO: Epoch 88: head: Default, loss=0.04715486, RMSE_E_per_atom=    2.35 meV, RMSE_F=   32.73 meV / A
2025-07-29 06:41:13.318 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-87.pt
2025-07-29 06:41:13.384 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-88.pt
2025-07-29 06:50:02.426 INFO: Epoch 89: head: Default, loss=0.04744492, RMSE_E_per_atom=    2.35 meV, RMSE_F=   32.83 meV / A
2025-07-29 06:58:51.016 INFO: Epoch 90: head: Default, loss=0.04788341, RMSE_E_per_atom=    2.20 meV, RMSE_F=   32.98 meV / A
2025-07-29 07:07:39.821 INFO: Epoch 91: head: Default, loss=0.09135526, RMSE_E_per_atom=    2.17 meV, RMSE_F=   46.57 meV / A
2025-07-29 07:16:28.793 INFO: Epoch 92: head: Default, loss=0.05702272, RMSE_E_per_atom=    5.59 meV, RMSE_F=   35.44 meV / A
2025-07-29 07:25:17.620 INFO: Epoch 93: head: Default, loss=0.04672413, RMSE_E_per_atom=    2.39 meV, RMSE_F=   32.60 meV / A
2025-07-29 07:25:17.622 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-88.pt
2025-07-29 07:25:17.749 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-93.pt
2025-07-29 07:34:06.872 INFO: Epoch 94: head: Default, loss=0.04764617, RMSE_E_per_atom=    2.46 meV, RMSE_F=   32.86 meV / A
2025-07-29 07:42:55.697 INFO: Epoch 95: head: Default, loss=0.04608694, RMSE_E_per_atom=    1.83 meV, RMSE_F=   32.40 meV / A
2025-07-29 07:42:55.699 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-93.pt
2025-07-29 07:42:55.785 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-95.pt
2025-07-29 07:51:44.849 INFO: Epoch 96: head: Default, loss=0.04813244, RMSE_E_per_atom=    4.55 meV, RMSE_F=   32.56 meV / A
2025-07-29 08:00:33.656 INFO: Epoch 97: head: Default, loss=0.04598513, RMSE_E_per_atom=    2.57 meV, RMSE_F=   32.30 meV / A
2025-07-29 08:00:33.658 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-95.pt
2025-07-29 08:00:33.696 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-97.pt
2025-07-29 08:09:22.934 INFO: Epoch 98: head: Default, loss=0.04557744, RMSE_E_per_atom=    1.77 meV, RMSE_F=   32.25 meV / A
2025-07-29 08:09:22.936 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-97.pt
2025-07-29 08:09:22.975 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-98.pt
2025-07-29 08:18:12.216 INFO: Epoch 99: head: Default, loss=0.05089304, RMSE_E_per_atom=    3.11 meV, RMSE_F=   34.04 meV / A
2025-07-29 08:27:01.099 INFO: Epoch 100: head: Default, loss=0.05456724, RMSE_E_per_atom=    4.68 meV, RMSE_F=   34.93 meV / A
2025-07-29 08:35:49.911 INFO: Epoch 101: head: Default, loss=0.04537284, RMSE_E_per_atom=    2.56 meV, RMSE_F=   32.05 meV / A
2025-07-29 08:35:49.913 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-98.pt
2025-07-29 08:35:49.987 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-101.pt
2025-07-29 08:44:39.199 INFO: Epoch 102: head: Default, loss=0.04503444, RMSE_E_per_atom=    1.50 meV, RMSE_F=   32.08 meV / A
2025-07-29 08:44:39.201 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-101.pt
2025-07-29 08:44:39.252 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-102.pt
2025-07-29 08:53:28.248 INFO: Epoch 103: head: Default, loss=0.04728077, RMSE_E_per_atom=    1.41 meV, RMSE_F=   32.93 meV / A
2025-07-29 09:02:17.316 INFO: Epoch 104: head: Default, loss=0.04516728, RMSE_E_per_atom=    2.77 meV, RMSE_F=   31.99 meV / A
2025-07-29 09:11:06.165 INFO: Epoch 105: head: Default, loss=0.04545154, RMSE_E_per_atom=    2.62 meV, RMSE_F=   32.11 meV / A
2025-07-29 09:19:54.856 INFO: Epoch 106: head: Default, loss=0.04537985, RMSE_E_per_atom=    2.36 meV, RMSE_F=   32.05 meV / A
2025-07-29 09:28:43.732 INFO: Epoch 107: head: Default, loss=0.04466118, RMSE_E_per_atom=    1.47 meV, RMSE_F=   31.94 meV / A
2025-07-29 09:28:43.734 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-102.pt
2025-07-29 09:28:43.805 DEBUG: Saving checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-107.pt
2025-07-29 09:37:32.637 INFO: Epoch 108: head: Default, loss=0.04549373, RMSE_E_per_atom=    1.56 meV, RMSE_F=   32.23 meV / A
2025-07-29 09:46:21.312 INFO: Epoch 109: head: Default, loss=0.04515088, RMSE_E_per_atom=    1.50 meV, RMSE_F=   32.13 meV / A
2025-07-29 09:46:21.313 INFO: Training complete
2025-07-29 09:46:21.314 INFO: 
2025-07-29 09:46:21.314 INFO: ===========RESULTS===========
2025-07-29 09:46:21.422 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-107.pt
2025-07-29 09:46:21.455 INFO: Loaded Stage one model from epoch 107 for evaluation
2025-07-29 09:46:21.455 INFO: Saving model to checkpoints/mace_T3_finetune_h200_cn10_run-21.model
2025-07-29 09:46:21.729 INFO: Compiling model, saving metadata to mace_T3_finetune_h200_cn10_compiled.model
2025-07-29 09:46:23.743 INFO: Computing metrics for training, validation, and test sets
2025-07-29 09:46:23.744 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-29 09:46:23.744 INFO: Evaluating train_Default ...
2025-07-29 09:48:55.669 INFO: Evaluating valid_Default ...
2025-07-29 09:50:08.558 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+---------------+---------------------+------------------+-------------------+
| train_Default |            1.5      |         28.2     |          8.13     |
| valid_Default |            1.5      |         31.9     |          9.29     |
+---------------+---------------------+------------------+-------------------+
2025-07-29 09:50:08.558 DEBUG: Running inference on train_Default dataset
2025-07-29 09:52:41.119 DEBUG: Running inference on valid_Default dataset
2025-07-29 09:54:28.165 INFO: Done
2025-08-14 03:33:08.799 INFO: ===========VERIFYING SETTINGS===========
2025-08-14 03:33:08.799 INFO: MACE version: 0.3.14
2025-08-14 03:33:08.799 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f75b1d8e980>, compute_atomic_dipole=<function str2bool at 0x7f75b1d8e980>, train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/binary_elem_test.extxyz', valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/binary_elem_val.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=50.0, swa_forces_weight=100.0, energy_weight=75.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=130, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-14 03:33:09.350 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-14 03:33:09.443 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-08-14 03:33:09.446 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-08-14 03:33:09.454 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-14 03:33:09.465 DEBUG: Current Git commit: 1d90e32d2a2ab1a0f37f8f552c105b53a5efa803
2025-08-14 03:33:09.877 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-14 03:33:09.878 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-08-14 03:33:09.878 INFO: ===========LOADING INPUT DATA===========
2025-08-14 03:33:09.878 INFO: Using heads: ['Default']
2025-08-14 03:33:09.878 INFO: Using the key specifications to parse data:
2025-08-14 03:33:09.878 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-14 03:33:09.878 INFO: =============    Processing head Default     ===========
2025-08-14 03:33:09.879 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/binary_elem_test.extxyz
2025-08-14 03:33:10.107 INFO: Training set 1/1 [energy: 1200, stress: 0, virials: 0, dipole components: 0, head: 1200, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1200, charges: 0]
2025-08-14 03:33:10.110 INFO: Total Training set [energy: 1200, stress: 0, virials: 0, dipole components: 0, head: 1200, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1200, charges: 0]
2025-08-14 03:33:10.430 INFO: Validation set 1/1 [energy: 1800, stress: 0, virials: 0, dipole components: 0, head: 1800, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1800, charges: 0]
2025-08-14 03:33:10.435 INFO: Total Validation set [energy: 1800, stress: 0, virials: 0, dipole components: 0, head: 1800, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1800, charges: 0]
2025-08-14 03:33:10.435 INFO: Total number of configurations: train=1200, valid=1800, tests=[],
2025-08-14 03:33:10.437 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-08-14 03:33:10.437 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-14 03:33:10.437 INFO: Computing average Atomic Energies using least squares regression
2025-08-14 03:33:10.442 INFO: Atomic Energies used (z: eV) for head Default: {3: 0.12686486466246572, 8: -0.5040028186029172, 40: 2.637859408854715, 57: 0.7164206613193861}
2025-08-14 03:33:10.443 INFO: Processing datasets for head 'Default'
2025-08-14 03:33:10.821 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/binary_elem_test.extxyz']
2025-08-14 03:33:10.821 INFO: Combining 1 list datasets for head 'Default'
2025-08-14 03:33:11.568 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/binary_elem_val.extxyz']
2025-08-14 03:33:11.568 INFO: Combining 1 list datasets for head 'Default_valid'
2025-08-14 03:33:11.569 INFO: Combined validation datasets for Default
2025-08-14 03:33:11.569 INFO: Head 'Default' training dataset size: 1200
2025-08-14 03:33:11.569 INFO: Computing average number of neighbors
2025-08-14 03:33:12.043 INFO: Average number of neighbors: 70.09490333919156
2025-08-14 03:33:12.043 INFO: During training the following quantities will be reported: energy, forces
2025-08-14 03:33:12.043 INFO: ===========MODEL DETAILS===========
2025-08-14 03:33:12.530 INFO: Loading FOUNDATION model
2025-08-14 03:33:12.530 INFO: Using filtered elements: [3, 8, 40, 57]
2025-08-14 03:33:12.531 INFO: Model configuration extracted from foundation model
2025-08-14 03:33:12.531 INFO: Using weighted loss function for fine-tuning
2025-08-14 03:33:12.531 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-14 03:33:12.531 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-14 03:33:12.531 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-14 03:33:12.531 INFO: Distance transform for radial basis functions: None
2025-08-14 03:33:13.841 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[0.1269, -0.5040, 2.6379, 0.7164]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-08-14 03:33:13.842 INFO: Total number of parameters: 894362
2025-08-14 03:33:13.842 INFO: 
2025-08-14 03:33:13.842 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-14 03:33:13.842 INFO: Using ADAM as parameter optimizer
2025-08-14 03:33:13.842 INFO: Batch size: 2
2025-08-14 03:33:13.842 INFO: Number of gradient updates: 78000
2025-08-14 03:33:13.842 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-08-14 03:33:13.843 INFO: WeightedEnergyForcesLoss(energy_weight=75.000, forces_weight=50.000)
2025-08-14 03:33:13.851 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-08-14 03:33:13.851 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-107.pt
2025-08-14 03:33:14.381 INFO: Using gradient clipping with tolerance=10.000
2025-08-14 03:33:14.381 INFO: 
2025-08-14 03:33:14.381 INFO: ===========TRAINING===========
2025-08-14 03:33:14.381 INFO: Started training, reporting errors on validation set
2025-08-14 03:33:14.381 INFO: Loss metrics on validation set
2025-08-14 03:34:34.083 INFO: Initial: head: Default, loss=1395741819904174592.00000000, RMSE_E_per_atom=6025895098.72 meV, RMSE_F=191939293509.70 meV / A
2025-08-14 03:35:32.191 INFO: ===========VERIFYING SETTINGS===========
2025-08-14 03:35:32.191 INFO: MACE version: 0.3.14
2025-08-14 03:35:32.191 DEBUG: Configuration: Namespace(config=None, name='mace_T3_finetune_h200_cn10', seed=21, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f1bb6c96980>, compute_atomic_dipole=<function str2bool at 0x7f1bb6c96980>, train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='average', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=50.0, swa_forces_weight=100.0, energy_weight=75.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=130, patience=5, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-14 03:35:32.723 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-14 03:35:32.830 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-08-14 03:35:32.834 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-08-14 03:35:32.842 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-14 03:35:32.851 DEBUG: Current Git commit: 1d90e32d2a2ab1a0f37f8f552c105b53a5efa803
2025-08-14 03:35:33.181 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-14 03:35:33.182 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-08-14 03:35:33.182 INFO: ===========LOADING INPUT DATA===========
2025-08-14 03:35:33.182 INFO: Using heads: ['Default']
2025-08-14 03:35:33.182 INFO: Using the key specifications to parse data:
2025-08-14 03:35:33.182 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-14 03:35:33.182 INFO: =============    Processing head Default     ===========
2025-08-14 03:35:33.184 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz
2025-08-14 03:35:39.636 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-14 03:35:39.641 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-14 03:35:42.362 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-14 03:35:42.364 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-14 03:35:42.365 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-08-14 03:35:42.461 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-08-14 03:35:42.461 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-14 03:35:42.461 INFO: Computing average Atomic Energies using least squares regression
2025-08-14 03:35:42.472 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2540780821271085, 8: -23.24624846055724, 40: 25.75052291255275, 57: 14.835671874568682}
2025-08-14 03:35:42.472 INFO: Processing datasets for head 'Default'
2025-08-14 03:36:02.024 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz']
2025-08-14 03:36:02.024 INFO: Combining 1 list datasets for head 'Default'
2025-08-14 03:36:10.777 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-08-14 03:36:10.777 INFO: Combining 1 list datasets for head 'Default_valid'
2025-08-14 03:36:10.777 INFO: Combined validation datasets for Default
2025-08-14 03:36:10.777 INFO: Head 'Default' training dataset size: 1612
2025-08-14 03:36:10.778 INFO: Computing average number of neighbors
2025-08-14 03:36:12.820 INFO: Average number of neighbors: 67.30184267634576
2025-08-14 03:36:12.821 INFO: During training the following quantities will be reported: energy, forces
2025-08-14 03:36:12.821 INFO: ===========MODEL DETAILS===========
2025-08-14 03:36:14.591 INFO: Loading FOUNDATION model
2025-08-14 03:36:14.592 INFO: Using filtered elements: [3, 8, 40, 57]
2025-08-14 03:36:14.592 INFO: Model configuration extracted from foundation model
2025-08-14 03:36:14.592 INFO: Using weighted loss function for fine-tuning
2025-08-14 03:36:14.592 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-14 03:36:14.592 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-14 03:36:14.592 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-14 03:36:14.592 INFO: Distance transform for radial basis functions: None
2025-08-14 03:36:15.850 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2541, -23.2462, 25.7505, 14.8357]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-08-14 03:36:15.851 INFO: Total number of parameters: 894362
2025-08-14 03:36:15.851 INFO: 
2025-08-14 03:36:15.851 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-14 03:36:15.852 INFO: Using ADAM as parameter optimizer
2025-08-14 03:36:15.852 INFO: Batch size: 2
2025-08-14 03:36:15.852 INFO: Number of gradient updates: 104780
2025-08-14 03:36:15.853 INFO: Learning rate: 0.001, weight decay: 5e-07
2025-08-14 03:36:15.853 INFO: WeightedEnergyForcesLoss(energy_weight=75.000, forces_weight=50.000)
2025-08-14 03:36:15.858 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-08-14 03:36:15.858 INFO: Loading checkpoint: ./checkpoints/mace_T3_finetune_h200_cn10_run-21_epoch-107.pt
2025-08-14 03:36:15.891 INFO: Using gradient clipping with tolerance=10.000
2025-08-14 03:36:15.891 INFO: 
2025-08-14 03:36:15.892 INFO: ===========TRAINING===========
2025-08-14 03:36:15.892 INFO: Started training, reporting errors on validation set
2025-08-14 03:36:15.892 INFO: Loss metrics on validation set
