2025-08-20 16:12:03.296 INFO: ===========VERIFYING SETTINGS===========
2025-08-20 16:12:03.296 INFO: MACE version: 0.3.14
2025-08-20 16:12:03.296 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f8b37096c00>, compute_atomic_dipole=<function str2bool at 0x7f8b37096c00>, train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=3.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-20 16:12:03.914 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-20 16:12:04.007 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3, stdin=None, shell=False, universal_newlines=False)
2025-08-20 16:12:04.011 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3, stdin=None, shell=False, universal_newlines=False)
2025-08-20 16:12:04.018 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-20 16:12:04.028 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-20 16:12:04.371 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-20 16:12:04.372 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-20 16:12:04.372 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-20 16:12:04.372 INFO: ===========LOADING INPUT DATA===========
2025-08-20 16:12:04.372 INFO: Using heads: ['Default', 'pt_head']
2025-08-20 16:12:04.372 INFO: Using the key specifications to parse data:
2025-08-20 16:12:04.373 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-20 16:12:04.373 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-20 16:12:04.373 INFO: =============    Processing head Default     ===========
2025-08-20 16:12:04.374 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz
2025-08-20 16:12:09.747 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-20 16:12:09.751 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-20 16:12:12.094 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-20 16:12:12.096 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-20 16:12:12.096 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-08-20 16:12:12.096 INFO: =============    Processing head pt_head     ===========
2025-08-20 16:12:12.097 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz
2025-08-20 16:12:15.129 INFO: Training set 1/1 [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-20 16:12:15.156 INFO: Total Training set [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-20 16:12:15.156 INFO: No validation set provided, splitting training data instead.
2025-08-20 16:12:15.159 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_84.txt
2025-08-20 16:12:15.190 INFO: Random Split Training set [energy: 9000, stress: 9000, virials: 0, dipole components: 0, head: 9000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 9000, charges: 0]
2025-08-20 16:12:15.193 INFO: Random Split Validation set [energy: 1000, stress: 1000, virials: 0, dipole components: 0, head: 1000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1000, charges: 0]
2025-08-20 16:12:15.193 INFO: Total number of configurations: train=9000, valid=1000, tests=[],
2025-08-20 16:12:15.193 INFO: ==================Using multiheads finetuning mode==================
2025-08-20 16:12:15.194 INFO: Total number of configurations in pretraining: train=9000, valid=1000
2025-08-20 16:12:15.194 INFO: Using atomic numbers from command line argument
2025-08-20 16:12:15.219 INFO: Atomic Numbers used: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-20 16:12:15.219 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-20 16:12:15.223 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-08-20 16:12:15.223 INFO: Atomic Energies used (z: eV) for head pt_head: {1: -3.667168021358939, 3: -3.482100566595956, 4: -4.736697230897597, 5: -7.724935420523256, 6: -8.405573550273285, 7: -7.360100452662763, 8: -7.28459863421322, 9: -4.896490881731322, 11: -2.7593613569762425, 12: -2.814047612069227, 13: -4.846881245288104, 14: -7.694793133351899, 15: -6.9632957911820235, 16: -4.672630400190884, 17: -2.8116892814008096, 19: -2.6176454856894793, 20: -5.390461060484104, 21: -7.8857952163517675, 22: -10.268392986214433, 23: -8.665147785496703, 24: -9.233050763772013, 25: -8.304951520770791, 26: -7.0489865771593765, 27: -5.577439766222147, 28: -5.172747618813715, 29: -3.2520726958619472, 30: -1.2901611618726314, 31: -3.527082192997912, 32: -4.70845955030298, 33: -3.9765109025623238, 34: -3.886231055836541, 35: -2.5184940099633986, 36: 6.766947645687137, 37: -2.5634958965928316, 38: -4.938005211501922, 39: -10.149818838085771, 40: -11.846857579882572, 41: -12.138896361658485, 42: -8.791678800595722, 43: -8.78694939675911, 44: -7.78093221529871, 45: -6.850021409115055, 46: -4.891019073240479, 47: -2.0634296773864045, 48: -0.6395695518943755, 49: -2.7887442084286693, 50: -3.818604275441892, 51: -3.587068329278862, 52: -2.8804045971118897, 53: -1.6355986842433357, 54: 9.846723842807721, 55: -2.765284507132287, 56: -4.990956432167774, 57: -8.933684809576345, 58: -8.735591176647514, 59: -8.018966025544966, 60: -8.251491970213372, 61: -7.591719594359237, 62: -8.169659881166858, 63: -13.592664636171698, 64: -18.517523458456985, 65: -7.647396572993602, 66: -8.122981037851925, 67: -7.607787319678067, 68: -6.85029094445494, 69: -7.8268821327130365, 70: -3.584786591677161, 71: -7.455406192077973, 72: -12.796283502572146, 73: -14.108127281277586, 74: -9.354916969477486, 75: -11.387537567890853, 76: -9.621909492152557, 77: -7.324393429417677, 78: -5.3046964808341945, 79: -2.380092582080244, 80: 0.24948924158195362, 81: -2.3239789120665026, 82: -3.730042357127322, 83: -3.438792347649683, 89: -5.062878214511315, 90: -11.02462566385297, 91: -12.265613551943261, 92: -13.855648206100362, 93: -14.933092020258243, 94: -15.282826131998245}
2025-08-20 16:12:15.223 INFO: Processing datasets for head 'Default'
2025-08-20 16:12:34.965 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz']
2025-08-20 16:12:34.965 INFO: Combining 1 list datasets for head 'Default'
2025-08-20 16:12:43.950 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-08-20 16:12:43.951 INFO: Combining 1 list datasets for head 'Default_valid'
2025-08-20 16:12:43.951 INFO: Combined validation datasets for Default
2025-08-20 16:12:43.951 INFO: Head 'Default' training dataset size: 1612
2025-08-20 16:12:43.951 INFO: Processing datasets for head 'pt_head'
2025-08-20 16:12:52.235 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz']
2025-08-20 16:12:52.235 INFO: Combining 1 list datasets for head 'pt_head'
2025-08-20 16:12:53.149 INFO: Head 'pt_head' training dataset size: 9000
2025-08-20 16:12:53.149 INFO: Average number of neighbors: 61.964672446250916
2025-08-20 16:12:53.149 INFO: During training the following quantities will be reported: energy, forces, stress
2025-08-20 16:12:53.149 INFO: ===========MODEL DETAILS===========
2025-08-20 16:13:03.697 INFO: Loading FOUNDATION model
2025-08-20 16:13:03.699 INFO: Using filtered elements: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-20 16:13:03.699 INFO: Model configuration extracted from foundation model
2025-08-20 16:13:03.699 INFO: Using universal loss function for fine-tuning
2025-08-20 16:13:03.699 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-20 16:13:03.699 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-20 16:13:03.699 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-20 16:13:03.699 INFO: Distance transform for radial basis functions: None
2025-08-20 16:13:05.116 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(86x0e -> 128x0e | 11008 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.6672, -3.4821, -4.7367, -7.7249, -8.4056, -7.3601, -7.2846, -4.8965, -2.7594, -2.8140, -4.8469, -7.6948, -6.9633, -4.6726, -2.8117, -2.6176, -5.3905, -7.8858, -10.2684, -8.6651, -9.2331, -8.3050, -7.0490, -5.5774, -5.1727, -3.2521, -1.2902, -3.5271, -4.7085, -3.9765, -3.8862, -2.5185, 6.7669, -2.5635, -4.9380, -10.1498, -11.8469, -12.1389, -8.7917, -8.7869, -7.7809, -6.8500, -4.8910, -2.0634, -0.6396, -2.7887, -3.8186, -3.5871, -2.8804, -1.6356, 9.8467, -2.7653, -4.9910, -8.9337, -8.7356, -8.0190, -8.2515, -7.5917, -8.1697, -13.5927, -18.5175, -7.6474, -8.1230, -7.6078, -6.8503, -7.8269, -3.5848, -7.4554, -12.7963, -14.1081, -9.3549, -11.3875, -9.6219, -7.3244, -5.3047, -2.3801, 0.2495, -2.3240, -3.7300, -3.4388, -5.0629, -11.0246, -12.2656, -13.8556, -14.9331, -15.2828], [0.0000, -1.2303, 0.0000, 0.0000, 0.0000, 0.0000, -23.0491, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 23.3676, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 15.1929, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 86x0e -> 128x0e+128x1o+128x2e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 86x0e -> 128x0e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-08-20 16:13:05.119 INFO: Total number of parameters: 5556810
2025-08-20 16:13:05.119 INFO: 
2025-08-20 16:13:05.119 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-20 16:13:05.120 INFO: Using ADAM as parameter optimizer
2025-08-20 16:13:05.120 INFO: Batch size: 1
2025-08-20 16:13:05.120 INFO: Using Exponential Moving Average with decay: 0.99999
2025-08-20 16:13:05.120 INFO: Number of gradient updates: 1379560
2025-08-20 16:13:05.120 INFO: Learning rate: 0.0001, weight decay: 1e-08
2025-08-20 16:13:05.120 INFO: UniversalLoss(energy_weight=10.000, forces_weight=0.000, stress_weight=0.000)
2025-08-20 16:13:05.122 WARNING: Cannot find checkpoint with tag 'mace_T2_including_replay_w2_run-84' in './checkpoints'
2025-08-20 16:13:05.122 INFO: Using gradient clipping with tolerance=3.000
2025-08-20 16:13:05.123 INFO: 
2025-08-20 16:13:05.123 INFO: ===========TRAINING===========
2025-08-20 16:13:05.123 INFO: Started training, reporting errors on validation set
2025-08-20 16:13:05.123 INFO: Loss metrics on validation set
2025-08-20 16:13:52.140 INFO: Initial: head: pt_head, loss=0.03504716, RMSE_E_per_atom=  468.57 meV, RMSE_F=   99.92 meV / A, RMSE_stress=    6.45 meV / A^3
2025-08-20 16:15:28.209 INFO: Initial: head: Default, loss=0.11800754, RMSE_E_per_atom= 1245.40 meV, RMSE_F=  959.54 meV / A, RMSE_stress=None meV / A^3
2025-08-20 16:34:19.676 INFO: Epoch 0: head: pt_head, loss=0.00311552, RMSE_E_per_atom=   68.06 meV, RMSE_F=  245.91 meV / A, RMSE_stress=   13.80 meV / A^3
2025-08-20 16:35:56.461 INFO: Epoch 0: head: Default, loss=0.00565870, RMSE_E_per_atom=   78.18 meV, RMSE_F=  883.68 meV / A, RMSE_stress=None meV / A^3
2025-08-20 16:35:56.464 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-0.pt
2025-08-20 16:54:45.857 INFO: Epoch 1: head: pt_head, loss=0.00263426, RMSE_E_per_atom=   61.72 meV, RMSE_F=  230.37 meV / A, RMSE_stress=   10.94 meV / A^3
2025-08-20 16:56:22.670 INFO: Epoch 1: head: Default, loss=0.00277952, RMSE_E_per_atom=   43.32 meV, RMSE_F= 1480.47 meV / A, RMSE_stress=None meV / A^3
2025-08-20 16:56:22.672 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-0.pt
2025-08-20 16:56:22.733 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-1.pt
2025-08-20 17:15:10.304 INFO: Epoch 2: head: pt_head, loss=0.00248974, RMSE_E_per_atom=   58.45 meV, RMSE_F=  219.94 meV / A, RMSE_stress=   10.36 meV / A^3
2025-08-20 17:16:46.888 INFO: Epoch 2: head: Default, loss=0.00199458, RMSE_E_per_atom=   32.04 meV, RMSE_F= 1644.95 meV / A, RMSE_stress=None meV / A^3
2025-08-20 17:16:46.891 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-1.pt
2025-08-20 17:16:47.030 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-2.pt
2025-08-20 17:35:37.836 INFO: Epoch 3: head: pt_head, loss=0.00234888, RMSE_E_per_atom=   56.09 meV, RMSE_F=  234.96 meV / A, RMSE_stress=    9.83 meV / A^3
2025-08-20 17:37:14.833 INFO: Epoch 3: head: Default, loss=0.00151780, RMSE_E_per_atom=   25.24 meV, RMSE_F= 1700.82 meV / A, RMSE_stress=None meV / A^3
2025-08-20 17:37:14.835 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-2.pt
2025-08-20 17:37:14.923 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-3.pt
2025-08-20 17:56:03.573 INFO: Epoch 4: head: pt_head, loss=0.00230042, RMSE_E_per_atom=   55.03 meV, RMSE_F=  234.03 meV / A, RMSE_stress=    9.53 meV / A^3
2025-08-20 17:57:40.367 INFO: Epoch 4: head: Default, loss=0.00118307, RMSE_E_per_atom=   20.85 meV, RMSE_F= 1667.34 meV / A, RMSE_stress=None meV / A^3
2025-08-20 17:57:40.369 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-3.pt
2025-08-20 17:57:40.607 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-4.pt
2025-08-20 18:16:28.311 INFO: Epoch 5: head: pt_head, loss=0.00222731, RMSE_E_per_atom=   53.84 meV, RMSE_F=  244.68 meV / A, RMSE_stress=    9.67 meV / A^3
2025-08-20 18:18:05.015 INFO: Epoch 5: head: Default, loss=0.00099172, RMSE_E_per_atom=   18.36 meV, RMSE_F= 1599.75 meV / A, RMSE_stress=None meV / A^3
2025-08-20 18:18:05.018 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-4.pt
2025-08-20 18:18:05.112 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-5.pt
2025-08-20 18:36:56.169 INFO: Epoch 6: head: pt_head, loss=0.00221956, RMSE_E_per_atom=   52.78 meV, RMSE_F=  256.98 meV / A, RMSE_stress=    9.77 meV / A^3
2025-08-20 18:38:33.103 INFO: Epoch 6: head: Default, loss=0.00087962, RMSE_E_per_atom=   16.79 meV, RMSE_F= 1545.49 meV / A, RMSE_stress=None meV / A^3
2025-08-20 18:38:33.106 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-5.pt
2025-08-20 18:38:33.184 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-6.pt
2025-08-20 18:57:24.096 INFO: Epoch 7: head: pt_head, loss=0.00223613, RMSE_E_per_atom=   53.12 meV, RMSE_F=  268.94 meV / A, RMSE_stress=    9.76 meV / A^3
2025-08-20 18:59:01.131 INFO: Epoch 7: head: Default, loss=0.00075422, RMSE_E_per_atom=   15.05 meV, RMSE_F= 1488.57 meV / A, RMSE_stress=None meV / A^3
2025-08-20 18:59:01.133 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-6.pt
2025-08-20 18:59:01.320 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-7.pt
2025-08-20 19:17:51.457 INFO: Epoch 8: head: pt_head, loss=0.00226490, RMSE_E_per_atom=   54.66 meV, RMSE_F=  287.29 meV / A, RMSE_stress=    9.90 meV / A^3
2025-08-20 19:19:27.819 INFO: Epoch 8: head: Default, loss=0.00068531, RMSE_E_per_atom=   14.02 meV, RMSE_F= 1448.25 meV / A, RMSE_stress=None meV / A^3
2025-08-20 19:19:27.822 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-7.pt
2025-08-20 19:19:27.988 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-8.pt
2025-08-20 19:38:16.690 INFO: Epoch 9: head: pt_head, loss=0.00226826, RMSE_E_per_atom=   55.54 meV, RMSE_F=  293.47 meV / A, RMSE_stress=    9.87 meV / A^3
2025-08-20 19:39:53.401 INFO: Epoch 9: head: Default, loss=0.00062567, RMSE_E_per_atom=   13.18 meV, RMSE_F= 1410.68 meV / A, RMSE_stress=None meV / A^3
2025-08-20 19:39:53.405 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-8.pt
2025-08-20 19:39:53.541 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-9.pt
2025-08-20 19:58:42.924 INFO: Epoch 10: head: pt_head, loss=0.00229048, RMSE_E_per_atom=   58.46 meV, RMSE_F=  299.69 meV / A, RMSE_stress=   10.05 meV / A^3
2025-08-20 20:00:19.823 INFO: Epoch 10: head: Default, loss=0.00057724, RMSE_E_per_atom=   12.49 meV, RMSE_F= 1376.02 meV / A, RMSE_stress=None meV / A^3
2025-08-20 20:00:19.826 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-9.pt
2025-08-20 20:00:19.949 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-10.pt
2025-08-20 20:19:08.608 INFO: Epoch 11: head: pt_head, loss=0.00230833, RMSE_E_per_atom=   60.91 meV, RMSE_F=  301.95 meV / A, RMSE_stress=   10.10 meV / A^3
2025-08-20 20:20:45.070 INFO: Epoch 11: head: Default, loss=0.00053127, RMSE_E_per_atom=   11.81 meV, RMSE_F= 1356.55 meV / A, RMSE_stress=None meV / A^3
2025-08-20 20:20:45.073 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-10.pt
2025-08-20 20:20:45.203 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-11.pt
2025-08-20 20:39:35.137 INFO: Epoch 12: head: pt_head, loss=0.00233936, RMSE_E_per_atom=   66.03 meV, RMSE_F=  309.54 meV / A, RMSE_stress=   10.38 meV / A^3
2025-08-20 20:41:11.967 INFO: Epoch 12: head: Default, loss=0.00049921, RMSE_E_per_atom=   11.34 meV, RMSE_F= 1345.80 meV / A, RMSE_stress=None meV / A^3
2025-08-20 20:41:11.970 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-11.pt
2025-08-20 20:41:12.062 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-12.pt
2025-08-20 21:00:02.971 INFO: Epoch 13: head: pt_head, loss=0.00234717, RMSE_E_per_atom=   67.13 meV, RMSE_F=  305.30 meV / A, RMSE_stress=   10.55 meV / A^3
2025-08-20 21:01:39.687 INFO: Epoch 13: head: Default, loss=0.00046678, RMSE_E_per_atom=   10.89 meV, RMSE_F= 1336.86 meV / A, RMSE_stress=None meV / A^3
2025-08-20 21:01:39.690 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-12.pt
2025-08-20 21:01:39.764 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-13.pt
2025-08-20 21:20:30.385 INFO: Epoch 14: head: pt_head, loss=0.00233917, RMSE_E_per_atom=   66.03 meV, RMSE_F=  308.84 meV / A, RMSE_stress=   10.61 meV / A^3
2025-08-20 21:22:06.912 INFO: Epoch 14: head: Default, loss=0.00044544, RMSE_E_per_atom=   10.58 meV, RMSE_F= 1329.63 meV / A, RMSE_stress=None meV / A^3
2025-08-20 21:22:06.915 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-13.pt
2025-08-20 21:22:07.015 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-14.pt
2025-08-20 21:40:58.275 INFO: Epoch 15: head: pt_head, loss=0.00234481, RMSE_E_per_atom=   66.69 meV, RMSE_F=  314.20 meV / A, RMSE_stress=   10.76 meV / A^3
2025-08-20 21:42:34.988 INFO: Epoch 15: head: Default, loss=0.00042530, RMSE_E_per_atom=   10.31 meV, RMSE_F= 1316.81 meV / A, RMSE_stress=None meV / A^3
2025-08-20 21:42:34.991 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-14.pt
2025-08-20 21:42:35.083 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-15.pt
2025-08-20 22:01:24.876 INFO: Epoch 16: head: pt_head, loss=0.00234201, RMSE_E_per_atom=   66.74 meV, RMSE_F=  318.77 meV / A, RMSE_stress=   10.85 meV / A^3
2025-08-20 22:03:01.828 INFO: Epoch 16: head: Default, loss=0.00040376, RMSE_E_per_atom=    9.99 meV, RMSE_F= 1311.70 meV / A, RMSE_stress=None meV / A^3
2025-08-20 22:03:01.831 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-15.pt
2025-08-20 22:03:01.895 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-16.pt
2025-08-20 22:21:53.343 INFO: Epoch 17: head: pt_head, loss=0.00235407, RMSE_E_per_atom=   67.43 meV, RMSE_F=  321.69 meV / A, RMSE_stress=   11.00 meV / A^3
2025-08-20 22:23:29.796 INFO: Epoch 17: head: Default, loss=0.00038677, RMSE_E_per_atom=    9.73 meV, RMSE_F= 1308.31 meV / A, RMSE_stress=None meV / A^3
2025-08-20 22:23:29.800 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-16.pt
2025-08-20 22:23:29.870 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-17.pt
2025-08-20 22:40:35.403 INFO: ===========VERIFYING SETTINGS===========
2025-08-20 22:40:35.403 INFO: MACE version: 0.3.14
2025-08-20 22:40:35.403 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f5b9ed8ac00>, compute_atomic_dipole=<function str2bool at 0x7f5b9ed8ac00>, train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=3.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-20 22:40:36.162 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-20 22:40:36.408 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3, stdin=None, shell=False, universal_newlines=False)
2025-08-20 22:40:36.411 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3, stdin=None, shell=False, universal_newlines=False)
2025-08-20 22:40:36.567 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-20 22:40:36.753 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-20 22:40:37.291 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-20 22:40:37.292 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-20 22:40:37.292 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-20 22:40:37.292 INFO: ===========LOADING INPUT DATA===========
2025-08-20 22:40:37.292 INFO: Using heads: ['Default', 'pt_head']
2025-08-20 22:40:37.292 INFO: Using the key specifications to parse data:
2025-08-20 22:40:37.292 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-20 22:40:37.292 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-20 22:40:37.292 INFO: =============    Processing head Default     ===========
2025-08-20 22:40:37.292 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz
2025-08-20 22:40:42.674 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-20 22:40:42.679 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-20 22:40:45.061 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-20 22:40:45.063 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-20 22:40:45.063 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-08-20 22:40:45.063 INFO: =============    Processing head pt_head     ===========
2025-08-20 22:40:45.097 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz
2025-08-20 22:40:48.141 INFO: Training set 1/1 [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-20 22:40:48.169 INFO: Total Training set [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-20 22:40:48.169 INFO: No validation set provided, splitting training data instead.
2025-08-20 22:40:48.172 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_84.txt
2025-08-20 22:40:48.202 INFO: Random Split Training set [energy: 9000, stress: 9000, virials: 0, dipole components: 0, head: 9000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 9000, charges: 0]
2025-08-20 22:40:48.205 INFO: Random Split Validation set [energy: 1000, stress: 1000, virials: 0, dipole components: 0, head: 1000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1000, charges: 0]
2025-08-20 22:40:48.205 INFO: Total number of configurations: train=9000, valid=1000, tests=[],
2025-08-20 22:40:48.205 INFO: ==================Using multiheads finetuning mode==================
2025-08-20 22:40:48.205 INFO: Total number of configurations in pretraining: train=9000, valid=1000
2025-08-20 22:40:48.205 INFO: Using atomic numbers from command line argument
2025-08-20 22:40:48.231 INFO: Atomic Numbers used: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-20 22:40:48.231 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-20 22:40:48.235 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-08-20 22:40:48.235 INFO: Atomic Energies used (z: eV) for head pt_head: {1: -3.667168021358939, 3: -3.482100566595956, 4: -4.736697230897597, 5: -7.724935420523256, 6: -8.405573550273285, 7: -7.360100452662763, 8: -7.28459863421322, 9: -4.896490881731322, 11: -2.7593613569762425, 12: -2.814047612069227, 13: -4.846881245288104, 14: -7.694793133351899, 15: -6.9632957911820235, 16: -4.672630400190884, 17: -2.8116892814008096, 19: -2.6176454856894793, 20: -5.390461060484104, 21: -7.8857952163517675, 22: -10.268392986214433, 23: -8.665147785496703, 24: -9.233050763772013, 25: -8.304951520770791, 26: -7.0489865771593765, 27: -5.577439766222147, 28: -5.172747618813715, 29: -3.2520726958619472, 30: -1.2901611618726314, 31: -3.527082192997912, 32: -4.70845955030298, 33: -3.9765109025623238, 34: -3.886231055836541, 35: -2.5184940099633986, 36: 6.766947645687137, 37: -2.5634958965928316, 38: -4.938005211501922, 39: -10.149818838085771, 40: -11.846857579882572, 41: -12.138896361658485, 42: -8.791678800595722, 43: -8.78694939675911, 44: -7.78093221529871, 45: -6.850021409115055, 46: -4.891019073240479, 47: -2.0634296773864045, 48: -0.6395695518943755, 49: -2.7887442084286693, 50: -3.818604275441892, 51: -3.587068329278862, 52: -2.8804045971118897, 53: -1.6355986842433357, 54: 9.846723842807721, 55: -2.765284507132287, 56: -4.990956432167774, 57: -8.933684809576345, 58: -8.735591176647514, 59: -8.018966025544966, 60: -8.251491970213372, 61: -7.591719594359237, 62: -8.169659881166858, 63: -13.592664636171698, 64: -18.517523458456985, 65: -7.647396572993602, 66: -8.122981037851925, 67: -7.607787319678067, 68: -6.85029094445494, 69: -7.8268821327130365, 70: -3.584786591677161, 71: -7.455406192077973, 72: -12.796283502572146, 73: -14.108127281277586, 74: -9.354916969477486, 75: -11.387537567890853, 76: -9.621909492152557, 77: -7.324393429417677, 78: -5.3046964808341945, 79: -2.380092582080244, 80: 0.24948924158195362, 81: -2.3239789120665026, 82: -3.730042357127322, 83: -3.438792347649683, 89: -5.062878214511315, 90: -11.02462566385297, 91: -12.265613551943261, 92: -13.855648206100362, 93: -14.933092020258243, 94: -15.282826131998245}
2025-08-20 22:40:48.235 INFO: Processing datasets for head 'Default'
2025-08-20 22:41:08.358 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz']
2025-08-20 22:41:08.358 INFO: Combining 1 list datasets for head 'Default'
2025-08-20 22:41:17.412 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-08-20 22:41:17.412 INFO: Combining 1 list datasets for head 'Default_valid'
2025-08-20 22:41:17.413 INFO: Combined validation datasets for Default
2025-08-20 22:41:17.413 INFO: Head 'Default' training dataset size: 1612
2025-08-20 22:41:17.413 INFO: Processing datasets for head 'pt_head'
2025-08-20 22:41:25.695 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz']
2025-08-20 22:41:25.696 INFO: Combining 1 list datasets for head 'pt_head'
2025-08-20 22:41:26.606 INFO: Head 'pt_head' training dataset size: 9000
2025-08-20 22:41:26.606 INFO: Average number of neighbors: 61.964672446250916
2025-08-20 22:41:26.606 INFO: During training the following quantities will be reported: energy, forces, stress
2025-08-20 22:41:26.606 INFO: ===========MODEL DETAILS===========
2025-08-20 22:41:33.711 INFO: Loading FOUNDATION model
2025-08-20 22:41:33.712 INFO: Using filtered elements: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-20 22:41:33.713 INFO: Model configuration extracted from foundation model
2025-08-20 22:41:33.713 INFO: Using universal loss function for fine-tuning
2025-08-20 22:41:33.713 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-20 22:41:33.713 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-20 22:41:33.713 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-20 22:41:33.713 INFO: Distance transform for radial basis functions: None
2025-08-20 22:41:35.248 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(86x0e -> 128x0e | 11008 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.6672, -3.4821, -4.7367, -7.7249, -8.4056, -7.3601, -7.2846, -4.8965, -2.7594, -2.8140, -4.8469, -7.6948, -6.9633, -4.6726, -2.8117, -2.6176, -5.3905, -7.8858, -10.2684, -8.6651, -9.2331, -8.3050, -7.0490, -5.5774, -5.1727, -3.2521, -1.2902, -3.5271, -4.7085, -3.9765, -3.8862, -2.5185, 6.7669, -2.5635, -4.9380, -10.1498, -11.8469, -12.1389, -8.7917, -8.7869, -7.7809, -6.8500, -4.8910, -2.0634, -0.6396, -2.7887, -3.8186, -3.5871, -2.8804, -1.6356, 9.8467, -2.7653, -4.9910, -8.9337, -8.7356, -8.0190, -8.2515, -7.5917, -8.1697, -13.5927, -18.5175, -7.6474, -8.1230, -7.6078, -6.8503, -7.8269, -3.5848, -7.4554, -12.7963, -14.1081, -9.3549, -11.3875, -9.6219, -7.3244, -5.3047, -2.3801, 0.2495, -2.3240, -3.7300, -3.4388, -5.0629, -11.0246, -12.2656, -13.8556, -14.9331, -15.2828], [0.0000, -1.2303, 0.0000, 0.0000, 0.0000, 0.0000, -23.0491, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 23.3676, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 15.1929, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 86x0e -> 128x0e+128x1o+128x2e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 86x0e -> 128x0e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-08-20 22:41:35.251 INFO: Total number of parameters: 5556810
2025-08-20 22:41:35.251 INFO: 
2025-08-20 22:41:35.251 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-20 22:41:35.251 INFO: Using ADAM as parameter optimizer
2025-08-20 22:41:35.251 INFO: Batch size: 2
2025-08-20 22:41:35.251 INFO: Using Exponential Moving Average with decay: 0.99999
2025-08-20 22:41:35.251 INFO: Number of gradient updates: 689780
2025-08-20 22:41:35.251 INFO: Learning rate: 0.0001, weight decay: 1e-08
2025-08-20 22:41:35.251 INFO: UniversalLoss(energy_weight=10.000, forces_weight=0.000, stress_weight=0.000)
2025-08-20 22:41:35.285 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-08-20 22:41:35.286 INFO: Loading checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-17.pt
2025-08-20 22:41:38.952 INFO: Using gradient clipping with tolerance=3.000
2025-08-20 22:41:38.952 INFO: 
2025-08-20 22:41:38.952 INFO: ===========TRAINING===========
2025-08-20 22:41:38.952 INFO: Started training, reporting errors on validation set
2025-08-20 22:41:38.952 INFO: Loss metrics on validation set
2025-08-20 22:42:25.336 INFO: Initial: head: pt_head, loss=0.00235407, RMSE_E_per_atom=   67.43 meV, RMSE_F=  321.69 meV / A, RMSE_stress=   11.00 meV / A^3
2025-08-20 22:44:01.512 INFO: Initial: head: Default, loss=0.00038677, RMSE_E_per_atom=    9.73 meV, RMSE_F= 1308.31 meV / A, RMSE_stress=None meV / A^3
2025-08-20 22:58:29.019 INFO: Epoch 17: head: pt_head, loss=0.00237193, RMSE_E_per_atom=   69.51 meV, RMSE_F=  325.06 meV / A, RMSE_stress=   10.96 meV / A^3
2025-08-20 23:00:05.509 INFO: Epoch 17: head: Default, loss=0.00036341, RMSE_E_per_atom=    9.39 meV, RMSE_F= 1320.63 meV / A, RMSE_stress=None meV / A^3
2025-08-20 23:00:05.512 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-17.pt
2025-08-20 23:14:31.363 INFO: Epoch 18: head: pt_head, loss=0.00238003, RMSE_E_per_atom=   68.53 meV, RMSE_F=  333.97 meV / A, RMSE_stress=   10.92 meV / A^3
2025-08-20 23:16:07.476 INFO: Epoch 18: head: Default, loss=0.00035276, RMSE_E_per_atom=    9.24 meV, RMSE_F= 1323.78 meV / A, RMSE_stress=None meV / A^3
2025-08-20 23:16:07.479 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-17.pt
2025-08-20 23:16:07.573 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-18.pt
2025-08-20 23:30:31.969 INFO: Epoch 19: head: pt_head, loss=0.00236551, RMSE_E_per_atom=   69.85 meV, RMSE_F=  331.32 meV / A, RMSE_stress=   10.90 meV / A^3
2025-08-20 23:32:08.298 INFO: Epoch 19: head: Default, loss=0.00033762, RMSE_E_per_atom=    9.00 meV, RMSE_F= 1316.76 meV / A, RMSE_stress=None meV / A^3
2025-08-20 23:32:08.301 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-18.pt
2025-08-20 23:32:08.358 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-19.pt
2025-08-20 23:46:33.071 INFO: Epoch 20: head: pt_head, loss=0.00236554, RMSE_E_per_atom=   68.93 meV, RMSE_F=  329.75 meV / A, RMSE_stress=   10.86 meV / A^3
2025-08-20 23:48:09.563 INFO: Epoch 20: head: Default, loss=0.00032636, RMSE_E_per_atom=    8.81 meV, RMSE_F= 1316.73 meV / A, RMSE_stress=None meV / A^3
2025-08-20 23:48:09.566 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-19.pt
2025-08-20 23:48:09.687 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-20.pt
2025-08-21 00:02:34.338 INFO: Epoch 21: head: pt_head, loss=0.00237581, RMSE_E_per_atom=   71.24 meV, RMSE_F=  336.04 meV / A, RMSE_stress=   10.94 meV / A^3
2025-08-21 00:04:10.397 INFO: Epoch 21: head: Default, loss=0.00031584, RMSE_E_per_atom=    8.64 meV, RMSE_F= 1329.79 meV / A, RMSE_stress=None meV / A^3
2025-08-21 00:04:10.400 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-20.pt
2025-08-21 00:04:10.498 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-21.pt
2025-08-21 00:18:39.325 INFO: Epoch 22: head: pt_head, loss=0.00236368, RMSE_E_per_atom=   68.30 meV, RMSE_F=  337.51 meV / A, RMSE_stress=   10.89 meV / A^3
2025-08-21 00:20:15.866 INFO: Epoch 22: head: Default, loss=0.00031060, RMSE_E_per_atom=    8.57 meV, RMSE_F= 1325.04 meV / A, RMSE_stress=None meV / A^3
2025-08-21 00:20:15.868 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-21.pt
2025-08-21 00:20:15.940 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-22.pt
2025-08-21 00:34:42.317 INFO: Epoch 23: head: pt_head, loss=0.00237370, RMSE_E_per_atom=   68.58 meV, RMSE_F=  340.03 meV / A, RMSE_stress=   10.87 meV / A^3
2025-08-21 00:36:18.877 INFO: Epoch 23: head: Default, loss=0.00030391, RMSE_E_per_atom=    8.47 meV, RMSE_F= 1326.45 meV / A, RMSE_stress=None meV / A^3
2025-08-21 00:36:18.880 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-22.pt
2025-08-21 00:36:19.008 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-23.pt
2025-08-21 00:50:44.815 INFO: Epoch 24: head: pt_head, loss=0.00237861, RMSE_E_per_atom=   70.06 meV, RMSE_F=  342.96 meV / A, RMSE_stress=   10.96 meV / A^3
2025-08-21 00:52:21.316 INFO: Epoch 24: head: Default, loss=0.00029316, RMSE_E_per_atom=    8.30 meV, RMSE_F= 1328.72 meV / A, RMSE_stress=None meV / A^3
2025-08-21 00:52:21.319 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-23.pt
2025-08-21 00:52:21.438 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-24.pt
2025-08-21 01:06:47.525 INFO: Epoch 25: head: pt_head, loss=0.00238010, RMSE_E_per_atom=   71.05 meV, RMSE_F=  342.27 meV / A, RMSE_stress=   10.89 meV / A^3
2025-08-21 01:08:23.902 INFO: Epoch 25: head: Default, loss=0.00028968, RMSE_E_per_atom=    8.24 meV, RMSE_F= 1327.13 meV / A, RMSE_stress=None meV / A^3
2025-08-21 01:08:23.905 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-24.pt
2025-08-21 01:08:24.004 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-25.pt
2025-08-21 01:22:50.672 INFO: Epoch 26: head: pt_head, loss=0.00238221, RMSE_E_per_atom=   71.58 meV, RMSE_F=  344.18 meV / A, RMSE_stress=   10.94 meV / A^3
2025-08-21 01:24:27.133 INFO: Epoch 26: head: Default, loss=0.00028328, RMSE_E_per_atom=    8.13 meV, RMSE_F= 1323.56 meV / A, RMSE_stress=None meV / A^3
2025-08-21 01:24:27.136 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-25.pt
2025-08-21 01:24:27.239 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-26.pt
2025-08-21 01:38:52.531 INFO: Epoch 27: head: pt_head, loss=0.00239002, RMSE_E_per_atom=   71.50 meV, RMSE_F=  344.00 meV / A, RMSE_stress=   10.90 meV / A^3
2025-08-21 01:40:28.493 INFO: Epoch 27: head: Default, loss=0.00027826, RMSE_E_per_atom=    8.05 meV, RMSE_F= 1319.38 meV / A, RMSE_stress=None meV / A^3
2025-08-21 01:40:28.497 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-26.pt
2025-08-21 01:40:28.567 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-27.pt
2025-08-21 01:54:54.318 INFO: Epoch 28: head: pt_head, loss=0.00240356, RMSE_E_per_atom=   73.33 meV, RMSE_F=  346.51 meV / A, RMSE_stress=   10.99 meV / A^3
2025-08-21 01:56:30.804 INFO: Epoch 28: head: Default, loss=0.00027267, RMSE_E_per_atom=    7.95 meV, RMSE_F= 1316.93 meV / A, RMSE_stress=None meV / A^3
2025-08-21 01:56:30.807 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-27.pt
2025-08-21 01:56:30.918 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-28.pt
2025-08-21 02:10:56.423 INFO: Epoch 29: head: pt_head, loss=0.00240190, RMSE_E_per_atom=   73.54 meV, RMSE_F=  348.66 meV / A, RMSE_stress=   10.95 meV / A^3
2025-08-21 02:12:32.913 INFO: Epoch 29: head: Default, loss=0.00026776, RMSE_E_per_atom=    7.86 meV, RMSE_F= 1311.50 meV / A, RMSE_stress=None meV / A^3
2025-08-21 02:12:32.916 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-28.pt
2025-08-21 02:12:33.005 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-29.pt
2025-08-21 02:26:59.850 INFO: Epoch 30: head: pt_head, loss=0.00239766, RMSE_E_per_atom=   72.33 meV, RMSE_F=  349.47 meV / A, RMSE_stress=   10.94 meV / A^3
2025-08-21 02:28:35.990 INFO: Epoch 30: head: Default, loss=0.00026205, RMSE_E_per_atom=    7.77 meV, RMSE_F= 1310.55 meV / A, RMSE_stress=None meV / A^3
2025-08-21 02:28:35.993 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-29.pt
2025-08-21 02:28:36.101 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-30.pt
2025-08-21 02:43:02.118 INFO: Epoch 31: head: pt_head, loss=0.00239505, RMSE_E_per_atom=   71.45 meV, RMSE_F=  351.16 meV / A, RMSE_stress=   10.92 meV / A^3
2025-08-21 02:44:38.623 INFO: Epoch 31: head: Default, loss=0.00025834, RMSE_E_per_atom=    7.71 meV, RMSE_F= 1307.14 meV / A, RMSE_stress=None meV / A^3
2025-08-21 02:44:38.626 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-30.pt
2025-08-21 02:44:38.725 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-31.pt
2025-08-21 02:59:03.568 INFO: Epoch 32: head: pt_head, loss=0.00239808, RMSE_E_per_atom=   72.02 meV, RMSE_F=  354.13 meV / A, RMSE_stress=   10.98 meV / A^3
2025-08-21 03:00:40.075 INFO: Epoch 32: head: Default, loss=0.00025419, RMSE_E_per_atom=    7.64 meV, RMSE_F= 1303.16 meV / A, RMSE_stress=None meV / A^3
2025-08-21 03:00:40.077 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-31.pt
2025-08-21 03:00:40.195 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-32.pt
2025-08-21 03:15:06.100 INFO: Epoch 33: head: pt_head, loss=0.00239442, RMSE_E_per_atom=   72.20 meV, RMSE_F=  356.92 meV / A, RMSE_stress=   11.02 meV / A^3
2025-08-21 03:16:42.079 INFO: Epoch 33: head: Default, loss=0.00024937, RMSE_E_per_atom=    7.55 meV, RMSE_F= 1301.57 meV / A, RMSE_stress=None meV / A^3
2025-08-21 03:16:42.082 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-32.pt
2025-08-21 03:16:42.252 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-33.pt
2025-08-21 03:31:07.363 INFO: Epoch 34: head: pt_head, loss=0.00239382, RMSE_E_per_atom=   72.63 meV, RMSE_F=  358.95 meV / A, RMSE_stress=   11.04 meV / A^3
2025-08-21 03:32:43.773 INFO: Epoch 34: head: Default, loss=0.00024646, RMSE_E_per_atom=    7.50 meV, RMSE_F= 1299.41 meV / A, RMSE_stress=None meV / A^3
2025-08-21 03:32:43.776 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-33.pt
2025-08-21 03:32:43.852 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-34.pt
2025-08-21 03:47:08.984 INFO: Epoch 35: head: pt_head, loss=0.00239456, RMSE_E_per_atom=   72.96 meV, RMSE_F=  361.04 meV / A, RMSE_stress=   11.08 meV / A^3
2025-08-21 03:48:45.270 INFO: Epoch 35: head: Default, loss=0.00024226, RMSE_E_per_atom=    7.43 meV, RMSE_F= 1298.27 meV / A, RMSE_stress=None meV / A^3
2025-08-21 03:48:45.273 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-34.pt
2025-08-21 03:48:45.362 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-35.pt
2025-08-21 04:03:10.421 INFO: Epoch 36: head: pt_head, loss=0.00239280, RMSE_E_per_atom=   72.67 meV, RMSE_F=  360.46 meV / A, RMSE_stress=   11.04 meV / A^3
2025-08-21 04:04:46.388 INFO: Epoch 36: head: Default, loss=0.00023766, RMSE_E_per_atom=    7.34 meV, RMSE_F= 1296.02 meV / A, RMSE_stress=None meV / A^3
2025-08-21 04:04:46.391 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-35.pt
2025-08-21 04:04:46.480 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-36.pt
2025-08-21 04:19:11.741 INFO: Epoch 37: head: pt_head, loss=0.00239619, RMSE_E_per_atom=   73.42 meV, RMSE_F=  361.71 meV / A, RMSE_stress=   11.05 meV / A^3
2025-08-21 04:20:48.239 INFO: Epoch 37: head: Default, loss=0.00023382, RMSE_E_per_atom=    7.27 meV, RMSE_F= 1295.90 meV / A, RMSE_stress=None meV / A^3
2025-08-21 04:20:48.241 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-36.pt
2025-08-21 04:20:48.369 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-37.pt
2025-08-21 04:35:13.804 INFO: Epoch 38: head: pt_head, loss=0.00240749, RMSE_E_per_atom=   74.01 meV, RMSE_F=  362.07 meV / A, RMSE_stress=   11.07 meV / A^3
2025-08-21 04:36:50.119 INFO: Epoch 38: head: Default, loss=0.00022973, RMSE_E_per_atom=    7.20 meV, RMSE_F= 1290.70 meV / A, RMSE_stress=None meV / A^3
2025-08-21 04:36:50.122 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-37.pt
2025-08-21 04:36:50.234 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-38.pt
2025-08-21 04:51:15.523 INFO: Epoch 39: head: pt_head, loss=0.00240331, RMSE_E_per_atom=   73.28 meV, RMSE_F=  363.87 meV / A, RMSE_stress=   11.05 meV / A^3
2025-08-21 04:52:51.465 INFO: Epoch 39: head: Default, loss=0.00022583, RMSE_E_per_atom=    7.13 meV, RMSE_F= 1288.00 meV / A, RMSE_stress=None meV / A^3
2025-08-21 04:52:51.468 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-38.pt
2025-08-21 04:52:51.556 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-39.pt
2025-08-21 05:07:16.795 INFO: Epoch 40: head: pt_head, loss=0.00240458, RMSE_E_per_atom=   73.33 meV, RMSE_F=  367.17 meV / A, RMSE_stress=   11.10 meV / A^3
2025-08-21 05:08:53.081 INFO: Epoch 40: head: Default, loss=0.00022286, RMSE_E_per_atom=    7.08 meV, RMSE_F= 1285.82 meV / A, RMSE_stress=None meV / A^3
2025-08-21 05:08:53.084 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-39.pt
2025-08-21 05:08:53.209 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-40.pt
2025-08-21 05:23:17.815 INFO: Epoch 41: head: pt_head, loss=0.00241151, RMSE_E_per_atom=   73.84 meV, RMSE_F=  369.13 meV / A, RMSE_stress=   11.13 meV / A^3
2025-08-21 05:24:54.178 INFO: Epoch 41: head: Default, loss=0.00022004, RMSE_E_per_atom=    7.02 meV, RMSE_F= 1284.61 meV / A, RMSE_stress=None meV / A^3
2025-08-21 05:24:54.181 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-40.pt
2025-08-21 05:24:54.321 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-41.pt
2025-08-21 05:39:21.011 INFO: Epoch 42: head: pt_head, loss=0.00241262, RMSE_E_per_atom=   73.73 meV, RMSE_F=  368.69 meV / A, RMSE_stress=   11.11 meV / A^3
2025-08-21 05:40:57.121 INFO: Epoch 42: head: Default, loss=0.00021716, RMSE_E_per_atom=    6.97 meV, RMSE_F= 1283.85 meV / A, RMSE_stress=None meV / A^3
2025-08-21 05:40:57.124 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-41.pt
2025-08-21 05:40:57.278 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-42.pt
2025-08-21 05:55:22.961 INFO: Epoch 43: head: pt_head, loss=0.00241010, RMSE_E_per_atom=   73.14 meV, RMSE_F=  369.30 meV / A, RMSE_stress=   11.08 meV / A^3
2025-08-21 05:56:59.396 INFO: Epoch 43: head: Default, loss=0.00021397, RMSE_E_per_atom=    6.91 meV, RMSE_F= 1283.58 meV / A, RMSE_stress=None meV / A^3
2025-08-21 05:56:59.400 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-42.pt
2025-08-21 05:56:59.593 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-43.pt
2025-08-21 06:11:26.078 INFO: Epoch 44: head: pt_head, loss=0.00241562, RMSE_E_per_atom=   73.26 meV, RMSE_F=  369.96 meV / A, RMSE_stress=   11.11 meV / A^3
2025-08-21 06:13:02.503 INFO: Epoch 44: head: Default, loss=0.00021074, RMSE_E_per_atom=    6.85 meV, RMSE_F= 1280.76 meV / A, RMSE_stress=None meV / A^3
2025-08-21 06:13:02.506 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-43.pt
2025-08-21 06:13:02.573 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-44.pt
2025-08-21 06:27:29.370 INFO: Epoch 45: head: pt_head, loss=0.00241960, RMSE_E_per_atom=   73.18 meV, RMSE_F=  371.41 meV / A, RMSE_stress=   11.16 meV / A^3
2025-08-21 06:29:05.487 INFO: Epoch 45: head: Default, loss=0.00020887, RMSE_E_per_atom=    6.81 meV, RMSE_F= 1277.20 meV / A, RMSE_stress=None meV / A^3
2025-08-21 06:29:05.490 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-44.pt
2025-08-21 06:29:05.589 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-45.pt
2025-08-21 06:43:32.318 INFO: Epoch 46: head: pt_head, loss=0.00242310, RMSE_E_per_atom=   73.42 meV, RMSE_F=  370.44 meV / A, RMSE_stress=   11.17 meV / A^3
2025-08-21 06:45:08.865 INFO: Epoch 46: head: Default, loss=0.00020689, RMSE_E_per_atom=    6.78 meV, RMSE_F= 1273.08 meV / A, RMSE_stress=None meV / A^3
2025-08-21 06:45:08.868 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-45.pt
2025-08-21 06:45:08.980 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-46.pt
2025-08-21 06:59:35.858 INFO: Epoch 47: head: pt_head, loss=0.00242182, RMSE_E_per_atom=   73.23 meV, RMSE_F=  370.39 meV / A, RMSE_stress=   11.17 meV / A^3
2025-08-21 07:01:12.391 INFO: Epoch 47: head: Default, loss=0.00020458, RMSE_E_per_atom=    6.73 meV, RMSE_F= 1270.57 meV / A, RMSE_stress=None meV / A^3
2025-08-21 07:01:12.394 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-46.pt
2025-08-21 07:01:12.492 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-47.pt
2025-08-21 07:15:37.780 INFO: Epoch 48: head: pt_head, loss=0.00241715, RMSE_E_per_atom=   72.86 meV, RMSE_F=  371.13 meV / A, RMSE_stress=   11.18 meV / A^3
2025-08-21 07:17:13.852 INFO: Epoch 48: head: Default, loss=0.00020241, RMSE_E_per_atom=    6.69 meV, RMSE_F= 1269.08 meV / A, RMSE_stress=None meV / A^3
2025-08-21 07:17:13.855 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-47.pt
2025-08-21 07:17:13.973 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-48.pt
2025-08-21 07:31:38.620 INFO: Epoch 49: head: pt_head, loss=0.00241461, RMSE_E_per_atom=   72.24 meV, RMSE_F=  370.89 meV / A, RMSE_stress=   11.16 meV / A^3
2025-08-21 07:33:14.977 INFO: Epoch 49: head: Default, loss=0.00020057, RMSE_E_per_atom=    6.66 meV, RMSE_F= 1265.95 meV / A, RMSE_stress=None meV / A^3
2025-08-21 07:33:14.980 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-48.pt
2025-08-21 07:33:15.045 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-49.pt
2025-08-21 07:47:40.955 INFO: Epoch 50: head: pt_head, loss=0.00241704, RMSE_E_per_atom=   72.11 meV, RMSE_F=  371.56 meV / A, RMSE_stress=   11.18 meV / A^3
2025-08-21 07:49:17.309 INFO: Epoch 50: head: Default, loss=0.00019833, RMSE_E_per_atom=    6.61 meV, RMSE_F= 1262.68 meV / A, RMSE_stress=None meV / A^3
2025-08-21 07:49:17.311 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-49.pt
2025-08-21 07:49:17.388 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-50.pt
2025-08-21 08:03:44.257 INFO: Epoch 51: head: pt_head, loss=0.00241766, RMSE_E_per_atom=   72.47 meV, RMSE_F=  372.06 meV / A, RMSE_stress=   11.19 meV / A^3
2025-08-21 08:05:20.345 INFO: Epoch 51: head: Default, loss=0.00019595, RMSE_E_per_atom=    6.57 meV, RMSE_F= 1259.37 meV / A, RMSE_stress=None meV / A^3
2025-08-21 08:05:20.348 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-50.pt
2025-08-21 08:05:20.546 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-51.pt
2025-08-21 08:19:46.758 INFO: Epoch 52: head: pt_head, loss=0.00241849, RMSE_E_per_atom=   72.52 meV, RMSE_F=  372.13 meV / A, RMSE_stress=   11.18 meV / A^3
2025-08-21 08:21:23.125 INFO: Epoch 52: head: Default, loss=0.00019407, RMSE_E_per_atom=    6.53 meV, RMSE_F= 1255.30 meV / A, RMSE_stress=None meV / A^3
2025-08-21 08:21:23.128 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-51.pt
2025-08-21 08:21:23.201 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-52.pt
2025-08-21 08:35:48.850 INFO: Epoch 53: head: pt_head, loss=0.00241864, RMSE_E_per_atom=   72.71 meV, RMSE_F=  372.42 meV / A, RMSE_stress=   11.20 meV / A^3
2025-08-21 08:37:25.310 INFO: Epoch 53: head: Default, loss=0.00019218, RMSE_E_per_atom=    6.49 meV, RMSE_F= 1250.27 meV / A, RMSE_stress=None meV / A^3
2025-08-21 08:37:25.312 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-52.pt
2025-08-21 08:37:25.383 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-53.pt
2025-08-21 08:51:50.625 INFO: Epoch 54: head: pt_head, loss=0.00242019, RMSE_E_per_atom=   72.89 meV, RMSE_F=  373.10 meV / A, RMSE_stress=   11.20 meV / A^3
2025-08-21 08:53:26.623 INFO: Epoch 54: head: Default, loss=0.00018995, RMSE_E_per_atom=    6.45 meV, RMSE_F= 1247.07 meV / A, RMSE_stress=None meV / A^3
2025-08-21 08:53:26.626 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-53.pt
2025-08-21 08:53:26.701 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-54.pt
2025-08-21 09:07:52.940 INFO: Epoch 55: head: pt_head, loss=0.00242008, RMSE_E_per_atom=   72.78 meV, RMSE_F=  374.28 meV / A, RMSE_stress=   11.23 meV / A^3
2025-08-21 09:09:29.322 INFO: Epoch 55: head: Default, loss=0.00018769, RMSE_E_per_atom=    6.41 meV, RMSE_F= 1242.99 meV / A, RMSE_stress=None meV / A^3
2025-08-21 09:09:29.325 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-54.pt
2025-08-21 09:09:29.431 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-55.pt
2025-08-21 09:23:55.532 INFO: Epoch 56: head: pt_head, loss=0.00241982, RMSE_E_per_atom=   72.63 meV, RMSE_F=  374.71 meV / A, RMSE_stress=   11.21 meV / A^3
2025-08-21 09:25:31.850 INFO: Epoch 56: head: Default, loss=0.00018547, RMSE_E_per_atom=    6.36 meV, RMSE_F= 1240.13 meV / A, RMSE_stress=None meV / A^3
2025-08-21 09:25:31.853 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-55.pt
2025-08-21 09:25:31.903 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-56.pt
2025-08-21 09:39:57.517 INFO: Epoch 57: head: pt_head, loss=0.00242089, RMSE_E_per_atom=   72.35 meV, RMSE_F=  374.54 meV / A, RMSE_stress=   11.21 meV / A^3
2025-08-21 09:41:33.535 INFO: Epoch 57: head: Default, loss=0.00018362, RMSE_E_per_atom=    6.33 meV, RMSE_F= 1237.64 meV / A, RMSE_stress=None meV / A^3
2025-08-21 09:41:33.538 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-56.pt
2025-08-21 09:41:33.638 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-57.pt
2025-08-21 09:55:59.713 INFO: Epoch 58: head: pt_head, loss=0.00242513, RMSE_E_per_atom=   72.60 meV, RMSE_F=  376.09 meV / A, RMSE_stress=   11.24 meV / A^3
2025-08-21 09:57:36.043 INFO: Epoch 58: head: Default, loss=0.00018214, RMSE_E_per_atom=    6.30 meV, RMSE_F= 1234.59 meV / A, RMSE_stress=None meV / A^3
2025-08-21 09:57:36.045 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-57.pt
2025-08-21 09:57:36.133 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-58.pt
2025-08-21 10:12:02.905 INFO: Epoch 59: head: pt_head, loss=0.00242972, RMSE_E_per_atom=   73.24 meV, RMSE_F=  376.71 meV / A, RMSE_stress=   11.25 meV / A^3
2025-08-21 10:13:39.635 INFO: Epoch 59: head: Default, loss=0.00018089, RMSE_E_per_atom=    6.27 meV, RMSE_F= 1231.00 meV / A, RMSE_stress=None meV / A^3
2025-08-21 10:13:39.638 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-58.pt
2025-08-21 10:13:39.717 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-59.pt
2025-08-21 10:16:49.590 INFO: ===========VERIFYING SETTINGS===========
2025-08-21 10:16:49.591 INFO: MACE version: 0.3.14
2025-08-21 10:16:49.591 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f4c23b8ec00>, compute_atomic_dipole=<function str2bool at 0x7f4c23b8ec00>, train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.006, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-21 10:16:50.231 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-21 10:16:50.339 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3, stdin=None, shell=False, universal_newlines=False)
2025-08-21 10:16:50.343 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3, stdin=None, shell=False, universal_newlines=False)
2025-08-21 10:16:50.353 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-21 10:16:50.363 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-21 10:16:50.719 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-21 10:16:50.721 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-21 10:16:50.721 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-21 10:16:50.721 INFO: ===========LOADING INPUT DATA===========
2025-08-21 10:16:50.721 INFO: Using heads: ['Default', 'pt_head']
2025-08-21 10:16:50.721 INFO: Using the key specifications to parse data:
2025-08-21 10:16:50.721 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 10:16:50.721 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 10:16:50.721 INFO: =============    Processing head Default     ===========
2025-08-21 10:16:50.723 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz
2025-08-21 10:16:56.090 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-21 10:16:56.094 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1612, charges: 0]
2025-08-21 10:16:58.401 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-21 10:16:58.403 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 705, charges: 0]
2025-08-21 10:16:58.403 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-08-21 10:16:58.403 INFO: =============    Processing head pt_head     ===========
2025-08-21 10:16:58.404 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz
2025-08-21 10:17:01.415 INFO: Training set 1/1 [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-21 10:17:01.443 INFO: Total Training set [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-21 10:17:01.443 INFO: No validation set provided, splitting training data instead.
2025-08-21 10:17:01.447 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_84.txt
2025-08-21 10:17:01.477 INFO: Random Split Training set [energy: 9000, stress: 9000, virials: 0, dipole components: 0, head: 9000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 9000, charges: 0]
2025-08-21 10:17:01.480 INFO: Random Split Validation set [energy: 1000, stress: 1000, virials: 0, dipole components: 0, head: 1000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 1000, charges: 0]
2025-08-21 10:17:01.480 INFO: Total number of configurations: train=9000, valid=1000, tests=[],
2025-08-21 10:17:01.481 INFO: ==================Using multiheads finetuning mode==================
2025-08-21 10:17:01.481 INFO: Total number of configurations in pretraining: train=9000, valid=1000
2025-08-21 10:17:01.481 INFO: Using atomic numbers from command line argument
2025-08-21 10:17:01.506 INFO: Atomic Numbers used: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-21 10:17:01.506 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-21 10:17:01.510 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-08-21 10:17:01.510 INFO: Atomic Energies used (z: eV) for head pt_head: {1: -3.667168021358939, 3: -3.482100566595956, 4: -4.736697230897597, 5: -7.724935420523256, 6: -8.405573550273285, 7: -7.360100452662763, 8: -7.28459863421322, 9: -4.896490881731322, 11: -2.7593613569762425, 12: -2.814047612069227, 13: -4.846881245288104, 14: -7.694793133351899, 15: -6.9632957911820235, 16: -4.672630400190884, 17: -2.8116892814008096, 19: -2.6176454856894793, 20: -5.390461060484104, 21: -7.8857952163517675, 22: -10.268392986214433, 23: -8.665147785496703, 24: -9.233050763772013, 25: -8.304951520770791, 26: -7.0489865771593765, 27: -5.577439766222147, 28: -5.172747618813715, 29: -3.2520726958619472, 30: -1.2901611618726314, 31: -3.527082192997912, 32: -4.70845955030298, 33: -3.9765109025623238, 34: -3.886231055836541, 35: -2.5184940099633986, 36: 6.766947645687137, 37: -2.5634958965928316, 38: -4.938005211501922, 39: -10.149818838085771, 40: -11.846857579882572, 41: -12.138896361658485, 42: -8.791678800595722, 43: -8.78694939675911, 44: -7.78093221529871, 45: -6.850021409115055, 46: -4.891019073240479, 47: -2.0634296773864045, 48: -0.6395695518943755, 49: -2.7887442084286693, 50: -3.818604275441892, 51: -3.587068329278862, 52: -2.8804045971118897, 53: -1.6355986842433357, 54: 9.846723842807721, 55: -2.765284507132287, 56: -4.990956432167774, 57: -8.933684809576345, 58: -8.735591176647514, 59: -8.018966025544966, 60: -8.251491970213372, 61: -7.591719594359237, 62: -8.169659881166858, 63: -13.592664636171698, 64: -18.517523458456985, 65: -7.647396572993602, 66: -8.122981037851925, 67: -7.607787319678067, 68: -6.85029094445494, 69: -7.8268821327130365, 70: -3.584786591677161, 71: -7.455406192077973, 72: -12.796283502572146, 73: -14.108127281277586, 74: -9.354916969477486, 75: -11.387537567890853, 76: -9.621909492152557, 77: -7.324393429417677, 78: -5.3046964808341945, 79: -2.380092582080244, 80: 0.24948924158195362, 81: -2.3239789120665026, 82: -3.730042357127322, 83: -3.438792347649683, 89: -5.062878214511315, 90: -11.02462566385297, 91: -12.265613551943261, 92: -13.855648206100362, 93: -14.933092020258243, 94: -15.282826131998245}
2025-08-21 10:17:01.510 INFO: Processing datasets for head 'Default'
2025-08-21 10:17:21.318 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz']
2025-08-21 10:17:21.318 INFO: Combining 1 list datasets for head 'Default'
2025-08-21 10:17:30.253 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-08-21 10:17:30.254 INFO: Combining 1 list datasets for head 'Default_valid'
2025-08-21 10:17:30.254 INFO: Combined validation datasets for Default
2025-08-21 10:17:30.254 INFO: Head 'Default' training dataset size: 1612
2025-08-21 10:17:30.254 INFO: Processing datasets for head 'pt_head'
2025-08-21 10:17:38.565 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz']
2025-08-21 10:17:38.565 INFO: Combining 1 list datasets for head 'pt_head'
2025-08-21 10:17:39.480 INFO: Head 'pt_head' training dataset size: 9000
2025-08-21 10:17:39.480 INFO: Average number of neighbors: 61.964672446250916
2025-08-21 10:17:39.480 INFO: During training the following quantities will be reported: energy, forces, stress
2025-08-21 10:17:39.480 INFO: ===========MODEL DETAILS===========
2025-08-21 10:17:46.266 INFO: Loading FOUNDATION model
2025-08-21 10:17:46.267 INFO: Using filtered elements: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-21 10:17:46.268 INFO: Model configuration extracted from foundation model
2025-08-21 10:17:46.268 INFO: Using universal loss function for fine-tuning
2025-08-21 10:17:46.268 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-21 10:17:46.268 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-21 10:17:46.268 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-21 10:17:46.268 INFO: Distance transform for radial basis functions: None
2025-08-21 10:17:47.711 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(86x0e -> 128x0e | 11008 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.6672, -3.4821, -4.7367, -7.7249, -8.4056, -7.3601, -7.2846, -4.8965, -2.7594, -2.8140, -4.8469, -7.6948, -6.9633, -4.6726, -2.8117, -2.6176, -5.3905, -7.8858, -10.2684, -8.6651, -9.2331, -8.3050, -7.0490, -5.5774, -5.1727, -3.2521, -1.2902, -3.5271, -4.7085, -3.9765, -3.8862, -2.5185, 6.7669, -2.5635, -4.9380, -10.1498, -11.8469, -12.1389, -8.7917, -8.7869, -7.7809, -6.8500, -4.8910, -2.0634, -0.6396, -2.7887, -3.8186, -3.5871, -2.8804, -1.6356, 9.8467, -2.7653, -4.9910, -8.9337, -8.7356, -8.0190, -8.2515, -7.5917, -8.1697, -13.5927, -18.5175, -7.6474, -8.1230, -7.6078, -6.8503, -7.8269, -3.5848, -7.4554, -12.7963, -14.1081, -9.3549, -11.3875, -9.6219, -7.3244, -5.3047, -2.3801, 0.2495, -2.3240, -3.7300, -3.4388, -5.0629, -11.0246, -12.2656, -13.8556, -14.9331, -15.2828], [0.0000, -1.2303, 0.0000, 0.0000, 0.0000, 0.0000, -23.0491, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 23.3676, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 15.1929, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 86x0e -> 128x0e+128x1o+128x2e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 86x0e -> 128x0e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-08-21 10:17:47.714 INFO: Total number of parameters: 5556810
2025-08-21 10:17:47.714 INFO: 
2025-08-21 10:17:47.714 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-21 10:17:47.714 INFO: Using ADAM as parameter optimizer
2025-08-21 10:17:47.714 INFO: Batch size: 2
2025-08-21 10:17:47.714 INFO: Using Exponential Moving Average with decay: 0.99999
2025-08-21 10:17:47.714 INFO: Number of gradient updates: 689780
2025-08-21 10:17:47.714 INFO: Learning rate: 0.0001, weight decay: 1e-08
2025-08-21 10:17:47.714 INFO: UniversalLoss(energy_weight=10.000, forces_weight=0.000, stress_weight=0.000)
2025-08-21 10:17:47.725 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-08-21 10:17:47.726 INFO: Loading checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-59.pt
2025-08-21 10:17:47.817 INFO: Using gradient clipping with tolerance=1.000
2025-08-21 10:17:47.817 INFO: 
2025-08-21 10:17:47.817 INFO: ===========TRAINING===========
2025-08-21 10:17:47.817 INFO: Started training, reporting errors on validation set
2025-08-21 10:17:47.817 INFO: Loss metrics on validation set
2025-08-21 10:18:34.149 INFO: Initial: head: pt_head, loss=0.00242972, RMSE_E_per_atom=   73.24 meV, RMSE_F=  376.71 meV / A, RMSE_stress=   11.25 meV / A^3
2025-08-21 10:20:10.179 INFO: Initial: head: Default, loss=0.00018089, RMSE_E_per_atom=    6.27 meV, RMSE_F= 1231.00 meV / A, RMSE_stress=None meV / A^3
2025-08-21 10:34:38.633 INFO: Epoch 59: head: pt_head, loss=0.00244970, RMSE_E_per_atom=   71.46 meV, RMSE_F=  380.36 meV / A, RMSE_stress=   11.20 meV / A^3
2025-08-21 10:36:14.907 INFO: Epoch 59: head: Default, loss=0.00018106, RMSE_E_per_atom=    6.27 meV, RMSE_F= 1225.88 meV / A, RMSE_stress=None meV / A^3
2025-08-21 10:36:14.909 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-59.pt
2025-08-21 10:50:41.169 INFO: Epoch 60: head: pt_head, loss=0.00241963, RMSE_E_per_atom=   72.33 meV, RMSE_F=  376.50 meV / A, RMSE_stress=   11.14 meV / A^3
2025-08-21 10:52:17.254 INFO: Epoch 60: head: Default, loss=0.00017753, RMSE_E_per_atom=    6.21 meV, RMSE_F= 1231.71 meV / A, RMSE_stress=None meV / A^3
2025-08-21 10:52:17.257 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-59.pt
2025-08-21 10:52:17.336 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-60.pt
2025-08-21 11:06:43.883 INFO: Epoch 61: head: pt_head, loss=0.00241292, RMSE_E_per_atom=   70.73 meV, RMSE_F=  383.90 meV / A, RMSE_stress=   11.15 meV / A^3
2025-08-21 11:08:20.406 INFO: Epoch 61: head: Default, loss=0.00017496, RMSE_E_per_atom=    6.16 meV, RMSE_F= 1230.66 meV / A, RMSE_stress=None meV / A^3
2025-08-21 11:08:20.409 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-60.pt
2025-08-21 11:08:20.572 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-61.pt
2025-08-21 11:22:46.691 INFO: Epoch 62: head: pt_head, loss=0.00242336, RMSE_E_per_atom=   72.50 meV, RMSE_F=  381.34 meV / A, RMSE_stress=   11.25 meV / A^3
2025-08-21 11:24:23.148 INFO: Epoch 62: head: Default, loss=0.00017308, RMSE_E_per_atom=    6.11 meV, RMSE_F= 1224.50 meV / A, RMSE_stress=None meV / A^3
2025-08-21 11:24:23.151 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-61.pt
2025-08-21 11:24:23.290 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-62.pt
2025-08-21 11:38:50.376 INFO: Epoch 63: head: pt_head, loss=0.00241423, RMSE_E_per_atom=   70.68 meV, RMSE_F=  382.47 meV / A, RMSE_stress=   11.25 meV / A^3
2025-08-21 11:40:26.432 INFO: Epoch 63: head: Default, loss=0.00017292, RMSE_E_per_atom=    6.10 meV, RMSE_F= 1225.17 meV / A, RMSE_stress=None meV / A^3
2025-08-21 11:40:26.435 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-62.pt
2025-08-21 11:40:26.514 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-63.pt
2025-08-21 11:54:53.083 INFO: Epoch 64: head: pt_head, loss=0.00242172, RMSE_E_per_atom=   72.26 meV, RMSE_F=  385.39 meV / A, RMSE_stress=   11.30 meV / A^3
2025-08-21 11:56:29.447 INFO: Epoch 64: head: Default, loss=0.00017148, RMSE_E_per_atom=    6.09 meV, RMSE_F= 1219.97 meV / A, RMSE_stress=None meV / A^3
2025-08-21 11:56:29.450 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-63.pt
2025-08-21 11:56:29.535 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-64.pt
2025-08-21 12:10:56.920 INFO: Epoch 65: head: pt_head, loss=0.00243622, RMSE_E_per_atom=   72.91 meV, RMSE_F=  385.25 meV / A, RMSE_stress=   11.23 meV / A^3
2025-08-21 12:12:33.499 INFO: Epoch 65: head: Default, loss=0.00017018, RMSE_E_per_atom=    6.07 meV, RMSE_F= 1218.71 meV / A, RMSE_stress=None meV / A^3
2025-08-21 12:12:33.502 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-64.pt
2025-08-21 12:12:33.572 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-65.pt
2025-08-21 12:27:00.653 INFO: Epoch 66: head: pt_head, loss=0.00243597, RMSE_E_per_atom=   72.44 meV, RMSE_F=  383.79 meV / A, RMSE_stress=   11.27 meV / A^3
2025-08-21 12:28:36.763 INFO: Epoch 66: head: Default, loss=0.00016801, RMSE_E_per_atom=    6.02 meV, RMSE_F= 1218.99 meV / A, RMSE_stress=None meV / A^3
2025-08-21 12:28:36.766 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-65.pt
2025-08-21 12:28:36.843 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-66.pt
2025-08-21 12:43:03.412 INFO: Epoch 67: head: pt_head, loss=0.00243583, RMSE_E_per_atom=   72.38 meV, RMSE_F=  385.01 meV / A, RMSE_stress=   11.29 meV / A^3
2025-08-21 12:44:39.856 INFO: Epoch 67: head: Default, loss=0.00016835, RMSE_E_per_atom=    6.03 meV, RMSE_F= 1212.87 meV / A, RMSE_stress=None meV / A^3
2025-08-21 12:59:04.882 INFO: Epoch 68: head: pt_head, loss=0.00243212, RMSE_E_per_atom=   72.82 meV, RMSE_F=  381.90 meV / A, RMSE_stress=   11.33 meV / A^3
2025-08-21 13:00:41.210 INFO: Epoch 68: head: Default, loss=0.00016691, RMSE_E_per_atom=    6.00 meV, RMSE_F= 1204.89 meV / A, RMSE_stress=None meV / A^3
2025-08-21 13:00:41.213 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-66.pt
2025-08-21 13:00:41.398 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-68.pt
2025-08-21 13:15:08.291 INFO: Epoch 69: head: pt_head, loss=0.00242792, RMSE_E_per_atom=   72.92 meV, RMSE_F=  383.31 meV / A, RMSE_stress=   11.34 meV / A^3
2025-08-21 13:16:44.554 INFO: Epoch 69: head: Default, loss=0.00016597, RMSE_E_per_atom=    5.98 meV, RMSE_F= 1203.32 meV / A, RMSE_stress=None meV / A^3
2025-08-21 13:16:44.557 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-68.pt
2025-08-21 13:16:44.651 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-69.pt
2025-08-21 13:31:11.142 INFO: Epoch 70: head: pt_head, loss=0.00242851, RMSE_E_per_atom=   72.83 meV, RMSE_F=  383.56 meV / A, RMSE_stress=   11.39 meV / A^3
2025-08-21 13:32:47.561 INFO: Epoch 70: head: Default, loss=0.00016464, RMSE_E_per_atom=    5.95 meV, RMSE_F= 1201.87 meV / A, RMSE_stress=None meV / A^3
2025-08-21 13:32:47.564 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-69.pt
2025-08-21 13:32:47.645 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-70.pt
2025-08-21 13:47:13.773 INFO: Epoch 71: head: pt_head, loss=0.00243620, RMSE_E_per_atom=   72.84 meV, RMSE_F=  381.69 meV / A, RMSE_stress=   11.32 meV / A^3
2025-08-21 13:48:50.354 INFO: Epoch 71: head: Default, loss=0.00016364, RMSE_E_per_atom=    5.93 meV, RMSE_F= 1199.27 meV / A, RMSE_stress=None meV / A^3
2025-08-21 13:48:50.358 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-70.pt
2025-08-21 13:48:50.443 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-71.pt
2025-08-21 14:03:19.109 INFO: Epoch 72: head: pt_head, loss=0.00244130, RMSE_E_per_atom=   72.60 meV, RMSE_F=  383.67 meV / A, RMSE_stress=   11.31 meV / A^3
2025-08-21 14:04:55.113 INFO: Epoch 72: head: Default, loss=0.00016230, RMSE_E_per_atom=    5.91 meV, RMSE_F= 1199.06 meV / A, RMSE_stress=None meV / A^3
2025-08-21 14:04:55.117 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-71.pt
2025-08-21 14:04:55.162 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-72.pt
2025-08-21 14:19:21.080 INFO: Epoch 73: head: pt_head, loss=0.00244370, RMSE_E_per_atom=   72.41 meV, RMSE_F=  387.16 meV / A, RMSE_stress=   11.36 meV / A^3
2025-08-21 14:20:57.641 INFO: Epoch 73: head: Default, loss=0.00016155, RMSE_E_per_atom=    5.89 meV, RMSE_F= 1195.88 meV / A, RMSE_stress=None meV / A^3
2025-08-21 14:20:57.644 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-72.pt
2025-08-21 14:20:57.716 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-73.pt
2025-08-21 14:35:25.294 INFO: Epoch 74: head: pt_head, loss=0.00244074, RMSE_E_per_atom=   72.54 meV, RMSE_F=  389.16 meV / A, RMSE_stress=   11.41 meV / A^3
2025-08-21 14:37:01.686 INFO: Epoch 74: head: Default, loss=0.00016101, RMSE_E_per_atom=    5.88 meV, RMSE_F= 1191.38 meV / A, RMSE_stress=None meV / A^3
2025-08-21 14:37:01.689 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-73.pt
2025-08-21 14:37:01.800 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-74.pt
2025-08-21 14:51:28.965 INFO: Epoch 75: head: pt_head, loss=0.00243318, RMSE_E_per_atom=   72.25 meV, RMSE_F=  388.99 meV / A, RMSE_stress=   11.37 meV / A^3
2025-08-21 14:53:04.964 INFO: Epoch 75: head: Default, loss=0.00015948, RMSE_E_per_atom=    5.85 meV, RMSE_F= 1190.05 meV / A, RMSE_stress=None meV / A^3
2025-08-21 14:53:04.968 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-74.pt
2025-08-21 14:53:05.024 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-75.pt
2025-08-21 15:07:33.368 INFO: Epoch 76: head: pt_head, loss=0.00243382, RMSE_E_per_atom=   72.45 meV, RMSE_F=  389.45 meV / A, RMSE_stress=   11.36 meV / A^3
2025-08-21 15:09:09.739 INFO: Epoch 76: head: Default, loss=0.00015943, RMSE_E_per_atom=    5.85 meV, RMSE_F= 1187.28 meV / A, RMSE_stress=None meV / A^3
2025-08-21 15:09:09.741 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-75.pt
2025-08-21 15:09:09.813 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-76.pt
2025-08-21 15:23:37.722 INFO: Epoch 77: head: pt_head, loss=0.00243839, RMSE_E_per_atom=   73.16 meV, RMSE_F=  391.01 meV / A, RMSE_stress=   11.38 meV / A^3
2025-08-21 15:25:14.125 INFO: Epoch 77: head: Default, loss=0.00015860, RMSE_E_per_atom=    5.83 meV, RMSE_F= 1184.90 meV / A, RMSE_stress=None meV / A^3
2025-08-21 15:25:14.128 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-76.pt
2025-08-21 15:25:14.169 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-77.pt
2025-08-21 20:25:24.477 INFO: ===========VERIFYING SETTINGS===========
2025-08-21 20:25:24.477 INFO: MACE version: 0.3.14
2025-08-21 20:25:24.477 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f314eb1ac00>, compute_atomic_dipole=<function str2bool at 0x7f314eb1ac00>, train_file='/home/phanim/harshitrawat/summer/iteration_3-Copy1/one.xyz', valid_file=None, valid_fraction=0.5, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.006, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-21 20:25:24.544 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-21 20:25:24.769 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:25:24.801 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:25:24.819 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-21 20:25:24.845 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-21 20:25:25.337 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-21 20:25:25.339 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-21 20:25:25.339 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-21 20:25:25.339 INFO: ===========LOADING INPUT DATA===========
2025-08-21 20:25:25.339 INFO: Using heads: ['Default', 'pt_head']
2025-08-21 20:25:25.339 INFO: Using the key specifications to parse data:
2025-08-21 20:25:25.339 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:25:25.339 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:25:25.339 INFO: =============    Processing head Default     ===========
2025-08-21 20:25:25.339 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/iteration_3-Copy1/one.xyz
2025-08-21 20:25:45.624 INFO: ===========VERIFYING SETTINGS===========
2025-08-21 20:25:45.624 INFO: MACE version: 0.3.14
2025-08-21 20:25:45.624 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7fb686422c00>, compute_atomic_dipole=<function str2bool at 0x7fb686422c00>, train_file='/home/phanim/harshitrawat/summer/iteration_3-Copy1/one.xyz', valid_file=None, valid_fraction=0.5, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.006, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-21 20:25:45.685 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-21 20:25:45.729 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:25:45.733 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:25:45.737 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-21 20:25:45.740 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-21 20:25:46.281 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-21 20:25:46.282 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-21 20:25:46.282 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-21 20:25:46.282 INFO: ===========LOADING INPUT DATA===========
2025-08-21 20:25:46.282 INFO: Using heads: ['Default', 'pt_head']
2025-08-21 20:25:46.282 INFO: Using the key specifications to parse data:
2025-08-21 20:25:46.282 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:25:46.282 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:25:46.282 INFO: =============    Processing head Default     ===========
2025-08-21 20:25:46.283 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/iteration_3-Copy1/one.xyz
2025-08-21 20:26:21.136 INFO: ===========VERIFYING SETTINGS===========
2025-08-21 20:26:21.136 INFO: MACE version: 0.3.14
2025-08-21 20:26:21.136 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7efcd1826c00>, compute_atomic_dipole=<function str2bool at 0x7efcd1826c00>, train_file='/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz', valid_file=None, valid_fraction=0.5, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.006, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-21 20:26:21.230 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-21 20:26:21.263 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:26:21.266 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:26:21.271 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-21 20:26:21.276 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-21 20:26:21.690 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-21 20:26:21.691 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-21 20:26:21.691 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-21 20:26:21.691 INFO: ===========LOADING INPUT DATA===========
2025-08-21 20:26:21.691 INFO: Using heads: ['Default', 'pt_head']
2025-08-21 20:26:21.691 INFO: Using the key specifications to parse data:
2025-08-21 20:26:21.691 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:26:21.691 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:26:21.692 INFO: =============    Processing head Default     ===========
2025-08-21 20:26:21.692 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz
2025-08-21 20:26:21.698 WARNING: No forces found with key 'REF_forces' in '/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-08-21 20:26:21.698 INFO: Training set 1/1 [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:26:21.699 INFO: Total Training set [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:26:21.699 INFO: No validation set provided, splitting training data instead.
2025-08-21 20:27:14.676 INFO: ===========VERIFYING SETTINGS===========
2025-08-21 20:27:14.676 INFO: MACE version: 0.3.14
2025-08-21 20:27:14.676 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f52e150ec00>, compute_atomic_dipole=<function str2bool at 0x7f52e150ec00>, train_file='/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz', valid_file=None, valid_fraction=0.5, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.006, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-21 20:27:14.733 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-21 20:27:14.773 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:27:14.800 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:27:14.804 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-21 20:27:14.809 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-21 20:27:15.236 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-21 20:27:15.237 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-21 20:27:15.237 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-21 20:27:15.237 INFO: ===========LOADING INPUT DATA===========
2025-08-21 20:27:15.237 INFO: Using heads: ['Default', 'pt_head']
2025-08-21 20:27:15.237 INFO: Using the key specifications to parse data:
2025-08-21 20:27:15.237 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:27:15.237 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:27:15.238 INFO: =============    Processing head Default     ===========
2025-08-21 20:27:15.238 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz
2025-08-21 20:27:15.245 WARNING: No forces found with key 'REF_forces' in '/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-08-21 20:27:15.245 INFO: Training set 1/1 [energy: 2, stress: 0, virials: 0, dipole components: 0, head: 2, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:27:15.245 INFO: Total Training set [energy: 2, stress: 0, virials: 0, dipole components: 0, head: 2, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:27:15.245 INFO: No validation set provided, splitting training data instead.
2025-08-21 20:27:15.245 INFO: Using random 50% of training set for validation with following indices: [0]
2025-08-21 20:27:15.245 INFO: Random Split Training set [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:27:15.245 INFO: Random Split Validation set [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:27:15.245 INFO: Total number of configurations: train=1, valid=1, tests=[],
2025-08-21 20:27:15.245 INFO: =============    Processing head pt_head     ===========
2025-08-21 20:27:15.246 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz
2025-08-21 20:27:18.126 INFO: Training set 1/1 [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-21 20:27:18.151 INFO: Total Training set [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-21 20:27:18.151 INFO: No validation set provided, splitting training data instead.
2025-08-21 20:27:18.154 INFO: Using random 50% of training set for validation with indices saved in: ./valid_indices_84.txt
2025-08-21 20:27:18.169 INFO: Random Split Training set [energy: 5000, stress: 5000, virials: 0, dipole components: 0, head: 5000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 5000, charges: 0]
2025-08-21 20:27:18.183 INFO: Random Split Validation set [energy: 5000, stress: 5000, virials: 0, dipole components: 0, head: 5000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 5000, charges: 0]
2025-08-21 20:27:18.183 INFO: Total number of configurations: train=5000, valid=5000, tests=[],
2025-08-21 20:27:18.183 INFO: ==================Using multiheads finetuning mode==================
2025-08-21 20:27:18.183 WARNING: Ratio of the number of configurations in the training set and the in the pt_train_file is 0.0002, increasing the number of configurations in the fine-tuning heads by 500
2025-08-21 20:27:18.183 INFO: Total number of configurations in pretraining: train=5000, valid=5000
2025-08-21 20:27:18.183 INFO: Using atomic numbers from command line argument
2025-08-21 20:27:18.205 INFO: Atomic Numbers used: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-21 20:27:18.205 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-21 20:27:18.209 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-08-21 20:27:18.209 INFO: Atomic Energies used (z: eV) for head pt_head: {1: -3.667168021358939, 3: -3.482100566595956, 4: -4.736697230897597, 5: -7.724935420523256, 6: -8.405573550273285, 7: -7.360100452662763, 8: -7.28459863421322, 9: -4.896490881731322, 11: -2.7593613569762425, 12: -2.814047612069227, 13: -4.846881245288104, 14: -7.694793133351899, 15: -6.9632957911820235, 16: -4.672630400190884, 17: -2.8116892814008096, 19: -2.6176454856894793, 20: -5.390461060484104, 21: -7.8857952163517675, 22: -10.268392986214433, 23: -8.665147785496703, 24: -9.233050763772013, 25: -8.304951520770791, 26: -7.0489865771593765, 27: -5.577439766222147, 28: -5.172747618813715, 29: -3.2520726958619472, 30: -1.2901611618726314, 31: -3.527082192997912, 32: -4.70845955030298, 33: -3.9765109025623238, 34: -3.886231055836541, 35: -2.5184940099633986, 36: 6.766947645687137, 37: -2.5634958965928316, 38: -4.938005211501922, 39: -10.149818838085771, 40: -11.846857579882572, 41: -12.138896361658485, 42: -8.791678800595722, 43: -8.78694939675911, 44: -7.78093221529871, 45: -6.850021409115055, 46: -4.891019073240479, 47: -2.0634296773864045, 48: -0.6395695518943755, 49: -2.7887442084286693, 50: -3.818604275441892, 51: -3.587068329278862, 52: -2.8804045971118897, 53: -1.6355986842433357, 54: 9.846723842807721, 55: -2.765284507132287, 56: -4.990956432167774, 57: -8.933684809576345, 58: -8.735591176647514, 59: -8.018966025544966, 60: -8.251491970213372, 61: -7.591719594359237, 62: -8.169659881166858, 63: -13.592664636171698, 64: -18.517523458456985, 65: -7.647396572993602, 66: -8.122981037851925, 67: -7.607787319678067, 68: -6.85029094445494, 69: -7.8268821327130365, 70: -3.584786591677161, 71: -7.455406192077973, 72: -12.796283502572146, 73: -14.108127281277586, 74: -9.354916969477486, 75: -11.387537567890853, 76: -9.621909492152557, 77: -7.324393429417677, 78: -5.3046964808341945, 79: -2.380092582080244, 80: 0.24948924158195362, 81: -2.3239789120665026, 82: -3.730042357127322, 83: -3.438792347649683, 89: -5.062878214511315, 90: -11.02462566385297, 91: -12.265613551943261, 92: -13.855648206100362, 93: -14.933092020258243, 94: -15.282826131998245}
2025-08-21 20:27:18.209 INFO: Processing datasets for head 'Default'
2025-08-21 20:27:18.288 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz']
2025-08-21 20:27:18.288 INFO: Combining 1 list datasets for head 'Default'
2025-08-21 20:27:18.288 INFO: Head 'Default' training dataset size: 501
2025-08-21 20:27:18.288 INFO: Processing datasets for head 'pt_head'
2025-08-21 20:27:23.562 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz']
2025-08-21 20:27:23.562 INFO: Combining 1 list datasets for head 'pt_head'
2025-08-21 20:27:28.391 INFO: Head 'pt_head' training dataset size: 5000
2025-08-21 20:27:28.393 INFO: Average number of neighbors: 61.964672446250916
2025-08-21 20:27:28.393 INFO: During training the following quantities will be reported: energy, forces, stress
2025-08-21 20:27:28.393 INFO: ===========MODEL DETAILS===========
2025-08-21 20:27:33.521 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-08-21 20:27:33.526 INFO: Loading FOUNDATION model
2025-08-21 20:27:33.527 INFO: Using filtered elements: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-21 20:27:33.527 INFO: Model configuration extracted from foundation model
2025-08-21 20:27:33.527 INFO: Using universal loss function for fine-tuning
2025-08-21 20:27:33.528 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-21 20:27:33.528 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-21 20:27:33.528 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-21 20:27:33.528 INFO: Distance transform for radial basis functions: None
2025-08-21 20:27:45.744 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(86x0e -> 128x0e | 11008 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.6672, -3.4821, -4.7367, -7.7249, -8.4056, -7.3601, -7.2846, -4.8965, -2.7594, -2.8140, -4.8469, -7.6948, -6.9633, -4.6726, -2.8117, -2.6176, -5.3905, -7.8858, -10.2684, -8.6651, -9.2331, -8.3050, -7.0490, -5.5774, -5.1727, -3.2521, -1.2902, -3.5271, -4.7085, -3.9765, -3.8862, -2.5185, 6.7669, -2.5635, -4.9380, -10.1498, -11.8469, -12.1389, -8.7917, -8.7869, -7.7809, -6.8500, -4.8910, -2.0634, -0.6396, -2.7887, -3.8186, -3.5871, -2.8804, -1.6356, 9.8467, -2.7653, -4.9910, -8.9337, -8.7356, -8.0190, -8.2515, -7.5917, -8.1697, -13.5927, -18.5175, -7.6474, -8.1230, -7.6078, -6.8503, -7.8269, -3.5848, -7.4554, -12.7963, -14.1081, -9.3549, -11.3875, -9.6219, -7.3244, -5.3047, -2.3801, 0.2495, -2.3240, -3.7300, -3.4388, -5.0629, -11.0246, -12.2656, -13.8556, -14.9331, -15.2828], [0.0000, -1.2303, 0.0000, 0.0000, 0.0000, 0.0000, -23.0491, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 23.3676, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 15.1929, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 86x0e -> 128x0e+128x1o+128x2e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 86x0e -> 128x0e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-08-21 20:27:45.747 INFO: Total number of parameters: 5556810
2025-08-21 20:27:45.747 INFO: 
2025-08-21 20:27:45.747 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-21 20:27:45.747 INFO: Using ADAM as parameter optimizer
2025-08-21 20:27:45.747 INFO: Batch size: 2
2025-08-21 20:27:45.747 INFO: Using Exponential Moving Average with decay: 0.99999
2025-08-21 20:27:45.747 INFO: Number of gradient updates: 357565
2025-08-21 20:27:45.747 INFO: Learning rate: 0.0001, weight decay: 1e-08
2025-08-21 20:27:45.747 INFO: UniversalLoss(energy_weight=10.000, forces_weight=0.000, stress_weight=0.000)
2025-08-21 20:27:45.758 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-08-21 20:27:45.758 INFO: Loading checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-77.pt
2025-08-21 20:27:48.390 INFO: Using gradient clipping with tolerance=1.000
2025-08-21 20:27:48.390 INFO: 
2025-08-21 20:27:48.390 INFO: ===========TRAINING===========
2025-08-21 20:27:48.390 INFO: Started training, reporting errors on validation set
2025-08-21 20:27:48.390 INFO: Loss metrics on validation set
2025-08-21 20:28:20.852 INFO: ===========VERIFYING SETTINGS===========
2025-08-21 20:28:20.852 INFO: MACE version: 0.3.14
2025-08-21 20:28:20.853 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f0b9521ac00>, compute_atomic_dipole=<function str2bool at 0x7f0b9521ac00>, train_file='/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz', valid_file=None, valid_fraction=0.5, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file='/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.006, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=77, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-21 20:28:20.919 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-21 20:28:20.974 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:28:20.996 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:28:21.003 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-21 20:28:21.009 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-21 20:28:21.549 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-21 20:28:21.550 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-21 20:28:21.550 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-21 20:28:21.550 INFO: ===========LOADING INPUT DATA===========
2025-08-21 20:28:21.551 INFO: Using heads: ['Default', 'pt_head']
2025-08-21 20:28:21.551 INFO: Using the key specifications to parse data:
2025-08-21 20:28:21.551 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:28:21.551 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:28:21.551 INFO: =============    Processing head Default     ===========
2025-08-21 20:28:21.551 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz
2025-08-21 20:28:21.560 WARNING: No forces found with key 'REF_forces' in '/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-08-21 20:28:21.560 INFO: Training set 1/1 [energy: 2, stress: 0, virials: 0, dipole components: 0, head: 2, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:28:21.560 INFO: Total Training set [energy: 2, stress: 0, virials: 0, dipole components: 0, head: 2, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:28:21.560 INFO: No validation set provided, splitting training data instead.
2025-08-21 20:28:21.560 INFO: Using random 50% of training set for validation with following indices: [0]
2025-08-21 20:28:21.560 INFO: Random Split Training set [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:28:21.560 INFO: Random Split Validation set [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:28:21.560 INFO: Total number of configurations: train=1, valid=1, tests=[],
2025-08-21 20:28:21.560 INFO: =============    Processing head pt_head     ===========
2025-08-21 20:28:21.561 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz
2025-08-21 20:28:24.558 INFO: Training set 1/1 [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-21 20:28:24.583 INFO: Total Training set [energy: 10000, stress: 10000, virials: 0, dipole components: 0, head: 10000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 10000, charges: 0]
2025-08-21 20:28:24.583 INFO: No validation set provided, splitting training data instead.
2025-08-21 20:28:24.585 INFO: Using random 50% of training set for validation with indices saved in: ./valid_indices_84.txt
2025-08-21 20:28:24.599 INFO: Random Split Training set [energy: 5000, stress: 5000, virials: 0, dipole components: 0, head: 5000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 5000, charges: 0]
2025-08-21 20:28:24.613 INFO: Random Split Validation set [energy: 5000, stress: 5000, virials: 0, dipole components: 0, head: 5000, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 5000, charges: 0]
2025-08-21 20:28:24.613 INFO: Total number of configurations: train=5000, valid=5000, tests=[],
2025-08-21 20:28:24.613 INFO: ==================Using multiheads finetuning mode==================
2025-08-21 20:28:24.614 WARNING: Ratio of the number of configurations in the training set and the in the pt_train_file is 0.0002, increasing the number of configurations in the fine-tuning heads by 500
2025-08-21 20:28:24.614 INFO: Total number of configurations in pretraining: train=5000, valid=5000
2025-08-21 20:28:24.614 INFO: Using atomic numbers from command line argument
2025-08-21 20:28:24.635 INFO: Atomic Numbers used: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-21 20:28:24.635 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-21 20:28:24.639 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-08-21 20:28:24.639 INFO: Atomic Energies used (z: eV) for head pt_head: {1: -3.667168021358939, 3: -3.482100566595956, 4: -4.736697230897597, 5: -7.724935420523256, 6: -8.405573550273285, 7: -7.360100452662763, 8: -7.28459863421322, 9: -4.896490881731322, 11: -2.7593613569762425, 12: -2.814047612069227, 13: -4.846881245288104, 14: -7.694793133351899, 15: -6.9632957911820235, 16: -4.672630400190884, 17: -2.8116892814008096, 19: -2.6176454856894793, 20: -5.390461060484104, 21: -7.8857952163517675, 22: -10.268392986214433, 23: -8.665147785496703, 24: -9.233050763772013, 25: -8.304951520770791, 26: -7.0489865771593765, 27: -5.577439766222147, 28: -5.172747618813715, 29: -3.2520726958619472, 30: -1.2901611618726314, 31: -3.527082192997912, 32: -4.70845955030298, 33: -3.9765109025623238, 34: -3.886231055836541, 35: -2.5184940099633986, 36: 6.766947645687137, 37: -2.5634958965928316, 38: -4.938005211501922, 39: -10.149818838085771, 40: -11.846857579882572, 41: -12.138896361658485, 42: -8.791678800595722, 43: -8.78694939675911, 44: -7.78093221529871, 45: -6.850021409115055, 46: -4.891019073240479, 47: -2.0634296773864045, 48: -0.6395695518943755, 49: -2.7887442084286693, 50: -3.818604275441892, 51: -3.587068329278862, 52: -2.8804045971118897, 53: -1.6355986842433357, 54: 9.846723842807721, 55: -2.765284507132287, 56: -4.990956432167774, 57: -8.933684809576345, 58: -8.735591176647514, 59: -8.018966025544966, 60: -8.251491970213372, 61: -7.591719594359237, 62: -8.169659881166858, 63: -13.592664636171698, 64: -18.517523458456985, 65: -7.647396572993602, 66: -8.122981037851925, 67: -7.607787319678067, 68: -6.85029094445494, 69: -7.8268821327130365, 70: -3.584786591677161, 71: -7.455406192077973, 72: -12.796283502572146, 73: -14.108127281277586, 74: -9.354916969477486, 75: -11.387537567890853, 76: -9.621909492152557, 77: -7.324393429417677, 78: -5.3046964808341945, 79: -2.380092582080244, 80: 0.24948924158195362, 81: -2.3239789120665026, 82: -3.730042357127322, 83: -3.438792347649683, 89: -5.062878214511315, 90: -11.02462566385297, 91: -12.265613551943261, 92: -13.855648206100362, 93: -14.933092020258243, 94: -15.282826131998245}
2025-08-21 20:28:24.639 INFO: Processing datasets for head 'Default'
2025-08-21 20:28:24.717 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz']
2025-08-21 20:28:24.717 INFO: Combining 1 list datasets for head 'Default'
2025-08-21 20:28:24.717 INFO: Head 'Default' training dataset size: 501
2025-08-21 20:28:24.717 INFO: Processing datasets for head 'pt_head'
2025-08-21 20:28:29.959 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/mp_finetuning-mace_T2_mp_replay_run-42.xyz']
2025-08-21 20:28:29.959 INFO: Combining 1 list datasets for head 'pt_head'
2025-08-21 20:28:35.578 INFO: Head 'pt_head' training dataset size: 5000
2025-08-21 20:28:35.579 INFO: Average number of neighbors: 61.964672446250916
2025-08-21 20:28:35.579 INFO: During training the following quantities will be reported: energy, forces, stress
2025-08-21 20:28:35.579 INFO: ===========MODEL DETAILS===========
2025-08-21 20:28:39.688 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-08-21 20:28:39.692 INFO: Loading FOUNDATION model
2025-08-21 20:28:39.693 INFO: Using filtered elements: [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94]
2025-08-21 20:28:39.693 INFO: Model configuration extracted from foundation model
2025-08-21 20:28:39.693 INFO: Using universal loss function for fine-tuning
2025-08-21 20:28:39.693 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-21 20:28:39.693 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-21 20:28:39.693 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-21 20:28:39.693 INFO: Distance transform for radial basis functions: None
2025-08-21 20:28:48.973 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(86x0e -> 128x0e | 11008 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.6672, -3.4821, -4.7367, -7.7249, -8.4056, -7.3601, -7.2846, -4.8965, -2.7594, -2.8140, -4.8469, -7.6948, -6.9633, -4.6726, -2.8117, -2.6176, -5.3905, -7.8858, -10.2684, -8.6651, -9.2331, -8.3050, -7.0490, -5.5774, -5.1727, -3.2521, -1.2902, -3.5271, -4.7085, -3.9765, -3.8862, -2.5185, 6.7669, -2.5635, -4.9380, -10.1498, -11.8469, -12.1389, -8.7917, -8.7869, -7.7809, -6.8500, -4.8910, -2.0634, -0.6396, -2.7887, -3.8186, -3.5871, -2.8804, -1.6356, 9.8467, -2.7653, -4.9910, -8.9337, -8.7356, -8.0190, -8.2515, -7.5917, -8.1697, -13.5927, -18.5175, -7.6474, -8.1230, -7.6078, -6.8503, -7.8269, -3.5848, -7.4554, -12.7963, -14.1081, -9.3549, -11.3875, -9.6219, -7.3244, -5.3047, -2.3801, 0.2495, -2.3240, -3.7300, -3.4388, -5.0629, -11.0246, -12.2656, -13.8556, -14.9331, -15.2828], [0.0000, -1.2303, 0.0000, 0.0000, 0.0000, 0.0000, -23.0491, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 23.3676, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 15.1929, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 86x0e -> 128x0e+128x1o+128x2e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 86x0e -> 128x0e | 1409024 paths | 1409024 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 86x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 86x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-08-21 20:28:48.976 INFO: Total number of parameters: 5556810
2025-08-21 20:28:48.976 INFO: 
2025-08-21 20:28:48.976 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-21 20:28:48.976 INFO: Using ADAM as parameter optimizer
2025-08-21 20:28:48.976 INFO: Batch size: 2
2025-08-21 20:28:48.976 INFO: Using Exponential Moving Average with decay: 0.99999
2025-08-21 20:28:48.976 INFO: Number of gradient updates: 211788
2025-08-21 20:28:48.976 INFO: Learning rate: 0.0001, weight decay: 1e-08
2025-08-21 20:28:48.976 INFO: UniversalLoss(energy_weight=10.000, forces_weight=0.000, stress_weight=0.000)
2025-08-21 20:28:48.978 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-08-21 20:28:48.978 INFO: Loading checkpoint: ./checkpoints/mace_T2_including_replay_w2_run-84_epoch-77.pt
2025-08-21 20:28:49.240 INFO: Using gradient clipping with tolerance=1.000
2025-08-21 20:28:49.240 INFO: 
2025-08-21 20:28:49.240 INFO: ===========TRAINING===========
2025-08-21 20:28:49.241 INFO: Started training, reporting errors on validation set
2025-08-21 20:28:49.241 INFO: Loss metrics on validation set
2025-08-21 20:38:33.809 INFO: ===========VERIFYING SETTINGS===========
2025-08-21 20:38:33.809 INFO: MACE version: 0.3.14
2025-08-21 20:38:33.809 DEBUG: Configuration: Namespace(config=None, name='mace_T2_including_replay_w2', seed=84, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, plot_interaction_e=False, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, use_last_readout_only=False, use_embedding_readout=False, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=False, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, compute_polarizability=<function str2bool at 0x7f3016622c00>, compute_atomic_dipole=<function str2bool at 0x7f3016622c00>, train_file='/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz', valid_file=None, valid_fraction=0.5, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, les_arguments=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', pseudolabel_replay=False, foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, real_pt_data_ratio_threshold=0.1, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', allow_random_padding_pt=True, pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', polarizability_key='polarizability', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=0.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, swa_polarizability_weight=1.0, polarizability_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.006, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=77, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, enable_oeq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-21 20:38:33.878 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-21 20:38:33.928 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:38:33.966 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/iteration_3-copy, stdin=None, shell=False, universal_newlines=False)
2025-08-21 20:38:33.972 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-21 20:38:33.975 DEBUG: Current Git commit: 624a439ffb84b7acce76eceb76f5ccfb4dfdb592
2025-08-21 20:38:34.433 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-21 20:38:34.434 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-08-21 20:38:34.434 INFO: ===========LOADING INPUT DATA===========
2025-08-21 20:38:34.434 INFO: Using heads: ['Default']
2025-08-21 20:38:34.434 INFO: Using the key specifications to parse data:
2025-08-21 20:38:34.434 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'polarizability': 'polarizability', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-21 20:38:34.434 INFO: =============    Processing head Default     ===========
2025-08-21 20:38:34.434 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz
2025-08-21 20:38:34.441 WARNING: No forces found with key 'REF_forces' in '/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz'. If this is unexpected, Please change the key name in the command line arguments or ensure that the file contains the required data.
2025-08-21 20:38:34.441 INFO: Training set 1/1 [energy: 2, stress: 0, virials: 0, dipole components: 0, head: 2, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:38:34.441 INFO: Total Training set [energy: 2, stress: 0, virials: 0, dipole components: 0, head: 2, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:38:34.441 INFO: No validation set provided, splitting training data instead.
2025-08-21 20:38:34.442 INFO: Using random 50% of training set for validation with following indices: [0]
2025-08-21 20:38:34.442 INFO: Random Split Training set [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:38:34.442 INFO: Random Split Validation set [energy: 1, stress: 0, virials: 0, dipole components: 0, head: 1, elec_temp: 0, total_charge: 0, polarizability: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-21 20:38:34.442 INFO: Total number of configurations: train=1, valid=1, tests=[],
2025-08-21 20:38:34.442 ERROR: Batch size (2) is larger than the number of training data (1)
2025-08-21 20:38:34.442 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-08-21 20:38:34.442 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-08-21 20:38:34.442 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-08-21 20:38:34.442 INFO: Processing datasets for head 'Default'
2025-08-21 20:38:34.443 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/iteration_3-copy/one.xyz']
2025-08-21 20:38:34.443 INFO: Combining 1 list datasets for head 'Default'
2025-08-21 20:38:34.443 INFO: Head 'Default' training dataset size: 1
2025-08-21 20:38:34.444 INFO: Computing average number of neighbors
