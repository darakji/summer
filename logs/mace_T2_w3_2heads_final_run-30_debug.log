2025-09-22 03:31:04.559 INFO: ===========VERIFYING SETTINGS===========
2025-09-22 03:31:04.559 INFO: MACE version: 0.3.14
2025-09-22 03:31:04.559 DEBUG: Configuration: Namespace(config=None, name='mace_T2_w3_2heads_final', seed=30, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file=None, valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads="{\n  'target_head': {\n    'train_file': '/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz',\n    'E0s': '/home/phanim/harshitrawat/summer/e0s_llzo.json'\n  },\n  'pt_head': {\n    'train_file': '/home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz',\n    'E0s': '/home/phanim/harshitrawat/summer/e0s_llzo.json'\n  }\n}", multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=50.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.002, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=40, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-09-22 03:31:04.771 INFO: CUDA version: 12.1, CUDA device: 0
2025-09-22 03:31:04.995 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-09-22 03:31:05.000 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-09-22 03:31:05.010 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-09-22 03:31:05.026 DEBUG: Current Git commit: 7bc4aa2b02a199f3650610a022c2258d3b2e92ae
2025-09-22 03:31:05.972 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-09-22 03:31:05.973 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-09-22 03:31:05.973 INFO: ===========LOADING INPUT DATA===========
2025-09-22 03:31:05.973 INFO: Using heads: ['target_head', 'pt_head']
2025-09-22 03:31:05.973 INFO: Using the key specifications to parse data:
2025-09-22 03:31:05.973 INFO: target_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-09-22 03:31:05.973 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-09-22 03:31:05.973 INFO: =============    Processing head target_head     ===========
2025-09-22 03:31:05.975 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz
2025-09-22 03:31:12.089 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 1612, charges: 0]
2025-09-22 03:31:12.094 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 1612, charges: 0]
2025-09-22 03:31:14.665 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-22 03:31:14.667 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-22 03:31:14.667 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-09-22 03:31:14.667 INFO: =============    Processing head pt_head     ===========
2025-09-22 03:31:14.669 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz
2025-09-22 03:31:14.734 INFO: Training set 1/1 [energy: 142, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-09-22 03:31:14.735 INFO: Total Training set [energy: 142, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-09-22 03:31:17.283 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-22 03:31:17.285 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-22 03:31:17.285 INFO: Total number of configurations: train=142, valid=705, tests=[],
2025-09-22 03:31:17.285 INFO: Using atomic numbers from command line argument
2025-09-22 03:31:17.285 INFO: Using atomic numbers from command line argument
2025-09-22 03:31:17.285 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-09-22 03:31:17.285 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-09-22 03:31:17.285 INFO: Loading atomic energies from /home/phanim/harshitrawat/summer/e0s_llzo.json
2025-09-22 03:31:17.287 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-09-22 03:31:17.287 INFO: Loading atomic energies from /home/phanim/harshitrawat/summer/e0s_llzo.json
2025-09-22 03:31:17.289 INFO: Atomic Energies used (z: eV) for head target_head: {3: -1.882, 8: -4.913, 40: -8.509, 57: -4.894}
2025-09-22 03:31:17.289 INFO: Atomic Energies used (z: eV) for head pt_head: {3: -1.882, 8: -4.913, 40: -8.509, 57: -4.894}
2025-09-22 03:31:17.289 INFO: Processing datasets for head 'target_head'
2025-09-22 03:32:09.766 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz']
2025-09-22 03:32:09.767 INFO: Combining 1 list datasets for head 'target_head'
2025-09-22 03:32:32.770 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-09-22 03:32:32.770 INFO: Combining 1 list datasets for head 'target_head_valid'
2025-09-22 03:32:32.770 INFO: Combined validation datasets for target_head
2025-09-22 03:32:32.770 INFO: Head 'target_head' training dataset size: 1612
2025-09-22 03:32:32.771 INFO: Processing datasets for head 'pt_head'
2025-09-22 03:32:32.876 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz']
2025-09-22 03:32:32.876 INFO: Combining 1 list datasets for head 'pt_head'
2025-09-22 03:32:56.131 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-09-22 03:32:56.131 INFO: Combining 1 list datasets for head 'pt_head_valid'
2025-09-22 03:32:56.131 INFO: Combined validation datasets for pt_head
2025-09-22 03:32:56.131 INFO: Head 'pt_head' training dataset size: 142
2025-09-22 03:32:56.132 INFO: Computing average number of neighbors
2025-09-22 03:32:58.758 INFO: Average number of neighbors: 67.31388041084317
2025-09-22 03:32:58.759 INFO: During training the following quantities will be reported: energy, forces
2025-09-22 03:32:58.759 INFO: ===========MODEL DETAILS===========
2025-09-22 03:33:00.325 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-09-22 03:33:00.329 INFO: Loading FOUNDATION model
2025-09-22 03:33:00.329 INFO: Using filtered elements: [3, 8, 40, 57]
2025-09-22 03:33:00.330 INFO: Model configuration extracted from foundation model
2025-09-22 03:33:00.330 INFO: Using weighted loss function for fine-tuning
2025-09-22 03:33:00.330 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-09-22 03:33:00.330 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-22 03:33:00.330 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-09-22 03:33:00.330 INFO: Distance transform for radial basis functions: None
2025-09-22 03:33:01.795 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.8820, -4.9130, -8.5090, -4.8940], [-1.8820, -4.9130, -8.5090, -4.8940]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-09-22 03:33:01.796 INFO: Total number of parameters: 896586
2025-09-22 03:33:01.796 INFO: 
2025-09-22 03:33:01.796 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-22 03:33:01.796 INFO: Using ADAM as parameter optimizer
2025-09-22 03:33:01.796 INFO: Batch size: 2
2025-09-22 03:33:01.796 INFO: Number of gradient updates: 35080
2025-09-22 03:33:01.796 INFO: Learning rate: 0.002, weight decay: 1e-08
2025-09-22 03:33:01.796 INFO: WeightedEnergyForcesLoss(energy_weight=50.000, forces_weight=10.000)
2025-09-22 03:33:01.804 WARNING: Cannot find checkpoint with tag 'mace_T2_w3_2heads_final_run-30' in './checkpoints'
2025-09-22 03:33:01.804 INFO: Using gradient clipping with tolerance=1.000
2025-09-22 03:33:01.804 INFO: 
2025-09-22 03:33:01.804 INFO: ===========TRAINING===========
2025-09-22 03:33:01.804 INFO: Started training, reporting errors on validation set
2025-09-22 03:33:01.804 INFO: Loss metrics on validation set
2025-09-25 23:10:13.871 INFO: ===========VERIFYING SETTINGS===========
2025-09-25 23:10:13.871 INFO: MACE version: 0.3.14
2025-09-25 23:10:13.871 DEBUG: Configuration: Namespace(config=None, name='mace_T2_w3_2heads_final', seed=30, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file=None, valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads="{\n  'target_head': {\n    'train_file': '/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz',\n    'E0s': '/home/phanim/harshitrawat/summer/e0s_llzo.json'\n  },\n  'pt_head': {\n    'train_file': '/home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz',\n    'E0s': '/home/phanim/harshitrawat/summer/e0s_llzo.json'\n  }\n}", multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=50.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.002, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=40, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-09-25 23:10:14.954 INFO: CUDA version: 12.1, CUDA device: 0
2025-09-25 23:10:15.028 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-09-25 23:10:15.034 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-09-25 23:10:15.040 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-09-25 23:10:15.151 DEBUG: Current Git commit: 7bc4aa2b02a199f3650610a022c2258d3b2e92ae
2025-09-25 23:10:15.766 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-09-25 23:10:15.767 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-09-25 23:10:15.768 INFO: ===========LOADING INPUT DATA===========
2025-09-25 23:10:15.768 INFO: Using heads: ['target_head', 'pt_head']
2025-09-25 23:10:15.768 INFO: Using the key specifications to parse data:
2025-09-25 23:10:15.768 INFO: target_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-09-25 23:10:15.768 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-09-25 23:10:15.768 INFO: =============    Processing head target_head     ===========
2025-09-25 23:10:15.793 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz
2025-09-25 23:10:21.941 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 1612, charges: 0]
2025-09-25 23:10:21.945 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 1612, charges: 0]
2025-09-25 23:10:24.504 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-25 23:10:24.506 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-25 23:10:24.507 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-09-25 23:10:24.507 INFO: =============    Processing head pt_head     ===========
2025-09-25 23:10:24.520 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz
2025-09-25 23:10:24.584 INFO: Training set 1/1 [energy: 142, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-09-25 23:10:24.585 INFO: Total Training set [energy: 142, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-09-25 23:10:27.144 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-25 23:10:27.146 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-25 23:10:27.147 INFO: Total number of configurations: train=142, valid=705, tests=[],
2025-09-25 23:10:27.147 INFO: Using atomic numbers from command line argument
2025-09-25 23:10:27.147 INFO: Using atomic numbers from command line argument
2025-09-25 23:10:27.147 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-09-25 23:10:27.147 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-09-25 23:10:27.147 INFO: Loading atomic energies from /home/phanim/harshitrawat/summer/e0s_llzo.json
2025-09-25 23:10:27.149 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-09-25 23:10:27.149 INFO: Loading atomic energies from /home/phanim/harshitrawat/summer/e0s_llzo.json
2025-09-25 23:10:27.150 INFO: Atomic Energies used (z: eV) for head target_head: {3: -1.882, 8: -4.913, 40: -8.509, 57: -4.894}
2025-09-25 23:10:27.150 INFO: Atomic Energies used (z: eV) for head pt_head: {3: -1.882, 8: -4.913, 40: -8.509, 57: -4.894}
2025-09-25 23:10:27.150 INFO: Processing datasets for head 'target_head'
2025-09-25 23:11:19.314 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz']
2025-09-25 23:11:19.314 INFO: Combining 1 list datasets for head 'target_head'
2025-09-25 23:11:41.820 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-09-25 23:11:41.820 INFO: Combining 1 list datasets for head 'target_head_valid'
2025-09-25 23:11:41.820 INFO: Combined validation datasets for target_head
2025-09-25 23:11:41.820 INFO: Head 'target_head' training dataset size: 1612
2025-09-25 23:11:41.821 INFO: Processing datasets for head 'pt_head'
2025-09-25 23:11:41.928 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz']
2025-09-25 23:11:41.928 INFO: Combining 1 list datasets for head 'pt_head'
2025-09-25 23:12:04.794 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-09-25 23:12:04.794 INFO: Combining 1 list datasets for head 'pt_head_valid'
2025-09-25 23:12:04.794 INFO: Combined validation datasets for pt_head
2025-09-25 23:12:04.794 INFO: Head 'pt_head' training dataset size: 142
2025-09-25 23:12:04.794 INFO: Computing average number of neighbors
2025-09-25 23:12:07.341 INFO: Average number of neighbors: 67.31388041084317
2025-09-25 23:12:07.341 INFO: During training the following quantities will be reported: energy, forces
2025-09-25 23:12:07.341 INFO: ===========MODEL DETAILS===========
2025-09-25 23:12:08.913 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-09-25 23:12:08.916 INFO: Loading FOUNDATION model
2025-09-25 23:12:08.917 INFO: Using filtered elements: [3, 8, 40, 57]
2025-09-25 23:12:08.917 INFO: Model configuration extracted from foundation model
2025-09-25 23:12:08.917 INFO: Using weighted loss function for fine-tuning
2025-09-25 23:12:08.917 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-09-25 23:12:08.917 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-25 23:12:08.917 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-09-25 23:12:08.917 INFO: Distance transform for radial basis functions: None
2025-09-25 23:12:10.451 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.8820, -4.9130, -8.5090, -4.8940], [-1.8820, -4.9130, -8.5090, -4.8940]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-09-25 23:12:10.452 INFO: Total number of parameters: 896586
2025-09-25 23:12:10.452 INFO: 
2025-09-25 23:12:10.452 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-25 23:12:10.452 INFO: Using ADAM as parameter optimizer
2025-09-25 23:12:10.452 INFO: Batch size: 2
2025-09-25 23:12:10.452 INFO: Number of gradient updates: 35080
2025-09-25 23:12:10.452 INFO: Learning rate: 0.002, weight decay: 1e-08
2025-09-25 23:12:10.452 INFO: WeightedEnergyForcesLoss(energy_weight=50.000, forces_weight=10.000)
2025-09-25 23:12:10.532 WARNING: Cannot find checkpoint with tag 'mace_T2_w3_2heads_final_run-30' in './checkpoints'
2025-09-25 23:12:10.532 INFO: Using gradient clipping with tolerance=1.000
2025-09-25 23:12:10.532 INFO: 
2025-09-25 23:12:10.532 INFO: ===========TRAINING===========
2025-09-25 23:12:10.532 INFO: Started training, reporting errors on validation set
2025-09-25 23:12:10.532 INFO: Loss metrics on validation set
2025-09-25 23:13:36.472 INFO: Initial: head: pt_head, loss=233.51464016, RMSE_E_per_atom= 2126.43 meV, RMSE_F=  959.54 meV / A
2025-09-25 23:14:56.386 INFO: Initial: head: target_head, loss=233.51464016, RMSE_E_per_atom= 2126.43 meV, RMSE_F=  959.54 meV / A
2025-09-25 23:25:16.772 INFO: Epoch 0: head: pt_head, loss=0.07052633, RMSE_E_per_atom=   16.43 meV, RMSE_F=   79.43 meV / A
2025-09-25 23:26:36.733 INFO: Epoch 0: head: target_head, loss=0.05964428, RMSE_E_per_atom=    6.30 meV, RMSE_F=   79.51 meV / A
2025-09-25 23:26:36.734 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-0.pt
2025-09-25 23:36:50.228 INFO: Epoch 1: head: pt_head, loss=0.08638398, RMSE_E_per_atom=   29.49 meV, RMSE_F=   69.40 meV / A
2025-09-25 23:38:10.286 INFO: Epoch 1: head: target_head, loss=0.03502399, RMSE_E_per_atom=    2.86 meV, RMSE_F=   62.99 meV / A
2025-09-25 23:38:10.288 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-0.pt
2025-09-25 23:38:10.315 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-1.pt
2025-09-25 23:48:24.366 INFO: Epoch 2: head: pt_head, loss=0.05278268, RMSE_E_per_atom=    9.82 meV, RMSE_F=   71.80 meV / A
2025-09-25 23:49:44.439 INFO: Epoch 2: head: target_head, loss=0.03978143, RMSE_E_per_atom=   11.55 meV, RMSE_F=   60.58 meV / A
2025-09-25 23:59:58.172 INFO: Epoch 3: head: pt_head, loss=0.07848801, RMSE_E_per_atom=   28.63 meV, RMSE_F=   64.22 meV / A
2025-09-26 00:01:18.230 INFO: Epoch 3: head: target_head, loss=0.05476453, RMSE_E_per_atom=   24.08 meV, RMSE_F=   53.83 meV / A
2025-09-26 00:11:31.706 INFO: Epoch 4: head: pt_head, loss=0.06305945, RMSE_E_per_atom=   22.66 meV, RMSE_F=   64.15 meV / A
2025-09-26 00:12:51.584 INFO: Epoch 4: head: target_head, loss=0.02879828, RMSE_E_per_atom=    9.11 meV, RMSE_F=   52.64 meV / A
2025-09-26 00:12:51.585 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-1.pt
2025-09-26 00:12:51.660 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-4.pt
2025-09-26 00:23:05.732 INFO: Epoch 5: head: pt_head, loss=0.08882415, RMSE_E_per_atom=   14.63 meV, RMSE_F=   89.78 meV / A
2025-09-26 00:24:25.617 INFO: Epoch 5: head: target_head, loss=0.03635069, RMSE_E_per_atom=    5.76 meV, RMSE_F=   60.99 meV / A
2025-09-26 00:34:39.812 INFO: Epoch 6: head: pt_head, loss=0.05491434, RMSE_E_per_atom=   11.98 meV, RMSE_F=   70.89 meV / A
2025-09-26 00:35:59.826 INFO: Epoch 6: head: target_head, loss=0.02914602, RMSE_E_per_atom=    6.84 meV, RMSE_F=   54.13 meV / A
2025-09-26 00:46:13.667 INFO: Epoch 7: head: pt_head, loss=0.05913847, RMSE_E_per_atom=   21.10 meV, RMSE_F=   62.99 meV / A
2025-09-26 00:47:33.575 INFO: Epoch 7: head: target_head, loss=0.03208655, RMSE_E_per_atom=   12.70 meV, RMSE_F=   51.69 meV / A
2025-09-26 00:57:48.167 INFO: Epoch 8: head: pt_head, loss=0.04146227, RMSE_E_per_atom=   13.02 meV, RMSE_F=   60.12 meV / A
2025-09-26 00:59:08.038 INFO: Epoch 8: head: target_head, loss=0.02279093, RMSE_E_per_atom=    5.88 meV, RMSE_F=   48.68 meV / A
2025-09-26 00:59:08.039 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-4.pt
2025-09-26 00:59:08.102 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-8.pt
2025-09-26 01:09:22.884 INFO: Epoch 9: head: pt_head, loss=0.03850872, RMSE_E_per_atom=    5.26 meV, RMSE_F=   63.28 meV / A
2025-09-26 01:10:43.016 INFO: Epoch 9: head: target_head, loss=0.01998711, RMSE_E_per_atom=    5.35 meV, RMSE_F=   45.81 meV / A
2025-09-26 01:10:43.034 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-8.pt
2025-09-26 01:10:43.280 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-9.pt
2025-09-26 01:19:10.965 INFO: ===========VERIFYING SETTINGS===========
2025-09-26 01:19:10.965 INFO: MACE version: 0.3.14
2025-09-26 01:19:10.965 DEBUG: Configuration: Namespace(config=None, name='mace_T2_w3_2heads_final', seed=30, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file=None, valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s=None, foundation_filter_elements=True, heads="{\n  'target_head': {\n    'train_file': '/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz',\n    'E0s': '/home/phanim/harshitrawat/summer/e0s_llzo.json'\n  },\n  'pt_head': {\n    'train_file': '/home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz',\n    'E0s': '/home/phanim/harshitrawat/summer/e0s_llzo.json'\n  }\n}", multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=50.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0002, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=40, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=1.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-09-26 01:19:11.411 INFO: CUDA version: 12.1, CUDA device: 0
2025-09-26 01:19:11.711 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-09-26 01:19:11.723 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-09-26 01:19:11.807 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-09-26 01:19:11.964 DEBUG: Current Git commit: 7bc4aa2b02a199f3650610a022c2258d3b2e92ae
2025-09-26 01:19:12.381 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-09-26 01:19:12.383 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-09-26 01:19:12.383 INFO: ===========LOADING INPUT DATA===========
2025-09-26 01:19:12.383 INFO: Using heads: ['target_head', 'pt_head']
2025-09-26 01:19:12.383 INFO: Using the key specifications to parse data:
2025-09-26 01:19:12.383 INFO: target_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-09-26 01:19:12.383 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-09-26 01:19:12.383 INFO: =============    Processing head target_head     ===========
2025-09-26 01:19:12.412 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz
2025-09-26 01:19:18.542 INFO: Training set 1/1 [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 1612, charges: 0]
2025-09-26 01:19:18.547 INFO: Total Training set [energy: 1612, stress: 0, virials: 0, dipole components: 0, head: 1612, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 1612, charges: 0]
2025-09-26 01:19:21.112 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-26 01:19:21.115 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-26 01:19:21.115 INFO: Total number of configurations: train=1612, valid=705, tests=[],
2025-09-26 01:19:21.115 INFO: =============    Processing head pt_head     ===========
2025-09-26 01:19:21.128 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz
2025-09-26 01:19:21.194 INFO: Training set 1/1 [energy: 142, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-09-26 01:19:21.194 INFO: Total Training set [energy: 142, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-09-26 01:19:23.725 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-26 01:19:23.728 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-09-26 01:19:23.728 INFO: Total number of configurations: train=142, valid=705, tests=[],
2025-09-26 01:19:23.729 INFO: Using atomic numbers from command line argument
2025-09-26 01:19:23.729 INFO: Using atomic numbers from command line argument
2025-09-26 01:19:23.729 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-09-26 01:19:23.729 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-09-26 01:19:23.729 INFO: Loading atomic energies from /home/phanim/harshitrawat/summer/e0s_llzo.json
2025-09-26 01:19:23.730 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-09-26 01:19:23.731 INFO: Loading atomic energies from /home/phanim/harshitrawat/summer/e0s_llzo.json
2025-09-26 01:19:23.732 INFO: Atomic Energies used (z: eV) for head target_head: {3: -1.882, 8: -4.913, 40: -8.509, 57: -4.894}
2025-09-26 01:19:23.732 INFO: Atomic Energies used (z: eV) for head pt_head: {3: -1.882, 8: -4.913, 40: -8.509, 57: -4.894}
2025-09-26 01:19:23.732 INFO: Processing datasets for head 'target_head'
2025-09-26 01:20:16.128 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T3_chgnet_labeled.extxyz']
2025-09-26 01:20:16.128 INFO: Combining 1 list datasets for head 'target_head'
2025-09-26 01:20:39.156 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-09-26 01:20:39.156 INFO: Combining 1 list datasets for head 'target_head_valid'
2025-09-26 01:20:39.157 INFO: Combined validation datasets for target_head
2025-09-26 01:20:39.157 INFO: Head 'target_head' training dataset size: 1612
2025-09-26 01:20:39.157 INFO: Processing datasets for head 'pt_head'
2025-09-26 01:20:39.264 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/replay_data/replay_labeled_by_chgnet.extxyz']
2025-09-26 01:20:39.264 INFO: Combining 1 list datasets for head 'pt_head'
2025-09-26 01:21:02.515 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_chgnet_labeled.extxyz']
2025-09-26 01:21:02.516 INFO: Combining 1 list datasets for head 'pt_head_valid'
2025-09-26 01:21:02.516 INFO: Combined validation datasets for pt_head
2025-09-26 01:21:02.516 INFO: Head 'pt_head' training dataset size: 142
2025-09-26 01:21:02.516 INFO: Computing average number of neighbors
2025-09-26 01:21:05.074 INFO: Average number of neighbors: 67.31388041084317
2025-09-26 01:21:05.075 INFO: During training the following quantities will be reported: energy, forces
2025-09-26 01:21:05.075 INFO: ===========MODEL DETAILS===========
2025-09-26 01:21:06.705 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-09-26 01:21:06.709 INFO: Loading FOUNDATION model
2025-09-26 01:21:06.709 INFO: Using filtered elements: [3, 8, 40, 57]
2025-09-26 01:21:06.709 INFO: Model configuration extracted from foundation model
2025-09-26 01:21:06.709 INFO: Using weighted loss function for fine-tuning
2025-09-26 01:21:06.709 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-09-26 01:21:06.709 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-09-26 01:21:06.709 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-09-26 01:21:06.709 INFO: Distance transform for radial basis functions: None
2025-09-26 01:21:08.175 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.8820, -4.9130, -8.5090, -4.8940], [-1.8820, -4.9130, -8.5090, -4.8940]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-09-26 01:21:08.176 INFO: Total number of parameters: 896586
2025-09-26 01:21:08.176 INFO: 
2025-09-26 01:21:08.176 INFO: ===========OPTIMIZER INFORMATION===========
2025-09-26 01:21:08.176 INFO: Using ADAM as parameter optimizer
2025-09-26 01:21:08.176 INFO: Batch size: 2
2025-09-26 01:21:08.176 INFO: Number of gradient updates: 35080
2025-09-26 01:21:08.176 INFO: Learning rate: 0.0002, weight decay: 1e-08
2025-09-26 01:21:08.176 INFO: WeightedEnergyForcesLoss(energy_weight=50.000, forces_weight=10.000)
2025-09-26 01:21:08.179 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-09-26 01:21:08.180 INFO: Loading checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-9.pt
2025-09-26 01:21:08.243 INFO: Using gradient clipping with tolerance=1.000
2025-09-26 01:21:08.243 INFO: 
2025-09-26 01:21:08.243 INFO: ===========TRAINING===========
2025-09-26 01:21:08.243 INFO: Started training, reporting errors on validation set
2025-09-26 01:21:08.243 INFO: Loss metrics on validation set
2025-09-26 01:22:34.504 INFO: Initial: head: pt_head, loss=0.03850872, RMSE_E_per_atom=    5.26 meV, RMSE_F=   63.28 meV / A
2025-09-26 01:23:55.003 INFO: Initial: head: target_head, loss=0.01998711, RMSE_E_per_atom=    5.35 meV, RMSE_F=   45.81 meV / A
2025-09-26 01:34:18.848 INFO: Epoch 9: head: pt_head, loss=0.03900655, RMSE_E_per_atom=    7.98 meV, RMSE_F=   62.12 meV / A
2025-09-26 01:35:39.260 INFO: Epoch 9: head: target_head, loss=0.01708782, RMSE_E_per_atom=    1.33 meV, RMSE_F=   43.90 meV / A
2025-09-26 01:35:39.263 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-9.pt
2025-09-26 01:45:56.328 INFO: Epoch 10: head: pt_head, loss=0.04123384, RMSE_E_per_atom=    9.24 meV, RMSE_F=   62.94 meV / A
2025-09-26 01:47:16.710 INFO: Epoch 10: head: target_head, loss=0.01680364, RMSE_E_per_atom=    1.10 meV, RMSE_F=   43.59 meV / A
2025-09-26 01:47:16.713 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-9.pt
2025-09-26 01:47:16.741 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-10.pt
2025-09-26 01:57:34.907 INFO: Epoch 11: head: pt_head, loss=0.03895742, RMSE_E_per_atom=    9.27 meV, RMSE_F=   61.09 meV / A
2025-09-26 01:58:55.388 INFO: Epoch 11: head: target_head, loss=0.01687704, RMSE_E_per_atom=    1.28 meV, RMSE_F=   43.66 meV / A
2025-09-26 02:09:12.319 INFO: Epoch 12: head: pt_head, loss=0.04753270, RMSE_E_per_atom=   10.36 meV, RMSE_F=   66.76 meV / A
2025-09-26 02:10:32.848 INFO: Epoch 12: head: target_head, loss=0.01725312, RMSE_E_per_atom=    1.59 meV, RMSE_F=   43.95 meV / A
2025-09-26 02:20:49.664 INFO: Epoch 13: head: pt_head, loss=0.04574621, RMSE_E_per_atom=    9.79 meV, RMSE_F=   65.86 meV / A
2025-09-26 02:22:10.077 INFO: Epoch 13: head: target_head, loss=0.01671290, RMSE_E_per_atom=    0.98 meV, RMSE_F=   43.42 meV / A
2025-09-26 02:22:10.078 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-10.pt
2025-09-26 02:22:10.160 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-13.pt
2025-09-26 02:32:28.317 INFO: Epoch 14: head: pt_head, loss=0.04467832, RMSE_E_per_atom=   10.24 meV, RMSE_F=   64.71 meV / A
2025-09-26 02:33:48.739 INFO: Epoch 14: head: target_head, loss=0.01653698, RMSE_E_per_atom=    2.22 meV, RMSE_F=   42.98 meV / A
2025-09-26 02:33:48.743 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-13.pt
2025-09-26 02:33:48.822 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-14.pt
2025-09-26 02:44:06.145 INFO: Epoch 15: head: pt_head, loss=0.04525847, RMSE_E_per_atom=   11.68 meV, RMSE_F=   63.90 meV / A
2025-09-26 02:45:26.597 INFO: Epoch 15: head: target_head, loss=0.01643948, RMSE_E_per_atom=    2.58 meV, RMSE_F=   42.75 meV / A
2025-09-26 02:45:26.600 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-14.pt
2025-09-26 02:45:26.605 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-15.pt
2025-09-26 02:55:43.514 INFO: Epoch 16: head: pt_head, loss=0.04473978, RMSE_E_per_atom=   11.61 meV, RMSE_F=   63.54 meV / A
2025-09-26 02:57:03.801 INFO: Epoch 16: head: target_head, loss=0.01678299, RMSE_E_per_atom=    3.68 meV, RMSE_F=   42.77 meV / A
2025-09-26 03:07:21.722 INFO: Epoch 17: head: pt_head, loss=0.04276233, RMSE_E_per_atom=    9.44 meV, RMSE_F=   63.76 meV / A
2025-09-26 03:08:42.136 INFO: Epoch 17: head: target_head, loss=0.01599581, RMSE_E_per_atom=    1.42 meV, RMSE_F=   42.49 meV / A
2025-09-26 03:08:42.139 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-15.pt
2025-09-26 03:08:42.197 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-17.pt
2025-09-26 03:18:58.558 INFO: Epoch 18: head: pt_head, loss=0.04269159, RMSE_E_per_atom=   10.25 meV, RMSE_F=   63.10 meV / A
2025-09-26 03:20:18.860 INFO: Epoch 18: head: target_head, loss=0.01574537, RMSE_E_per_atom=    1.25 meV, RMSE_F=   42.20 meV / A
2025-09-26 03:20:18.863 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-17.pt
2025-09-26 03:20:18.868 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-18.pt
2025-09-26 03:30:36.273 INFO: Epoch 19: head: pt_head, loss=0.04156119, RMSE_E_per_atom=    9.99 meV, RMSE_F=   62.37 meV / A
2025-09-26 03:31:56.763 INFO: Epoch 19: head: target_head, loss=0.01570903, RMSE_E_per_atom=    1.26 meV, RMSE_F=   42.15 meV / A
2025-09-26 03:31:56.766 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-18.pt
2025-09-26 03:31:56.793 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-19.pt
2025-09-26 03:42:15.032 INFO: Epoch 20: head: pt_head, loss=0.04048240, RMSE_E_per_atom=    9.44 meV, RMSE_F=   61.95 meV / A
2025-09-26 03:43:35.508 INFO: Epoch 20: head: target_head, loss=0.01552244, RMSE_E_per_atom=    0.96 meV, RMSE_F=   41.97 meV / A
2025-09-26 03:43:35.511 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-19.pt
2025-09-26 03:43:35.540 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-20.pt
2025-09-26 03:53:52.383 INFO: Epoch 21: head: pt_head, loss=0.04324705, RMSE_E_per_atom=    9.46 meV, RMSE_F=   64.05 meV / A
2025-09-26 03:55:12.625 INFO: Epoch 21: head: target_head, loss=0.01589614, RMSE_E_per_atom=    1.43 meV, RMSE_F=   42.28 meV / A
2025-09-26 04:05:29.822 INFO: Epoch 22: head: pt_head, loss=0.04061500, RMSE_E_per_atom=   10.89 meV, RMSE_F=   60.87 meV / A
2025-09-26 04:06:50.464 INFO: Epoch 22: head: target_head, loss=0.01540431, RMSE_E_per_atom=    1.00 meV, RMSE_F=   41.80 meV / A
2025-09-26 04:06:50.467 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-20.pt
2025-09-26 04:06:50.547 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-22.pt
2025-09-26 04:17:07.452 INFO: Epoch 23: head: pt_head, loss=0.04082554, RMSE_E_per_atom=   10.87 meV, RMSE_F=   61.07 meV / A
2025-09-26 04:18:27.931 INFO: Epoch 23: head: target_head, loss=0.01527572, RMSE_E_per_atom=    0.82 meV, RMSE_F=   41.66 meV / A
2025-09-26 04:18:27.934 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-22.pt
2025-09-26 04:18:27.955 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-23.pt
2025-09-26 04:28:44.989 INFO: Epoch 24: head: pt_head, loss=0.04489008, RMSE_E_per_atom=   12.53 meV, RMSE_F=   62.72 meV / A
2025-09-26 04:30:05.389 INFO: Epoch 24: head: target_head, loss=0.01530787, RMSE_E_per_atom=    1.69 meV, RMSE_F=   41.54 meV / A
2025-09-26 04:40:22.016 INFO: Epoch 25: head: pt_head, loss=0.04261029, RMSE_E_per_atom=   10.02 meV, RMSE_F=   63.08 meV / A
2025-09-26 04:41:42.671 INFO: Epoch 25: head: target_head, loss=0.01520983, RMSE_E_per_atom=    0.90 meV, RMSE_F=   41.51 meV / A
2025-09-26 04:41:42.674 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-23.pt
2025-09-26 04:41:42.801 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-25.pt
2025-09-26 04:51:59.801 INFO: Epoch 26: head: pt_head, loss=0.04546283, RMSE_E_per_atom=   11.37 meV, RMSE_F=   64.20 meV / A
2025-09-26 04:53:20.216 INFO: Epoch 26: head: target_head, loss=0.01553908, RMSE_E_per_atom=    2.12 meV, RMSE_F=   41.66 meV / A
2025-09-26 05:03:37.289 INFO: Epoch 27: head: pt_head, loss=0.03888675, RMSE_E_per_atom=   10.09 meV, RMSE_F=   60.20 meV / A
2025-09-26 05:04:57.742 INFO: Epoch 27: head: target_head, loss=0.01561801, RMSE_E_per_atom=    3.15 meV, RMSE_F=   41.48 meV / A
2025-09-26 05:15:14.602 INFO: Epoch 28: head: pt_head, loss=0.03932865, RMSE_E_per_atom=    8.92 meV, RMSE_F=   61.38 meV / A
2025-09-26 05:16:35.078 INFO: Epoch 28: head: target_head, loss=0.01554742, RMSE_E_per_atom=    3.66 meV, RMSE_F=   41.16 meV / A
2025-09-26 05:26:52.677 INFO: Epoch 29: head: pt_head, loss=0.04279358, RMSE_E_per_atom=   12.37 meV, RMSE_F=   61.18 meV / A
2025-09-26 05:28:12.979 INFO: Epoch 29: head: target_head, loss=0.01541353, RMSE_E_per_atom=    3.05 meV, RMSE_F=   41.22 meV / A
2025-09-26 05:38:29.656 INFO: Epoch 30: head: pt_head, loss=0.04299053, RMSE_E_per_atom=   10.87 meV, RMSE_F=   62.76 meV / A
2025-09-26 05:39:49.957 INFO: Epoch 30: head: target_head, loss=0.01479329, RMSE_E_per_atom=    1.26 meV, RMSE_F=   40.94 meV / A
2025-09-26 05:39:49.960 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-25.pt
2025-09-26 05:39:50.013 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-30.pt
2025-09-26 05:50:07.023 INFO: Epoch 31: head: pt_head, loss=0.04184034, RMSE_E_per_atom=   10.55 meV, RMSE_F=   62.11 meV / A
2025-09-26 05:51:27.712 INFO: Epoch 31: head: target_head, loss=0.01484868, RMSE_E_per_atom=    1.90 meV, RMSE_F=   40.86 meV / A
2025-09-26 06:01:44.310 INFO: Epoch 32: head: pt_head, loss=0.04229064, RMSE_E_per_atom=   10.83 meV, RMSE_F=   62.21 meV / A
2025-09-26 06:03:04.787 INFO: Epoch 32: head: target_head, loss=0.01463285, RMSE_E_per_atom=    1.23 meV, RMSE_F=   40.72 meV / A
2025-09-26 06:03:04.789 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-30.pt
2025-09-26 06:03:04.859 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-32.pt
2025-09-26 06:13:21.628 INFO: Epoch 33: head: pt_head, loss=0.04073146, RMSE_E_per_atom=    9.77 meV, RMSE_F=   61.86 meV / A
2025-09-26 06:14:42.278 INFO: Epoch 33: head: target_head, loss=0.01455434, RMSE_E_per_atom=    0.95 meV, RMSE_F=   40.65 meV / A
2025-09-26 06:14:42.281 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-32.pt
2025-09-26 06:14:42.293 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-33.pt
2025-09-26 06:24:59.136 INFO: Epoch 34: head: pt_head, loss=0.04173023, RMSE_E_per_atom=    9.60 meV, RMSE_F=   62.81 meV / A
2025-09-26 06:26:19.639 INFO: Epoch 34: head: target_head, loss=0.01452487, RMSE_E_per_atom=    1.40 meV, RMSE_F=   40.54 meV / A
2025-09-26 06:26:19.641 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-33.pt
2025-09-26 06:26:19.646 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-34.pt
2025-09-26 06:36:37.961 INFO: Epoch 35: head: pt_head, loss=0.04291608, RMSE_E_per_atom=   12.51 meV, RMSE_F=   61.14 meV / A
2025-09-26 06:37:58.387 INFO: Epoch 35: head: target_head, loss=0.01444651, RMSE_E_per_atom=    1.25 meV, RMSE_F=   40.47 meV / A
2025-09-26 06:37:58.390 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-34.pt
2025-09-26 06:37:58.436 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-35.pt
2025-09-26 06:48:15.152 INFO: Epoch 36: head: pt_head, loss=0.04089148, RMSE_E_per_atom=    9.99 meV, RMSE_F=   61.78 meV / A
2025-09-26 06:49:35.451 INFO: Epoch 36: head: target_head, loss=0.01436419, RMSE_E_per_atom=    0.84 meV, RMSE_F=   40.40 meV / A
2025-09-26 06:49:35.453 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-35.pt
2025-09-26 06:49:35.471 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-36.pt
2025-09-26 06:59:52.336 INFO: Epoch 37: head: pt_head, loss=0.04534438, RMSE_E_per_atom=   12.52 meV, RMSE_F=   63.02 meV / A
2025-09-26 07:01:12.863 INFO: Epoch 37: head: target_head, loss=0.01445207, RMSE_E_per_atom=    1.05 meV, RMSE_F=   40.49 meV / A
2025-09-26 07:11:30.067 INFO: Epoch 38: head: pt_head, loss=0.04191583, RMSE_E_per_atom=   10.76 meV, RMSE_F=   61.99 meV / A
2025-09-26 07:12:50.493 INFO: Epoch 38: head: target_head, loss=0.01438018, RMSE_E_per_atom=    1.30 meV, RMSE_F=   40.34 meV / A
2025-09-26 07:23:07.363 INFO: Epoch 39: head: pt_head, loss=0.04425708, RMSE_E_per_atom=   12.65 meV, RMSE_F=   62.12 meV / A
2025-09-26 07:24:27.979 INFO: Epoch 39: head: target_head, loss=0.01418972, RMSE_E_per_atom=    0.83 meV, RMSE_F=   40.16 meV / A
2025-09-26 07:24:27.981 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-36.pt
2025-09-26 07:24:28.045 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-39.pt
2025-09-26 07:24:28.148 INFO: Training complete
2025-09-26 07:24:28.148 INFO: 
2025-09-26 07:24:28.148 INFO: ===========RESULTS===========
2025-09-26 07:24:28.194 INFO: Loading checkpoint: ./checkpoints/mace_T2_w3_2heads_final_run-30_epoch-39.pt
2025-09-26 07:24:28.228 INFO: Loaded Stage one model from epoch 39 for evaluation
2025-09-26 07:24:28.229 INFO: Saving model to checkpoints/mace_T2_w3_2heads_final_run-30.model
2025-09-26 07:24:28.459 INFO: Compiling model, saving metadata to mace_T2_w3_2heads_final_compiled.model
2025-09-26 07:24:29.405 INFO: Computing metrics for training, validation, and test sets
2025-09-26 07:24:29.405 INFO: Skipping evaluation for heads: ['pt_head']
2025-09-26 07:24:29.405 INFO: Skipping evaluation of train_pt_head (in skip_heads list)
2025-09-26 07:24:29.405 INFO: Evaluating train_target_head ...
2025-09-26 07:27:17.288 INFO: Skipping evaluation of valid_pt_head (in skip_heads list)
2025-09-26 07:27:17.291 INFO: Evaluating valid_target_head ...
2025-09-26 07:28:37.946 INFO: Error-table on TRAIN and VALID:
+-------------------+---------------------+------------------+-------------------+
|    config_type    | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+-------------------+---------------------+------------------+-------------------+
| train_target_head |            0.8      |         38.1     |         10.99     |
| valid_target_head |            0.8      |         40.2     |         11.69     |
+-------------------+---------------------+------------------+-------------------+
2025-09-26 07:28:37.948 DEBUG: Running inference on train_target_head dataset
2025-09-26 07:31:28.026 DEBUG: Running inference on train_pt_head dataset
2025-09-26 07:31:29.494 DEBUG: Running inference on valid_pt_head dataset
2025-09-26 07:32:50.957 DEBUG: Running inference on valid_target_head dataset
2025-09-26 07:34:48.663 INFO: Done
