2025-07-24 17:44:38.596 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 17:44:38.596 INFO: MACE version: 0.3.13
2025-07-24 18:01:56.777 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 18:01:56.777 INFO: MACE version: 0.3.13
2025-07-24 18:01:57.204 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 18:01:58.109 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 18:01:58.110 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 18:01:58.110 INFO: ===========LOADING INPUT DATA===========
2025-07-24 18:01:58.110 INFO: Using heads: ['Default']
2025-07-24 18:01:58.110 INFO: Using the key specifications to parse data:
2025-07-24 18:01:58.110 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 18:01:58.110 INFO: =============    Processing head Default     ===========
2025-07-24 18:02:19.304 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:02:19.323 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:02:21.907 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:02:21.909 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:02:21.910 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 18:02:22.213 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 18:02:22.213 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 18:02:22.213 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 18:02:22.214 INFO: Processing datasets for head 'Default'
2025-07-24 18:03:45.705 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 18:03:55.177 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 18:03:55.177 INFO: Combined validation datasets for Default
2025-07-24 18:03:55.178 INFO: Head 'Default' training dataset size: 6337
2025-07-24 18:03:55.178 INFO: Computing average number of neighbors
2025-07-24 18:04:01.067 INFO: Average number of neighbors: 68.51643679748439
2025-07-24 18:04:01.068 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 18:04:01.068 INFO: ===========MODEL DETAILS===========
2025-07-24 18:04:06.666 INFO: Loading FOUNDATION model
2025-07-24 18:04:06.667 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 18:04:06.667 INFO: Model configuration extracted from foundation model
2025-07-24 18:04:06.667 INFO: Using universal loss function for fine-tuning
2025-07-24 18:04:06.667 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 18:04:06.667 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 18:04:06.667 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 18:04:06.667 INFO: Distance transform for radial basis functions: None
2025-07-24 18:04:08.108 INFO: Total number of parameters: 894362
2025-07-24 18:04:08.108 INFO: 
2025-07-24 18:04:08.108 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 18:04:08.108 INFO: Using ADAM as parameter optimizer
2025-07-24 18:04:08.108 INFO: Batch size: 4
2025-07-24 18:04:08.108 INFO: Number of gradient updates: 31685
2025-07-24 18:04:08.108 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 18:04:08.108 INFO: WeightedEnergyForcesLoss(energy_weight=2.000, forces_weight=30.000)
2025-07-24 18:04:08.108 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 18:04:08.108 INFO: 
2025-07-24 18:04:08.108 INFO: ===========TRAINING===========
2025-07-24 18:04:08.108 INFO: Started training, reporting errors on validation set
2025-07-24 18:04:08.108 INFO: Loss metrics on validation set
2025-07-24 18:05:23.406 INFO: Initial: head: Default, loss=177962.62937760, RMSE_E_per_atom=298278.68 meV, RMSE_F=  959.54 meV / A
2025-07-24 18:07:00.096 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 18:07:00.096 INFO: MACE version: 0.3.13
2025-07-24 18:07:00.530 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 18:07:01.273 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 18:07:01.274 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 18:07:01.274 INFO: ===========LOADING INPUT DATA===========
2025-07-24 18:07:01.275 INFO: Using heads: ['Default']
2025-07-24 18:07:01.275 INFO: Using the key specifications to parse data:
2025-07-24 18:07:01.275 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 18:07:01.275 INFO: =============    Processing head Default     ===========
2025-07-24 18:07:22.564 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:07:22.582 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:07:22.582 INFO: No validation set provided, splitting training data instead.
2025-07-24 18:07:22.585 INFO: Using random 0% of training set for validation with indices saved in: ./valid_indices_21.txt
2025-07-24 18:07:22.606 INFO: Random Split Training set [energy: 6306, stress: 0, virials: 0, dipole components: 0, head: 6306, forces: 6306, charges: 0]
2025-07-24 18:07:22.606 INFO: Random Split Validation set [energy: 31, stress: 0, virials: 0, dipole components: 0, head: 31, forces: 31, charges: 0]
2025-07-24 18:07:25.256 INFO: Test set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:07:25.258 INFO: Total Test set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:07:25.259 INFO: Total number of configurations: train=6306, valid=31, tests=[Default_Default: 705],
2025-07-24 18:07:25.537 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 18:07:25.537 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 18:07:25.537 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 18:07:25.537 INFO: Processing datasets for head 'Default'
2025-07-24 18:08:24.955 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 18:08:24.955 INFO: MACE version: 0.3.13
2025-07-24 18:08:25.324 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 18:08:25.792 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 18:08:25.793 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 18:08:25.793 INFO: ===========LOADING INPUT DATA===========
2025-07-24 18:08:25.793 INFO: Using heads: ['Default']
2025-07-24 18:08:25.793 INFO: Using the key specifications to parse data:
2025-07-24 18:08:25.793 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 18:08:25.793 INFO: =============    Processing head Default     ===========
2025-07-24 18:08:46.856 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:08:46.874 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:08:46.874 INFO: No validation set provided, splitting training data instead.
2025-07-24 18:08:46.877 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_21.txt
2025-07-24 18:08:46.896 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-24 18:08:46.897 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-24 18:08:49.495 INFO: Test set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:08:49.497 INFO: Total Test set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:08:49.497 INFO: Total number of configurations: train=5704, valid=633, tests=[Default_Default: 705],
2025-07-24 18:08:49.774 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 18:08:49.774 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 18:08:49.775 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 18:08:49.775 INFO: Processing datasets for head 'Default'
2025-07-24 18:10:04.905 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 18:10:13.262 INFO: Head 'Default' training dataset size: 5704
2025-07-24 18:10:13.263 INFO: Computing average number of neighbors
2025-07-24 18:10:19.174 INFO: Average number of neighbors: 68.57508377733204
2025-07-24 18:10:19.177 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 18:10:19.177 INFO: ===========MODEL DETAILS===========
2025-07-24 18:10:24.779 INFO: Loading FOUNDATION model
2025-07-24 18:10:24.780 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 18:10:24.781 INFO: Model configuration extracted from foundation model
2025-07-24 18:10:24.781 INFO: Using universal loss function for fine-tuning
2025-07-24 18:10:24.781 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 18:10:24.781 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 18:10:24.781 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 18:10:24.781 INFO: Distance transform for radial basis functions: None
2025-07-24 18:10:26.222 INFO: Total number of parameters: 894362
2025-07-24 18:10:26.222 INFO: 
2025-07-24 18:10:26.222 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 18:10:26.222 INFO: Using ADAM as parameter optimizer
2025-07-24 18:10:26.222 INFO: Batch size: 3
2025-07-24 18:10:26.222 INFO: Number of gradient updates: 38026
2025-07-24 18:10:26.222 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 18:10:26.222 INFO: WeightedEnergyForcesLoss(energy_weight=2.000, forces_weight=30.000)
2025-07-24 18:10:26.222 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 18:10:26.222 INFO: 
2025-07-24 18:10:26.222 INFO: ===========TRAINING===========
2025-07-24 18:10:26.222 INFO: Started training, reporting errors on validation set
2025-07-24 18:10:26.222 INFO: Loss metrics on validation set
2025-07-24 18:11:33.320 INFO: Initial: head: Default, loss=177904.46583276, RMSE_E_per_atom=298228.58 meV, RMSE_F=  993.16 meV / A
2025-07-24 18:29:02.959 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 18:29:02.959 INFO: MACE version: 0.3.13
2025-07-24 18:29:03.370 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 18:29:04.370 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 18:29:04.371 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 18:29:04.371 INFO: ===========LOADING INPUT DATA===========
2025-07-24 18:29:04.371 INFO: Using heads: ['Default']
2025-07-24 18:29:04.371 INFO: Using the key specifications to parse data:
2025-07-24 18:29:04.371 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 18:29:04.371 INFO: =============    Processing head Default     ===========
2025-07-24 18:29:25.520 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:29:25.538 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 18:29:25.538 INFO: No validation set provided, splitting training data instead.
2025-07-24 18:29:25.542 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_21.txt
2025-07-24 18:29:25.560 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-24 18:29:25.562 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-24 18:29:28.178 INFO: Test set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:29:28.180 INFO: Total Test set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 18:29:28.181 INFO: Total number of configurations: train=5704, valid=633, tests=[Default_Default: 705],
2025-07-24 18:29:28.457 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 18:29:28.458 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 18:29:28.458 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 18:29:28.458 INFO: Processing datasets for head 'Default'
2025-07-24 18:30:43.522 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 18:30:51.871 INFO: Head 'Default' training dataset size: 5704
2025-07-24 18:30:51.872 INFO: Computing average number of neighbors
2025-07-24 18:30:58.852 INFO: Average number of neighbors: 68.57256424840027
2025-07-24 18:30:58.853 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 18:30:58.853 INFO: ===========MODEL DETAILS===========
2025-07-24 18:31:05.219 INFO: Loading FOUNDATION model
2025-07-24 18:31:05.221 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 18:31:05.221 INFO: Model configuration extracted from foundation model
2025-07-24 18:31:05.221 INFO: Using universal loss function for fine-tuning
2025-07-24 18:31:05.221 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 18:31:05.221 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 18:31:05.221 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 18:31:05.221 INFO: Distance transform for radial basis functions: None
2025-07-24 18:31:06.725 INFO: Total number of parameters: 894362
2025-07-24 18:31:06.725 INFO: 
2025-07-24 18:31:06.725 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 18:31:06.725 INFO: Using ADAM as parameter optimizer
2025-07-24 18:31:06.725 INFO: Batch size: 2
2025-07-24 18:31:06.725 INFO: Number of gradient updates: 57040
2025-07-24 18:31:06.725 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 18:31:06.725 INFO: WeightedEnergyForcesLoss(energy_weight=2.000, forces_weight=30.000)
2025-07-24 18:31:06.725 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 18:31:06.725 INFO: 
2025-07-24 18:31:06.725 INFO: ===========TRAINING===========
2025-07-24 18:31:06.725 INFO: Started training, reporting errors on validation set
2025-07-24 18:31:06.725 INFO: Loss metrics on validation set
2025-07-24 18:32:13.732 INFO: Initial: head: Default, loss=177904.46583276, RMSE_E_per_atom=298228.58 meV, RMSE_F=  993.16 meV / A
2025-07-24 19:01:06.971 INFO: Epoch 0: head: Default, loss=22.75310396, RMSE_E_per_atom= 3336.64 meV, RMSE_F=  132.32 meV / A
2025-07-24 19:29:58.736 INFO: Epoch 1: head: Default, loss=15.78469594, RMSE_E_per_atom= 2748.71 meV, RMSE_F=  154.40 meV / A
2025-07-24 19:58:48.941 INFO: Epoch 2: head: Default, loss=9.41112610, RMSE_E_per_atom= 2144.44 meV, RMSE_F=   87.83 meV / A
2025-07-24 20:27:38.718 INFO: Epoch 3: head: Default, loss=0.97845528, RMSE_E_per_atom=  626.26 meV, RMSE_F=   84.10 meV / A
2025-07-24 20:56:28.997 INFO: Epoch 4: head: Default, loss=7.50060044, RMSE_E_per_atom= 1918.87 meV, RMSE_F=   70.91 meV / A
2025-07-24 21:25:19.382 INFO: Epoch 5: head: Default, loss=9.05802213, RMSE_E_per_atom= 2113.13 meV, RMSE_F=   68.14 meV / A
2025-07-24 21:30:51.277 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 21:30:51.277 INFO: MACE version: 0.3.13
2025-07-24 21:30:51.750 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 21:30:52.664 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 21:30:52.665 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 21:30:52.665 INFO: ===========LOADING INPUT DATA===========
2025-07-24 21:30:52.665 INFO: Using heads: ['Default']
2025-07-24 21:30:52.665 INFO: Using the key specifications to parse data:
2025-07-24 21:30:52.665 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 21:30:52.665 INFO: =============    Processing head Default     ===========
2025-07-24 21:31:13.767 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 21:31:13.785 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-24 21:31:13.785 INFO: No validation set provided, splitting training data instead.
2025-07-24 21:31:13.788 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_21.txt
2025-07-24 21:31:13.806 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-24 21:31:13.808 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-24 21:31:16.406 INFO: Test set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 21:31:16.408 INFO: Total Test set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-24 21:31:16.408 INFO: Total number of configurations: train=5704, valid=633, tests=[Default_Default: 705],
2025-07-24 21:31:16.685 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 21:31:16.685 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 21:31:16.686 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 21:31:16.686 INFO: Processing datasets for head 'Default'
2025-07-24 21:32:31.869 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 21:32:40.231 INFO: Head 'Default' training dataset size: 5704
2025-07-24 21:32:40.232 INFO: Computing average number of neighbors
2025-07-24 21:32:47.093 INFO: Average number of neighbors: 68.57256424840027
2025-07-24 21:32:47.094 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 21:32:47.094 INFO: ===========MODEL DETAILS===========
2025-07-24 21:32:53.500 INFO: Loading FOUNDATION model
2025-07-24 21:32:53.502 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 21:32:53.502 INFO: Model configuration extracted from foundation model
2025-07-24 21:32:53.502 INFO: Using universal loss function for fine-tuning
2025-07-24 21:32:53.502 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 21:32:53.502 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 21:32:53.502 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 21:32:53.502 INFO: Distance transform for radial basis functions: None
2025-07-24 21:32:54.883 INFO: Total number of parameters: 894362
2025-07-24 21:32:54.883 INFO: 
2025-07-24 21:32:54.883 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 21:32:54.883 INFO: Using ADAM as parameter optimizer
2025-07-24 21:32:54.883 INFO: Batch size: 2
2025-07-24 21:32:54.883 INFO: Number of gradient updates: 57040
2025-07-24 21:32:54.883 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 21:32:54.883 INFO: WeightedEnergyForcesLoss(energy_weight=20.000, forces_weight=30.000)
2025-07-24 21:32:54.915 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-24 21:32:54.916 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-3.pt
2025-07-24 21:32:54.960 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 21:32:54.960 INFO: 
2025-07-24 21:32:54.960 INFO: ===========TRAINING===========
2025-07-24 21:32:54.960 INFO: Started training, reporting errors on validation set
2025-07-24 21:32:54.960 INFO: Loss metrics on validation set
2025-07-24 21:34:02.109 INFO: Initial: head: Default, loss=8.03816657, RMSE_E_per_atom=  626.26 meV, RMSE_F=   84.10 meV / A
2025-07-24 22:02:56.006 INFO: Epoch 3: head: Default, loss=67.64907186, RMSE_E_per_atom= 1836.15 meV, RMSE_F=   88.12 meV / A
2025-07-24 22:31:47.776 INFO: Epoch 4: head: Default, loss=19.77394735, RMSE_E_per_atom=  986.44 meV, RMSE_F=  104.62 meV / A
2025-07-24 23:00:38.774 INFO: Epoch 5: head: Default, loss=31.87472669, RMSE_E_per_atom= 1258.15 meV, RMSE_F=   89.16 meV / A
2025-07-24 23:29:30.344 INFO: Epoch 6: head: Default, loss=101.41920667, RMSE_E_per_atom= 2250.05 meV, RMSE_F=   77.05 meV / A
2025-07-24 23:58:19.783 INFO: Epoch 7: head: Default, loss=112.49476836, RMSE_E_per_atom= 2369.18 meV, RMSE_F=   91.42 meV / A
2025-07-25 00:06:17.798 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 00:06:17.798 INFO: MACE version: 0.3.13
2025-07-25 00:06:18.182 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 00:06:18.898 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 00:06:18.900 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 00:06:18.900 INFO: ===========LOADING INPUT DATA===========
2025-07-25 00:06:18.900 INFO: Using heads: ['Default']
2025-07-25 00:06:18.900 INFO: Using the key specifications to parse data:
2025-07-25 00:06:18.900 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 00:06:18.900 INFO: =============    Processing head Default     ===========
2025-07-25 00:06:40.053 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 00:06:40.073 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 00:06:42.657 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 00:06:42.659 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 00:06:42.659 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 00:06:42.954 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 00:06:42.955 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 00:06:42.955 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-25 00:06:42.955 INFO: Processing datasets for head 'Default'
2025-07-25 00:08:06.249 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 00:08:15.726 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 00:08:15.727 INFO: Combined validation datasets for Default
2025-07-25 00:08:15.727 INFO: Head 'Default' training dataset size: 6337
2025-07-25 00:08:15.727 INFO: Computing average number of neighbors
2025-07-25 00:08:23.417 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 00:08:23.418 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 00:08:23.418 INFO: ===========MODEL DETAILS===========
2025-07-25 00:08:30.396 INFO: Loading FOUNDATION model
2025-07-25 00:08:30.397 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 00:08:30.397 INFO: Model configuration extracted from foundation model
2025-07-25 00:08:30.397 INFO: Using universal loss function for fine-tuning
2025-07-25 00:08:30.397 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 00:08:30.397 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 00:08:30.397 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 00:08:30.397 INFO: Distance transform for radial basis functions: None
2025-07-25 00:08:31.806 INFO: Total number of parameters: 894362
2025-07-25 00:08:31.806 INFO: 
2025-07-25 00:08:31.806 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 00:08:31.806 INFO: Using ADAM as parameter optimizer
2025-07-25 00:08:31.806 INFO: Batch size: 2
2025-07-25 00:08:31.806 INFO: Number of gradient updates: 63370
2025-07-25 00:08:31.806 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-25 00:08:31.806 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=30.000)
2025-07-25 00:08:31.852 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 00:08:31.853 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-4.pt
2025-07-25 00:08:31.892 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 00:08:31.892 INFO: 
2025-07-25 00:08:31.892 INFO: ===========TRAINING===========
2025-07-25 00:08:31.892 INFO: Started training, reporting errors on validation set
2025-07-25 00:08:31.892 INFO: Loss metrics on validation set
2025-07-25 00:09:47.266 INFO: Initial: head: Default, loss=96.68076902, RMSE_E_per_atom=  981.68 meV, RMSE_F=  104.85 meV / A
2025-07-25 00:41:50.552 INFO: Epoch 4: head: Default, loss=358.89933533, RMSE_E_per_atom= 1893.56 meV, RMSE_F=  109.91 meV / A
2025-07-25 01:13:51.480 INFO: Epoch 5: head: Default, loss=315.58880068, RMSE_E_per_atom= 1775.83 meV, RMSE_F=   91.00 meV / A
2025-07-25 01:45:53.731 INFO: Epoch 6: head: Default, loss=1204.11132109, RMSE_E_per_atom= 3469.27 meV, RMSE_F=  134.78 meV / A
2025-07-25 02:06:00.749 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 02:06:00.749 INFO: MACE version: 0.3.13
2025-07-25 02:06:01.165 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 02:06:01.630 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 02:06:01.631 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 02:06:01.631 INFO: ===========LOADING INPUT DATA===========
2025-07-25 02:06:01.631 INFO: Using heads: ['Default']
2025-07-25 02:06:01.631 INFO: Using the key specifications to parse data:
2025-07-25 02:06:01.631 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 02:06:01.631 INFO: =============    Processing head Default     ===========
2025-07-25 02:06:22.770 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:06:22.788 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:06:25.434 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:06:25.436 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:06:25.437 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 02:06:25.741 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 02:06:25.741 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 02:06:25.741 INFO: Atomic Energies used (z: eV) for head Default: {3: -3.4821, 8: -7.2846, 40: -11.847, 57: -15.283}
2025-07-25 02:06:25.741 INFO: Processing datasets for head 'Default'
2025-07-25 02:07:49.316 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 02:07:58.823 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 02:07:58.824 INFO: Combined validation datasets for Default
2025-07-25 02:07:58.824 INFO: Head 'Default' training dataset size: 6337
2025-07-25 02:07:58.824 INFO: Computing average number of neighbors
2025-07-25 02:08:06.478 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 02:08:06.479 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 02:08:06.479 INFO: ===========MODEL DETAILS===========
2025-07-25 02:08:13.673 INFO: Loading FOUNDATION model
2025-07-25 02:08:13.675 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 02:08:13.675 INFO: Model configuration extracted from foundation model
2025-07-25 02:08:13.675 INFO: Using universal loss function for fine-tuning
2025-07-25 02:08:13.675 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 02:08:13.675 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 02:08:13.675 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 02:08:13.675 INFO: Distance transform for radial basis functions: None
2025-07-25 02:08:15.049 INFO: Total number of parameters: 894362
2025-07-25 02:08:15.049 INFO: 
2025-07-25 02:08:15.049 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 02:08:15.049 INFO: Using ADAM as parameter optimizer
2025-07-25 02:08:15.049 INFO: Batch size: 2
2025-07-25 02:08:15.049 INFO: Number of gradient updates: 63370
2025-07-25 02:08:15.049 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-25 02:08:15.049 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=30.000)
2025-07-25 02:08:15.049 INFO: Converting model to CUEQ for accelerated training
2025-07-25 02:08:15.127 INFO: Creating new model with cuequivariance settings
2025-07-25 02:09:42.136 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 02:09:42.136 INFO: MACE version: 0.3.13
2025-07-25 02:09:42.494 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 02:09:42.973 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 02:09:42.974 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 02:09:42.974 INFO: ===========LOADING INPUT DATA===========
2025-07-25 02:09:42.974 INFO: Using heads: ['Default']
2025-07-25 02:09:42.974 INFO: Using the key specifications to parse data:
2025-07-25 02:09:42.974 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 02:09:42.974 INFO: =============    Processing head Default     ===========
2025-07-25 02:10:04.116 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:10:04.134 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:10:06.743 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:10:06.745 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:10:06.745 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 02:10:07.049 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 02:10:07.049 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 02:10:07.050 INFO: Atomic Energies used (z: eV) for head Default: {3: -3.4821, 8: -7.2846, 40: -11.847, 57: -15.283}
2025-07-25 02:10:07.050 INFO: Processing datasets for head 'Default'
2025-07-25 02:11:30.935 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 02:11:40.522 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 02:11:40.523 INFO: Combined validation datasets for Default
2025-07-25 02:11:40.523 INFO: Head 'Default' training dataset size: 6337
2025-07-25 02:11:40.523 INFO: Computing average number of neighbors
2025-07-25 02:11:48.634 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 02:11:48.635 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 02:11:48.635 INFO: ===========MODEL DETAILS===========
2025-07-25 02:11:56.911 INFO: Loading FOUNDATION model
2025-07-25 02:11:56.913 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 02:11:56.913 INFO: Model configuration extracted from foundation model
2025-07-25 02:11:56.913 INFO: Using universal loss function for fine-tuning
2025-07-25 02:11:56.913 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 02:11:56.913 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 02:11:56.913 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 02:11:56.913 INFO: Distance transform for radial basis functions: None
2025-07-25 02:11:58.321 INFO: Total number of parameters: 894362
2025-07-25 02:11:58.321 INFO: 
2025-07-25 02:11:58.321 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 02:11:58.321 INFO: Using ADAM as parameter optimizer
2025-07-25 02:11:58.321 INFO: Batch size: 2
2025-07-25 02:11:58.322 INFO: Number of gradient updates: 63370
2025-07-25 02:11:58.322 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-25 02:11:58.322 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=30.000)
2025-07-25 02:11:58.361 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 02:11:58.361 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-5.pt
2025-07-25 02:11:58.402 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 02:11:58.402 INFO: 
2025-07-25 02:11:58.402 INFO: ===========TRAINING===========
2025-07-25 02:11:58.402 INFO: Started training, reporting errors on validation set
2025-07-25 02:11:58.402 INFO: Loss metrics on validation set
2025-07-25 02:13:13.693 INFO: Initial: head: Default, loss=315.58880068, RMSE_E_per_atom= 1775.83 meV, RMSE_F=   91.00 meV / A
2025-07-25 02:45:17.363 INFO: Epoch 5: head: Default, loss=45.75293212, RMSE_E_per_atom=  674.72 meV, RMSE_F=   90.67 meV / A
2025-07-25 03:17:18.024 INFO: Epoch 6: head: Default, loss=1943.86553851, RMSE_E_per_atom= 4408.64 meV, RMSE_F=   95.97 meV / A
2025-07-25 03:49:19.416 INFO: Epoch 7: head: Default, loss=14.19357672, RMSE_E_per_atom=  373.39 meV, RMSE_F=   95.31 meV / A
2025-07-25 04:21:21.157 INFO: Epoch 8: head: Default, loss=684.57926813, RMSE_E_per_atom= 2616.00 meV, RMSE_F=   91.54 meV / A
2025-07-25 04:53:21.821 INFO: Epoch 9: head: Default, loss=16.56730160, RMSE_E_per_atom=  404.20 meV, RMSE_F=   90.98 meV / A
2025-07-25 05:25:22.343 INFO: Epoch 10: head: Default, loss=85.38392612, RMSE_E_per_atom=  922.54 meV, RMSE_F=  100.17 meV / A
2025-07-25 05:57:23.350 INFO: Epoch 11: head: Default, loss=20.78567956, RMSE_E_per_atom=  453.15 meV, RMSE_F=   94.76 meV / A
2025-07-25 06:29:23.944 INFO: Epoch 12: head: Default, loss=49.65361471, RMSE_E_per_atom=  703.07 meV, RMSE_F=   89.90 meV / A
2025-07-25 07:01:25.032 INFO: Epoch 13: head: Default, loss=68.66261242, RMSE_E_per_atom=  827.37 meV, RMSE_F=   86.70 meV / A
2025-07-25 07:33:26.098 INFO: Epoch 14: head: Default, loss=38.65113139, RMSE_E_per_atom=  619.53 meV, RMSE_F=   99.57 meV / A
2025-07-25 08:05:26.868 INFO: Epoch 15: head: Default, loss=368.71784180, RMSE_E_per_atom= 1919.60 meV, RMSE_F=   91.53 meV / A
2025-07-25 08:37:27.935 INFO: Epoch 16: head: Default, loss=25.58492364, RMSE_E_per_atom=  503.44 meV, RMSE_F=   92.72 meV / A
2025-07-25 09:04:23.572 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 09:04:23.572 INFO: MACE version: 0.3.13
2025-07-25 09:04:24.210 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 09:04:24.648 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 09:04:24.649 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 09:04:24.650 INFO: ===========LOADING INPUT DATA===========
2025-07-25 09:04:24.650 INFO: Using heads: ['Default']
2025-07-25 09:04:24.650 INFO: Using the key specifications to parse data:
2025-07-25 09:04:24.650 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 09:04:24.650 INFO: =============    Processing head Default     ===========
2025-07-25 09:04:45.696 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 09:04:45.713 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 09:04:48.309 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 09:04:48.311 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 09:04:48.311 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 09:04:48.605 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 09:04:48.605 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 09:04:48.605 INFO: Computing average Atomic Energies using least squares regression
2025-07-25 09:04:48.646 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 09:04:48.646 INFO: Processing datasets for head 'Default'
2025-07-25 09:06:12.194 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 09:06:21.661 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 09:06:21.661 INFO: Combined validation datasets for Default
2025-07-25 09:06:21.661 INFO: Head 'Default' training dataset size: 6337
2025-07-25 09:06:21.662 INFO: Computing average number of neighbors
2025-07-25 09:06:29.178 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 09:06:29.180 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 09:06:29.180 INFO: ===========MODEL DETAILS===========
2025-07-25 09:06:36.362 INFO: Loading FOUNDATION model
2025-07-25 09:06:36.363 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 09:06:36.363 INFO: Model configuration extracted from foundation model
2025-07-25 09:06:36.363 INFO: Using universal loss function for fine-tuning
2025-07-25 09:06:36.363 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 09:06:36.363 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 09:06:36.363 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 09:06:36.363 INFO: Distance transform for radial basis functions: None
2025-07-25 09:06:37.825 INFO: Total number of parameters: 894362
2025-07-25 09:06:37.825 INFO: 
2025-07-25 09:06:37.825 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 09:06:37.825 INFO: Using ADAM as parameter optimizer
2025-07-25 09:06:37.825 INFO: Batch size: 2
2025-07-25 09:06:37.825 INFO: Number of gradient updates: 63370
2025-07-25 09:06:37.825 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-25 09:06:37.825 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=30.000)
2025-07-25 09:06:37.828 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 09:06:37.829 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-7.pt
2025-07-25 09:06:37.870 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 09:06:37.870 INFO: 
2025-07-25 09:06:37.870 INFO: ===========TRAINING===========
2025-07-25 09:06:37.870 INFO: Started training, reporting errors on validation set
2025-07-25 09:06:37.870 INFO: Loss metrics on validation set
2025-07-25 09:07:52.918 INFO: Initial: head: Default, loss=14.19357672, RMSE_E_per_atom=  373.39 meV, RMSE_F=   95.31 meV / A
2025-07-25 09:23:28.628 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 09:23:28.628 INFO: MACE version: 0.3.13
2025-07-25 09:23:29.406 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 09:23:29.931 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 09:23:29.933 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 09:23:29.933 INFO: ===========LOADING INPUT DATA===========
2025-07-25 09:23:29.933 INFO: Using heads: ['Default']
2025-07-25 09:23:29.933 INFO: Using the key specifications to parse data:
2025-07-25 09:23:29.933 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 09:23:29.933 INFO: =============    Processing head Default     ===========
2025-07-25 09:23:50.901 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 09:23:50.918 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 09:23:53.514 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 09:23:53.516 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 09:23:53.516 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 09:23:53.821 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 09:23:53.821 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 09:23:53.821 INFO: Computing average Atomic Energies using least squares regression
2025-07-25 09:23:53.862 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 09:23:53.862 INFO: Processing datasets for head 'Default'
2025-07-25 09:25:17.053 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 09:25:26.524 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 09:25:26.524 INFO: Combined validation datasets for Default
2025-07-25 09:25:26.524 INFO: Head 'Default' training dataset size: 6337
2025-07-25 09:25:26.524 INFO: Computing average number of neighbors
2025-07-25 09:25:34.864 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 09:25:34.865 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 09:25:34.865 INFO: ===========MODEL DETAILS===========
2025-07-25 09:25:41.719 INFO: Loading FOUNDATION model
2025-07-25 09:25:41.721 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 09:25:41.721 INFO: Model configuration extracted from foundation model
2025-07-25 09:25:41.721 INFO: Using universal loss function for fine-tuning
2025-07-25 09:25:41.721 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 09:25:41.721 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 09:25:41.721 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 09:25:41.721 INFO: Distance transform for radial basis functions: None
2025-07-25 09:25:43.096 INFO: Total number of parameters: 894362
2025-07-25 09:25:43.096 INFO: 
2025-07-25 09:25:43.096 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 09:25:43.096 INFO: Using ADAM as parameter optimizer
2025-07-25 09:25:43.097 INFO: Batch size: 2
2025-07-25 09:25:43.097 INFO: Number of gradient updates: 63370
2025-07-25 09:25:43.097 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-25 09:25:43.097 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=30.000)
2025-07-25 09:25:43.100 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 09:25:43.100 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-7.pt
2025-07-25 09:25:43.149 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 09:25:43.149 INFO: 
2025-07-25 09:25:43.149 INFO: ===========TRAINING===========
2025-07-25 09:25:43.149 INFO: Started training, reporting errors on validation set
2025-07-25 09:25:43.149 INFO: Loss metrics on validation set
2025-07-25 09:26:58.064 INFO: Initial: head: Default, loss=14.19357672, RMSE_E_per_atom=  373.39 meV, RMSE_F=   95.31 meV / A
2025-07-25 09:58:59.874 INFO: Epoch 7: head: Default, loss=79.54230041, RMSE_E_per_atom=  890.59 meV, RMSE_F=   90.53 meV / A
2025-07-25 10:30:59.315 INFO: Epoch 8: head: Default, loss=752.82211118, RMSE_E_per_atom= 2743.30 meV, RMSE_F=   94.61 meV / A
2025-07-25 11:02:59.117 INFO: Epoch 9: head: Default, loss=79.94503184, RMSE_E_per_atom=  892.69 meV, RMSE_F=   95.82 meV / A
2025-07-25 11:34:58.708 INFO: Epoch 10: head: Default, loss=30.89173708, RMSE_E_per_atom=  553.93 meV, RMSE_F=   86.47 meV / A
2025-07-25 11:44:00.061 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 11:44:00.061 INFO: MACE version: 0.3.13
2025-07-25 11:44:00.652 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 11:44:01.122 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 11:44:01.123 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 11:44:01.123 INFO: ===========LOADING INPUT DATA===========
2025-07-25 11:44:01.123 INFO: Using heads: ['Default']
2025-07-25 11:44:01.123 INFO: Using the key specifications to parse data:
2025-07-25 11:44:01.123 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 11:44:01.123 INFO: =============    Processing head Default     ===========
2025-07-25 11:44:22.152 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 11:44:22.169 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 11:44:24.836 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 11:44:24.838 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 11:44:24.839 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 11:44:25.142 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 11:44:25.142 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 11:44:25.142 INFO: Computing average Atomic Energies using least squares regression
2025-07-25 11:44:25.182 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 11:44:25.182 INFO: Processing datasets for head 'Default'
2025-07-25 11:45:48.673 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 11:45:58.160 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 11:45:58.160 INFO: Combined validation datasets for Default
2025-07-25 11:45:58.160 INFO: Head 'Default' training dataset size: 6337
2025-07-25 11:45:58.161 INFO: Computing average number of neighbors
2025-07-25 11:46:05.924 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 11:46:05.925 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 11:46:05.926 INFO: ===========MODEL DETAILS===========
2025-07-25 11:46:12.751 INFO: Loading FOUNDATION model
2025-07-25 11:46:12.752 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 11:46:12.752 INFO: Model configuration extracted from foundation model
2025-07-25 11:46:12.752 INFO: Using universal loss function for fine-tuning
2025-07-25 11:46:12.752 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 11:46:12.752 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 11:46:12.752 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 11:46:12.753 INFO: Distance transform for radial basis functions: None
2025-07-25 11:46:14.166 INFO: Total number of parameters: 894362
2025-07-25 11:46:14.166 INFO: 
2025-07-25 11:46:14.166 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 11:46:14.166 INFO: Using ADAM as parameter optimizer
2025-07-25 11:46:14.166 INFO: Batch size: 2
2025-07-25 11:46:14.166 INFO: Number of gradient updates: 63370
2025-07-25 11:46:14.166 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-25 11:46:14.166 INFO: WeightedEnergyForcesLoss(energy_weight=50.000, forces_weight=30.000)
2025-07-25 11:46:14.170 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 11:46:14.171 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-10.pt
2025-07-25 11:46:14.211 INFO: Using gradient clipping with tolerance=100.000
2025-07-25 11:46:14.211 INFO: 
2025-07-25 11:46:14.211 INFO: ===========TRAINING===========
2025-07-25 11:46:14.211 INFO: Started training, reporting errors on validation set
2025-07-25 11:46:14.211 INFO: Loss metrics on validation set
2025-07-25 11:47:29.255 INFO: Initial: head: Default, loss=15.54960762, RMSE_E_per_atom=  553.93 meV, RMSE_F=   86.47 meV / A
2025-07-25 12:19:33.684 INFO: Epoch 10: head: Default, loss=1.98475069, RMSE_E_per_atom=  190.91 meV, RMSE_F=   76.92 meV / A
2025-07-25 12:51:35.538 INFO: Epoch 11: head: Default, loss=2.59960673, RMSE_E_per_atom=  221.79 meV, RMSE_F=   71.41 meV / A
2025-07-25 13:23:37.706 INFO: Epoch 12: head: Default, loss=6.95239674, RMSE_E_per_atom=  369.47 meV, RMSE_F=   68.17 meV / A
2025-07-25 13:51:42.855 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 13:51:42.855 INFO: MACE version: 0.3.13
2025-07-25 13:51:43.575 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 13:51:44.449 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 13:51:44.450 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 13:51:44.450 INFO: ===========LOADING INPUT DATA===========
2025-07-25 13:51:44.450 INFO: Using heads: ['Default']
2025-07-25 13:51:44.450 INFO: Using the key specifications to parse data:
2025-07-25 13:51:44.451 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 13:51:44.451 INFO: =============    Processing head Default     ===========
2025-07-25 13:52:05.545 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 13:52:05.562 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 13:52:08.191 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 13:52:08.192 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 13:52:08.193 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 13:52:08.496 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 13:52:08.496 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 13:52:08.497 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 13:52:08.497 INFO: Processing datasets for head 'Default'
2025-07-25 13:53:32.087 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 13:53:41.611 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 13:53:41.611 INFO: Combined validation datasets for Default
2025-07-25 13:53:41.611 INFO: Head 'Default' training dataset size: 6337
2025-07-25 13:53:41.612 INFO: Computing average number of neighbors
2025-07-25 13:53:50.064 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 13:53:50.066 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 13:53:50.066 INFO: ===========MODEL DETAILS===========
2025-07-25 13:53:57.186 INFO: Loading FOUNDATION model
2025-07-25 13:53:57.187 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 13:53:57.187 INFO: Model configuration extracted from foundation model
2025-07-25 13:53:57.187 INFO: Using universal loss function for fine-tuning
2025-07-25 13:53:57.187 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 13:53:57.187 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 13:53:57.187 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 13:53:57.188 INFO: Distance transform for radial basis functions: None
2025-07-25 13:53:58.623 INFO: Total number of parameters: 894362
2025-07-25 13:53:58.623 INFO: 
2025-07-25 13:53:58.624 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 13:53:58.624 INFO: Using ADAM as parameter optimizer
2025-07-25 13:53:58.624 INFO: Batch size: 2
2025-07-25 13:53:58.624 INFO: Number of gradient updates: 63370
2025-07-25 13:53:58.624 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 13:53:58.624 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=20.000)
2025-07-25 13:53:58.639 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 13:53:58.639 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-10.pt
2025-07-25 13:53:58.679 INFO: Using gradient clipping with tolerance=50.000
2025-07-25 13:53:58.680 INFO: 
2025-07-25 13:53:58.680 INFO: ===========TRAINING===========
2025-07-25 13:53:58.680 INFO: Started training, reporting errors on validation set
2025-07-25 13:53:58.680 INFO: Loss metrics on validation set
2025-07-25 13:55:13.798 INFO: Initial: head: Default, loss=3.75295525, RMSE_E_per_atom=  190.91 meV, RMSE_F=   76.92 meV / A
2025-07-25 14:03:01.233 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 14:03:01.233 INFO: MACE version: 0.3.13
2025-07-25 14:03:01.939 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 14:03:02.375 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 14:03:02.378 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 14:03:02.379 INFO: ===========LOADING INPUT DATA===========
2025-07-25 14:03:02.379 INFO: Using heads: ['Default']
2025-07-25 14:03:02.379 INFO: Using the key specifications to parse data:
2025-07-25 14:03:02.379 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 14:03:02.379 INFO: =============    Processing head Default     ===========
2025-07-25 14:03:23.386 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 14:03:23.404 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 14:03:25.979 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 14:03:25.981 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 14:03:25.981 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 14:03:26.284 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 14:03:26.284 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 14:03:26.284 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 14:03:26.284 INFO: Processing datasets for head 'Default'
2025-07-25 14:04:49.222 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 14:04:58.643 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 14:04:58.644 INFO: Combined validation datasets for Default
2025-07-25 14:04:58.644 INFO: Head 'Default' training dataset size: 6337
2025-07-25 14:04:58.644 INFO: Computing average number of neighbors
2025-07-25 14:05:06.178 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 14:05:06.180 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 14:05:06.180 INFO: ===========MODEL DETAILS===========
2025-07-25 14:05:13.457 INFO: Loading FOUNDATION model
2025-07-25 14:05:13.458 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 14:05:13.458 INFO: Model configuration extracted from foundation model
2025-07-25 14:05:13.458 INFO: Using universal loss function for fine-tuning
2025-07-25 14:05:13.458 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 14:05:13.458 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 14:05:13.458 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 14:05:13.458 INFO: Distance transform for radial basis functions: None
2025-07-25 14:05:14.952 INFO: Total number of parameters: 894362
2025-07-25 14:05:14.952 INFO: 
2025-07-25 14:05:14.952 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 14:05:14.952 INFO: Using ADAM as parameter optimizer
2025-07-25 14:05:14.952 INFO: Batch size: 2
2025-07-25 14:05:14.952 INFO: Number of gradient updates: 63370
2025-07-25 14:05:14.952 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 14:05:14.952 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=20.000)
2025-07-25 14:05:14.954 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 14:05:14.955 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-10.pt
2025-07-25 14:05:14.995 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 14:05:14.995 INFO: 
2025-07-25 14:05:14.995 INFO: ===========TRAINING===========
2025-07-25 14:05:14.995 INFO: Started training, reporting errors on validation set
2025-07-25 14:05:14.995 INFO: Loss metrics on validation set
2025-07-25 14:06:30.290 INFO: Initial: head: Default, loss=3.75295525, RMSE_E_per_atom=  190.91 meV, RMSE_F=   76.92 meV / A
2025-07-25 14:38:36.468 INFO: Epoch 10: head: Default, loss=0.23021270, RMSE_E_per_atom=   36.14 meV, RMSE_F=   73.75 meV / A
2025-07-25 15:10:38.106 INFO: Epoch 11: head: Default, loss=0.11833722, RMSE_E_per_atom=   15.70 meV, RMSE_F=   71.59 meV / A
2025-07-25 15:42:40.814 INFO: Epoch 12: head: Default, loss=0.09542112, RMSE_E_per_atom=    7.87 meV, RMSE_F=   69.90 meV / A
2025-07-25 16:14:43.063 INFO: Epoch 13: head: Default, loss=0.08778562, RMSE_E_per_atom=    4.17 meV, RMSE_F=   68.66 meV / A
2025-07-25 16:46:44.360 INFO: Epoch 14: head: Default, loss=0.12805158, RMSE_E_per_atom=   21.27 meV, RMSE_F=   67.40 meV / A
2025-07-25 17:18:45.570 INFO: Epoch 15: head: Default, loss=0.12677571, RMSE_E_per_atom=   21.56 meV, RMSE_F=   66.41 meV / A
2025-07-25 17:50:47.745 INFO: Epoch 16: head: Default, loss=0.15568914, RMSE_E_per_atom=   27.85 meV, RMSE_F=   65.48 meV / A
2025-07-25 17:50:47.747 INFO: Stopping optimization after 3 epochs without improvement
2025-07-25 17:50:47.747 INFO: Training complete
2025-07-25 17:50:47.747 INFO: 
2025-07-25 17:50:47.747 INFO: ===========RESULTS===========
2025-07-25 17:50:47.811 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-13.pt
2025-07-25 17:50:47.849 INFO: Loaded Stage one model from epoch 13 for evaluation
2025-07-25 17:50:47.849 INFO: Saving model to checkpoints/mace_T1_finetune_h200_cn10_run-21.model
2025-07-25 17:50:48.088 INFO: Compiling model, saving metadata to mace_T1_finetune_h200_cn10_compiled.model
2025-07-25 17:50:48.904 INFO: Computing metrics for training, validation, and test sets
2025-07-25 17:50:48.905 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-25 17:50:48.905 INFO: Evaluating train_Default ...
2025-07-25 17:51:45.685 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 17:51:45.685 INFO: MACE version: 0.3.13
2025-07-25 17:51:46.275 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 17:51:52.039 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 17:51:52.039 INFO: MACE version: 0.3.13
2025-07-25 17:51:52.620 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 17:51:53.067 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 17:51:53.068 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 17:51:53.068 INFO: ===========LOADING INPUT DATA===========
2025-07-25 17:51:53.069 INFO: Using heads: ['Default']
2025-07-25 17:51:53.069 INFO: Using the key specifications to parse data:
2025-07-25 17:51:53.069 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 17:51:53.069 INFO: =============    Processing head Default     ===========
2025-07-25 17:52:14.097 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 17:52:14.115 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 17:52:16.707 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 17:52:16.709 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 17:52:16.709 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 17:52:17.004 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 17:52:17.004 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 17:52:17.004 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 17:52:17.004 INFO: Processing datasets for head 'Default'
2025-07-25 17:53:39.864 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 17:53:49.305 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 17:53:49.306 INFO: Combined validation datasets for Default
2025-07-25 17:53:49.306 INFO: Head 'Default' training dataset size: 6337
2025-07-25 17:53:49.306 INFO: Computing average number of neighbors
2025-07-25 17:53:56.930 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 17:53:56.931 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 17:53:56.931 INFO: ===========MODEL DETAILS===========
2025-07-25 17:54:03.936 INFO: Loading FOUNDATION model
2025-07-25 17:54:03.937 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 17:54:03.938 INFO: Model configuration extracted from foundation model
2025-07-25 17:54:03.938 INFO: Using universal loss function for fine-tuning
2025-07-25 17:54:03.938 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 17:54:03.938 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 17:54:03.938 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 17:54:03.938 INFO: Distance transform for radial basis functions: None
2025-07-25 17:54:05.397 INFO: Total number of parameters: 894362
2025-07-25 17:54:05.397 INFO: 
2025-07-25 17:54:05.397 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 17:54:05.397 INFO: Using ADAM as parameter optimizer
2025-07-25 17:54:05.397 INFO: Batch size: 2
2025-07-25 17:54:05.397 INFO: Number of gradient updates: 95055
2025-07-25 17:54:05.397 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 17:54:05.397 INFO: WeightedEnergyForcesLoss(energy_weight=10.000, forces_weight=100.000)
2025-07-25 17:54:05.399 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 17:54:05.400 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-13.pt
2025-07-25 17:54:05.441 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 17:54:05.441 INFO: 
2025-07-25 17:54:05.441 INFO: ===========TRAINING===========
2025-07-25 17:54:05.441 INFO: Started training, reporting errors on validation set
2025-07-25 17:54:05.441 INFO: Loss metrics on validation set
2025-07-25 17:55:20.677 INFO: Initial: head: Default, loss=0.43040350, RMSE_E_per_atom=    4.17 meV, RMSE_F=   68.66 meV / A
2025-07-25 18:27:26.423 INFO: Epoch 13: head: Default, loss=0.35144456, RMSE_E_per_atom=    6.95 meV, RMSE_F=   62.35 meV / A
2025-07-25 18:59:28.836 INFO: Epoch 14: head: Default, loss=0.30883556, RMSE_E_per_atom=   14.07 meV, RMSE_F=   58.27 meV / A
2025-07-25 19:31:31.812 INFO: Epoch 15: head: Default, loss=0.27620191, RMSE_E_per_atom=    9.23 meV, RMSE_F=   55.38 meV / A
2025-07-25 20:03:34.525 INFO: Epoch 16: head: Default, loss=0.25726939, RMSE_E_per_atom=    6.67 meV, RMSE_F=   53.46 meV / A
2025-07-25 20:35:37.730 INFO: Epoch 17: head: Default, loss=0.24050822, RMSE_E_per_atom=    4.17 meV, RMSE_F=   51.76 meV / A
2025-07-25 21:07:40.454 INFO: Epoch 18: head: Default, loss=0.22507515, RMSE_E_per_atom=    5.41 meV, RMSE_F=   50.14 meV / A
2025-07-25 21:39:45.212 INFO: Epoch 19: head: Default, loss=0.21889112, RMSE_E_per_atom=    5.23 meV, RMSE_F=   49.39 meV / A
2025-07-25 21:47:24.612 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 21:47:24.612 INFO: MACE version: 0.3.13
2025-07-25 21:47:25.270 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 21:47:25.723 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 21:47:25.724 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 21:47:25.725 INFO: ===========LOADING INPUT DATA===========
2025-07-25 21:47:25.725 INFO: Using heads: ['Default']
2025-07-25 21:47:25.725 INFO: Using the key specifications to parse data:
2025-07-25 21:47:25.725 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 21:47:25.725 INFO: =============    Processing head Default     ===========
2025-07-25 21:47:47.330 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:47:47.348 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:47:49.950 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:47:49.952 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:47:49.952 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 21:47:50.248 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 21:47:50.248 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 21:47:50.248 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 21:47:50.248 INFO: Processing datasets for head 'Default'
2025-07-25 21:49:13.283 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 21:49:22.736 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 21:49:22.736 INFO: Combined validation datasets for Default
2025-07-25 21:49:22.736 INFO: Head 'Default' training dataset size: 6337
2025-07-25 21:49:22.737 INFO: Computing average number of neighbors
2025-07-25 21:49:30.275 INFO: Average number of neighbors: 68.51643679748439
2025-07-25 21:49:30.276 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 21:49:30.276 INFO: ===========MODEL DETAILS===========
2025-07-25 21:49:37.277 INFO: Loading FOUNDATION model
2025-07-25 21:49:37.278 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 21:49:37.278 INFO: Model configuration extracted from foundation model
2025-07-25 21:49:37.279 INFO: Using universal loss function for fine-tuning
2025-07-25 21:49:37.279 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 21:49:37.279 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 21:49:37.279 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 21:49:37.279 INFO: Distance transform for radial basis functions: None
2025-07-25 21:49:38.679 INFO: Total number of parameters: 894362
2025-07-25 21:49:38.679 INFO: 
2025-07-25 21:49:38.679 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 21:49:38.679 INFO: Using ADAM as parameter optimizer
2025-07-25 21:49:38.679 INFO: Batch size: 2
2025-07-25 21:49:38.679 INFO: Number of gradient updates: 95055
2025-07-25 21:49:38.679 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 21:49:38.679 INFO: WeightedEnergyForcesLoss(energy_weight=5.000, forces_weight=100.000)
2025-07-25 21:49:38.700 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 21:49:38.701 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-19.pt
2025-07-25 21:49:38.739 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 21:49:38.739 INFO: 
2025-07-25 21:49:38.739 INFO: ===========TRAINING===========
2025-07-25 21:49:38.739 INFO: Started training, reporting errors on validation set
2025-07-25 21:49:38.739 INFO: Loss metrics on validation set
2025-07-25 21:50:53.606 INFO: Initial: head: Default, loss=0.21875416, RMSE_E_per_atom=    5.23 meV, RMSE_F=   49.39 meV / A
2025-07-25 22:22:55.482 INFO: Epoch 19: head: Default, loss=0.20574446, RMSE_E_per_atom=    3.55 meV, RMSE_F=   47.97 meV / A
2025-07-25 22:54:55.033 INFO: Epoch 20: head: Default, loss=0.19977895, RMSE_E_per_atom=    3.58 meV, RMSE_F=   47.20 meV / A
2025-07-25 23:26:55.902 INFO: Epoch 21: head: Default, loss=0.19583250, RMSE_E_per_atom=    4.40 meV, RMSE_F=   46.85 meV / A
2025-07-25 23:58:55.504 INFO: Epoch 22: head: Default, loss=0.18581767, RMSE_E_per_atom=    3.96 meV, RMSE_F=   45.61 meV / A
2025-07-26 00:30:55.966 INFO: Epoch 23: head: Default, loss=0.18342619, RMSE_E_per_atom=    2.76 meV, RMSE_F=   45.31 meV / A
2025-07-26 01:02:56.264 INFO: Epoch 24: head: Default, loss=0.17398226, RMSE_E_per_atom=    2.93 meV, RMSE_F=   44.23 meV / A
2025-07-26 01:34:57.155 INFO: Epoch 25: head: Default, loss=0.17182387, RMSE_E_per_atom=    3.08 meV, RMSE_F=   43.91 meV / A
2025-07-26 02:06:58.828 INFO: Epoch 26: head: Default, loss=0.16775714, RMSE_E_per_atom=    5.75 meV, RMSE_F=   43.33 meV / A
2025-07-26 02:08:51.155 INFO: ===========VERIFYING SETTINGS===========
2025-07-26 02:08:51.155 INFO: MACE version: 0.3.13
2025-07-26 02:08:51.765 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-26 02:08:52.343 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-26 02:08:52.344 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-26 02:08:52.344 INFO: ===========LOADING INPUT DATA===========
2025-07-26 02:08:52.344 INFO: Using heads: ['Default']
2025-07-26 02:08:52.344 INFO: Using the key specifications to parse data:
2025-07-26 02:08:52.344 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-26 02:08:52.344 INFO: =============    Processing head Default     ===========
2025-07-26 02:09:13.393 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 02:09:13.410 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 02:09:16.081 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 02:09:16.083 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 02:09:16.083 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-26 02:09:16.378 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-26 02:09:16.378 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-26 02:09:16.378 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-26 02:09:16.378 INFO: Processing datasets for head 'Default'
2025-07-26 02:10:39.883 INFO: Combining 1 list datasets for head 'Default'
2025-07-26 02:10:49.402 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-26 02:10:49.403 INFO: Combined validation datasets for Default
2025-07-26 02:10:49.403 INFO: Head 'Default' training dataset size: 6337
2025-07-26 02:10:49.403 INFO: Computing average number of neighbors
2025-07-26 02:10:57.268 INFO: Average number of neighbors: 68.51643679748439
2025-07-26 02:10:57.269 INFO: During training the following quantities will be reported: energy, forces
2025-07-26 02:10:57.269 INFO: ===========MODEL DETAILS===========
2025-07-26 02:11:04.496 INFO: Loading FOUNDATION model
2025-07-26 02:11:04.498 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-26 02:11:04.498 INFO: Model configuration extracted from foundation model
2025-07-26 02:11:04.498 INFO: Using universal loss function for fine-tuning
2025-07-26 02:11:04.498 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-26 02:11:04.498 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-26 02:11:04.498 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-26 02:11:04.498 INFO: Distance transform for radial basis functions: None
2025-07-26 02:11:05.911 INFO: Total number of parameters: 894362
2025-07-26 02:11:05.911 INFO: 
2025-07-26 02:11:05.911 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-26 02:11:05.912 INFO: Using ADAM as parameter optimizer
2025-07-26 02:11:05.912 INFO: Batch size: 2
2025-07-26 02:11:05.912 INFO: Number of gradient updates: 95055
2025-07-26 02:11:05.912 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-26 02:11:05.912 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-26 02:11:05.914 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-26 02:11:05.915 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-26.pt
2025-07-26 02:11:05.955 INFO: Using gradient clipping with tolerance=30.000
2025-07-26 02:11:05.955 INFO: 
2025-07-26 02:11:05.955 INFO: ===========TRAINING===========
2025-07-26 02:11:05.955 INFO: Started training, reporting errors on validation set
2025-07-26 02:11:05.955 INFO: Loss metrics on validation set
2025-07-26 02:12:21.099 INFO: Initial: head: Default, loss=0.33521649, RMSE_E_per_atom=    5.75 meV, RMSE_F=   43.33 meV / A
2025-07-26 02:44:27.650 INFO: Epoch 26: head: Default, loss=0.32733785, RMSE_E_per_atom=    8.66 meV, RMSE_F=   42.90 meV / A
2025-07-26 02:54:44.010 INFO: ===========VERIFYING SETTINGS===========
2025-07-26 02:54:44.010 INFO: MACE version: 0.3.13
2025-07-26 02:54:44.647 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-26 02:54:45.202 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-26 02:54:45.203 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-26 02:54:45.203 INFO: ===========LOADING INPUT DATA===========
2025-07-26 02:54:45.203 INFO: Using heads: ['Default']
2025-07-26 02:54:45.203 INFO: Using the key specifications to parse data:
2025-07-26 02:54:45.203 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-26 02:54:45.203 INFO: =============    Processing head Default     ===========
2025-07-26 02:55:06.276 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 02:55:06.294 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 02:55:08.959 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 02:55:08.961 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 02:55:08.961 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-26 02:55:09.255 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-26 02:55:09.255 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-26 02:55:09.255 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-26 02:55:09.255 INFO: Processing datasets for head 'Default'
2025-07-26 02:56:32.925 INFO: Combining 1 list datasets for head 'Default'
2025-07-26 02:56:42.453 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-26 02:56:42.453 INFO: Combined validation datasets for Default
2025-07-26 02:56:42.453 INFO: Head 'Default' training dataset size: 6337
2025-07-26 02:56:42.454 INFO: Computing average number of neighbors
2025-07-26 02:56:50.676 INFO: Average number of neighbors: 68.51643679748439
2025-07-26 02:56:50.677 INFO: During training the following quantities will be reported: energy, forces
2025-07-26 02:56:50.677 INFO: ===========MODEL DETAILS===========
2025-07-26 02:56:57.638 INFO: Loading FOUNDATION model
2025-07-26 02:56:57.640 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-26 02:56:57.640 INFO: Model configuration extracted from foundation model
2025-07-26 02:56:57.640 INFO: Using universal loss function for fine-tuning
2025-07-26 02:56:57.640 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-26 02:56:57.640 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-26 02:56:57.640 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-26 02:56:57.640 INFO: Distance transform for radial basis functions: None
2025-07-26 02:56:59.070 INFO: Total number of parameters: 894362
2025-07-26 02:56:59.070 INFO: 
2025-07-26 02:56:59.070 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-26 02:56:59.070 INFO: Using ADAM as parameter optimizer
2025-07-26 02:56:59.070 INFO: Batch size: 2
2025-07-26 02:56:59.070 INFO: Number of gradient updates: 110897
2025-07-26 02:56:59.070 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-26 02:56:59.070 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-26 02:56:59.074 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-26 02:56:59.075 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-26.pt
2025-07-26 02:56:59.115 INFO: Using gradient clipping with tolerance=30.000
2025-07-26 02:56:59.115 INFO: 
2025-07-26 02:56:59.115 INFO: ===========TRAINING===========
2025-07-26 02:56:59.115 INFO: Started training, reporting errors on validation set
2025-07-26 02:56:59.115 INFO: Loss metrics on validation set
2025-07-26 02:58:14.115 INFO: Initial: head: Default, loss=0.32733785, RMSE_E_per_atom=    8.66 meV, RMSE_F=   42.90 meV / A
2025-07-26 03:30:19.463 INFO: Epoch 26: head: Default, loss=0.33678642, RMSE_E_per_atom=    6.13 meV, RMSE_F=   43.49 meV / A
2025-07-26 04:02:22.304 INFO: Epoch 27: head: Default, loss=0.30998959, RMSE_E_per_atom=    9.58 meV, RMSE_F=   41.78 meV / A
2025-07-26 04:34:22.621 INFO: Epoch 28: head: Default, loss=0.31755417, RMSE_E_per_atom=   10.44 meV, RMSE_F=   42.25 meV / A
2025-07-26 05:06:22.987 INFO: Epoch 29: head: Default, loss=0.29829778, RMSE_E_per_atom=   15.77 meV, RMSE_F=   41.09 meV / A
2025-07-26 05:38:23.534 INFO: Epoch 30: head: Default, loss=0.27691077, RMSE_E_per_atom=   14.07 meV, RMSE_F=   39.47 meV / A
2025-07-26 06:10:23.931 INFO: Epoch 31: head: Default, loss=0.26459344, RMSE_E_per_atom=    8.64 meV, RMSE_F=   38.74 meV / A
2025-07-26 06:42:24.646 INFO: Epoch 32: head: Default, loss=0.29512431, RMSE_E_per_atom=    7.71 meV, RMSE_F=   40.70 meV / A
2025-07-26 07:14:25.445 INFO: Epoch 33: head: Default, loss=0.26127061, RMSE_E_per_atom=    8.97 meV, RMSE_F=   38.44 meV / A
2025-07-26 07:46:26.435 INFO: Epoch 34: head: Default, loss=0.24611190, RMSE_E_per_atom=    5.55 meV, RMSE_F=   37.33 meV / A
2025-07-26 07:46:26.595 INFO: Training complete
2025-07-26 07:46:26.595 INFO: 
2025-07-26 07:46:26.595 INFO: ===========RESULTS===========
2025-07-26 07:46:26.599 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-34.pt
2025-07-26 07:46:26.632 INFO: Loaded Stage one model from epoch 34 for evaluation
2025-07-26 07:46:26.632 INFO: Saving model to checkpoints/mace_T1_finetune_h200_cn10_run-21.model
2025-07-26 07:46:26.910 INFO: Compiling model, saving metadata to mace_T1_finetune_h200_cn10_compiled.model
2025-07-26 07:46:27.540 INFO: Computing metrics for training, validation, and test sets
2025-07-26 07:46:27.541 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-26 07:46:27.541 INFO: Evaluating train_Default ...
2025-07-26 07:58:29.114 INFO: Evaluating valid_Default ...
2025-07-26 07:59:42.023 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+---------------+---------------------+------------------+-------------------+
| train_Default |            5.5      |         37.9     |         11.01     |
| valid_Default |            5.6      |         37.3     |         10.86     |
+---------------+---------------------+------------------+-------------------+
2025-07-26 08:15:57.297 INFO: Done
2025-07-26 13:47:57.125 INFO: ===========VERIFYING SETTINGS===========
2025-07-26 13:47:57.125 INFO: MACE version: 0.3.13
2025-07-26 13:47:57.482 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-26 13:47:58.325 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-26 13:47:58.326 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-26 13:47:58.326 INFO: ===========LOADING INPUT DATA===========
2025-07-26 13:47:58.326 INFO: Using heads: ['Default']
2025-07-26 13:47:58.326 INFO: Using the key specifications to parse data:
2025-07-26 13:47:58.326 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-26 13:47:58.326 INFO: =============    Processing head Default     ===========
2025-07-26 13:48:19.387 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 13:48:19.405 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 13:48:22.015 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 13:48:22.017 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 13:48:22.017 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-26 13:48:22.309 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-26 13:48:22.310 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-26 13:48:22.310 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-26 13:48:22.310 INFO: Processing datasets for head 'Default'
2025-07-26 13:49:45.587 INFO: Combining 1 list datasets for head 'Default'
2025-07-26 13:49:55.043 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-26 13:49:55.044 INFO: Combined validation datasets for Default
2025-07-26 13:49:55.044 INFO: Head 'Default' training dataset size: 6337
2025-07-26 13:49:55.044 INFO: Computing average number of neighbors
2025-07-26 13:50:02.751 INFO: Average number of neighbors: 68.51643679748439
2025-07-26 13:50:02.752 INFO: During training the following quantities will be reported: energy, forces
2025-07-26 13:50:02.752 INFO: ===========MODEL DETAILS===========
2025-07-26 13:50:09.685 INFO: Loading FOUNDATION model
2025-07-26 13:50:09.686 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-26 13:50:09.686 INFO: Model configuration extracted from foundation model
2025-07-26 13:50:09.686 INFO: Using universal loss function for fine-tuning
2025-07-26 13:50:09.686 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-26 13:50:09.686 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-26 13:50:09.686 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-26 13:50:09.686 INFO: Distance transform for radial basis functions: None
2025-07-26 13:50:11.089 INFO: Total number of parameters: 894362
2025-07-26 13:50:11.089 INFO: 
2025-07-26 13:50:11.089 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-26 13:50:11.089 INFO: Using ADAM as parameter optimizer
2025-07-26 13:50:11.089 INFO: Batch size: 2
2025-07-26 13:50:11.089 INFO: Number of gradient updates: 174267
2025-07-26 13:50:11.089 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-26 13:50:11.089 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-26 13:50:11.128 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-26 13:50:11.128 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-34.pt
2025-07-26 13:50:11.169 INFO: Using gradient clipping with tolerance=30.000
2025-07-26 13:50:11.169 INFO: 
2025-07-26 13:50:11.169 INFO: ===========TRAINING===========
2025-07-26 13:50:11.169 INFO: Started training, reporting errors on validation set
2025-07-26 13:50:11.169 INFO: Loss metrics on validation set
2025-07-26 13:51:25.936 INFO: Initial: head: Default, loss=0.24611190, RMSE_E_per_atom=    5.55 meV, RMSE_F=   37.33 meV / A
2025-07-26 14:25:31.725 INFO: ===========VERIFYING SETTINGS===========
2025-07-26 14:25:31.725 INFO: MACE version: 0.3.13
2025-07-26 14:25:32.136 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-26 14:25:32.970 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-26 14:25:32.971 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-26 14:25:32.972 INFO: ===========LOADING INPUT DATA===========
2025-07-26 14:25:32.972 INFO: Using heads: ['Default']
2025-07-26 14:25:32.972 INFO: Using the key specifications to parse data:
2025-07-26 14:25:32.972 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-26 14:25:32.972 INFO: =============    Processing head Default     ===========
2025-07-26 14:25:54.017 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 14:25:54.035 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 14:25:56.662 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 14:25:56.664 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 14:25:56.664 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-26 14:25:56.957 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-26 14:25:56.957 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-26 14:25:56.957 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-26 14:25:56.957 INFO: Processing datasets for head 'Default'
2025-07-26 14:27:23.044 INFO: Combining 1 list datasets for head 'Default'
2025-07-26 14:27:32.494 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-26 14:27:32.494 INFO: Combined validation datasets for Default
2025-07-26 14:27:32.494 INFO: Head 'Default' training dataset size: 6337
2025-07-26 14:27:32.495 INFO: Computing average number of neighbors
2025-07-26 14:27:40.954 INFO: Average number of neighbors: 68.51643679748439
2025-07-26 14:27:40.955 INFO: During training the following quantities will be reported: energy, forces
2025-07-26 14:27:40.955 INFO: ===========MODEL DETAILS===========
2025-07-26 14:27:51.528 INFO: Loading FOUNDATION model
2025-07-26 14:27:51.530 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-26 14:27:51.530 INFO: Model configuration extracted from foundation model
2025-07-26 14:27:51.530 INFO: Using universal loss function for fine-tuning
2025-07-26 14:27:51.530 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-26 14:27:51.530 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-26 14:27:51.530 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-26 14:27:51.530 INFO: Distance transform for radial basis functions: None
2025-07-26 14:27:53.018 INFO: Total number of parameters: 894362
2025-07-26 14:27:53.018 INFO: 
2025-07-26 14:27:53.018 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-26 14:27:53.018 INFO: Using ADAM as parameter optimizer
2025-07-26 14:27:53.018 INFO: Batch size: 2
2025-07-26 14:27:53.018 INFO: Number of gradient updates: 174267
2025-07-26 14:27:53.018 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-26 14:27:53.018 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-26 14:27:53.082 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-26 14:27:53.083 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-34.pt
2025-07-26 14:27:53.123 INFO: Using gradient clipping with tolerance=30.000
2025-07-26 14:27:53.123 INFO: 
2025-07-26 14:27:53.123 INFO: ===========TRAINING===========
2025-07-26 14:27:53.123 INFO: Started training, reporting errors on validation set
2025-07-26 14:27:53.123 INFO: Loss metrics on validation set
2025-07-26 14:29:11.705 INFO: Initial: head: Default, loss=0.24611190, RMSE_E_per_atom=    5.55 meV, RMSE_F=   37.33 meV / A
2025-07-26 15:01:15.293 INFO: Epoch 34: head: Default, loss=0.24802673, RMSE_E_per_atom=    6.08 meV, RMSE_F=   37.48 meV / A
2025-07-26 15:33:55.851 INFO: Epoch 35: head: Default, loss=0.22815326, RMSE_E_per_atom=   14.06 meV, RMSE_F=   35.97 meV / A
2025-07-26 16:05:58.510 INFO: Epoch 36: head: Default, loss=0.24814530, RMSE_E_per_atom=    8.78 meV, RMSE_F=   37.32 meV / A
2025-07-26 16:38:01.233 INFO: Epoch 37: head: Default, loss=0.23654201, RMSE_E_per_atom=   16.17 meV, RMSE_F=   36.67 meV / A
2025-07-26 17:10:12.074 INFO: Epoch 38: head: Default, loss=0.22861818, RMSE_E_per_atom=    9.65 meV, RMSE_F=   35.95 meV / A
2025-07-26 17:10:12.075 INFO: Stopping optimization after 3 epochs without improvement
2025-07-26 17:10:12.075 INFO: Training complete
2025-07-26 17:10:12.075 INFO: 
2025-07-26 17:10:12.075 INFO: ===========RESULTS===========
2025-07-26 17:10:12.127 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-35.pt
2025-07-26 17:10:12.168 INFO: Loaded Stage one model from epoch 35 for evaluation
2025-07-26 17:10:12.168 INFO: Saving model to checkpoints/mace_T1_finetune_h200_cn10_run-21.model
2025-07-26 17:10:12.461 INFO: Compiling model, saving metadata to mace_T1_finetune_h200_cn10_compiled.model
2025-07-26 17:10:13.416 INFO: Computing metrics for training, validation, and test sets
2025-07-26 17:10:13.417 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-26 17:10:13.417 INFO: Evaluating train_Default ...
2025-07-26 17:22:37.955 INFO: Evaluating valid_Default ...
2025-07-26 17:23:52.523 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+---------------+---------------------+------------------+-------------------+
| train_Default |           14.1      |         36.6     |         10.62     |
| valid_Default |           14.1      |         36.0     |         10.47     |
+---------------+---------------------+------------------+-------------------+
2025-07-26 17:37:37.783 INFO: ===========VERIFYING SETTINGS===========
2025-07-26 17:37:37.784 INFO: MACE version: 0.3.13
2025-07-26 17:37:38.256 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-26 17:37:38.917 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-26 17:37:38.920 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-26 17:37:38.920 INFO: ===========LOADING INPUT DATA===========
2025-07-26 17:37:38.920 INFO: Using heads: ['Default']
2025-07-26 17:37:38.920 INFO: Using the key specifications to parse data:
2025-07-26 17:37:38.920 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-26 17:37:38.920 INFO: =============    Processing head Default     ===========
2025-07-26 17:37:59.965 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 17:37:59.983 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 17:38:02.601 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 17:38:02.602 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 17:38:02.603 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-26 17:38:02.896 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-26 17:38:02.896 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-26 17:38:02.896 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-26 17:38:02.896 INFO: Processing datasets for head 'Default'
2025-07-26 17:39:25.923 INFO: Combining 1 list datasets for head 'Default'
2025-07-26 17:39:35.360 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-26 17:39:35.361 INFO: Combined validation datasets for Default
2025-07-26 17:39:35.361 INFO: Head 'Default' training dataset size: 6337
2025-07-26 17:39:35.361 INFO: Computing average number of neighbors
2025-07-26 17:39:43.300 INFO: Average number of neighbors: 68.51643679748439
2025-07-26 17:39:43.301 INFO: During training the following quantities will be reported: energy, forces
2025-07-26 17:39:43.301 INFO: ===========MODEL DETAILS===========
2025-07-26 17:39:50.394 INFO: Loading FOUNDATION model
2025-07-26 17:39:50.395 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-26 17:39:50.395 INFO: Model configuration extracted from foundation model
2025-07-26 17:39:50.395 INFO: Using universal loss function for fine-tuning
2025-07-26 17:39:50.395 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-26 17:39:50.395 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-26 17:39:50.395 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-26 17:39:50.395 INFO: Distance transform for radial basis functions: None
2025-07-26 17:39:51.803 INFO: Total number of parameters: 894362
2025-07-26 17:39:51.803 INFO: 
2025-07-26 17:39:51.803 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-26 17:39:51.803 INFO: Using ADAM as parameter optimizer
2025-07-26 17:39:51.803 INFO: Batch size: 2
2025-07-26 17:39:51.803 INFO: Number of gradient updates: 174267
2025-07-26 17:39:51.803 INFO: Learning rate: 0.0006, weight decay: 1e-08
2025-07-26 17:39:51.803 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-26 17:39:51.807 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-26 17:39:51.807 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-35.pt
2025-07-26 17:39:51.847 INFO: Using gradient clipping with tolerance=30.000
2025-07-26 17:39:51.847 INFO: 
2025-07-26 17:39:51.847 INFO: ===========TRAINING===========
2025-07-26 17:39:51.847 INFO: Started training, reporting errors on validation set
2025-07-26 17:39:51.847 INFO: Loss metrics on validation set
2025-07-26 17:41:06.911 INFO: Initial: head: Default, loss=0.22815326, RMSE_E_per_atom=   14.06 meV, RMSE_F=   35.97 meV / A
2025-07-26 18:13:12.518 INFO: Epoch 35: head: Default, loss=0.22974749, RMSE_E_per_atom=   12.78 meV, RMSE_F=   36.05 meV / A
2025-07-26 18:22:56.134 INFO: ===========VERIFYING SETTINGS===========
2025-07-26 18:22:56.134 INFO: MACE version: 0.3.13
2025-07-26 18:22:56.619 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-26 18:22:57.259 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-26 18:22:57.260 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-26 18:22:57.260 INFO: ===========LOADING INPUT DATA===========
2025-07-26 18:22:57.260 INFO: Using heads: ['Default']
2025-07-26 18:22:57.260 INFO: Using the key specifications to parse data:
2025-07-26 18:22:57.261 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-26 18:22:57.261 INFO: =============    Processing head Default     ===========
2025-07-26 18:23:18.342 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 18:23:18.359 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 18:23:20.950 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 18:23:20.952 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 18:23:20.952 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-26 18:23:21.246 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-26 18:23:21.246 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-26 18:23:21.247 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-26 18:23:21.247 INFO: Processing datasets for head 'Default'
2025-07-26 18:24:44.593 INFO: Combining 1 list datasets for head 'Default'
2025-07-26 18:24:54.046 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-26 18:24:54.046 INFO: Combined validation datasets for Default
2025-07-26 18:24:54.046 INFO: Head 'Default' training dataset size: 6337
2025-07-26 18:24:54.046 INFO: Computing average number of neighbors
2025-07-26 18:25:01.491 INFO: Average number of neighbors: 68.51643679748439
2025-07-26 18:25:01.493 INFO: During training the following quantities will be reported: energy, forces
2025-07-26 18:25:01.493 INFO: ===========MODEL DETAILS===========
2025-07-26 18:25:08.530 INFO: Loading FOUNDATION model
2025-07-26 18:25:08.532 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-26 18:25:08.532 INFO: Model configuration extracted from foundation model
2025-07-26 18:25:08.532 INFO: Using universal loss function for fine-tuning
2025-07-26 18:25:08.532 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-26 18:25:08.532 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-26 18:25:08.532 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-26 18:25:08.532 INFO: Distance transform for radial basis functions: None
2025-07-26 18:25:09.935 INFO: Total number of parameters: 894362
2025-07-26 18:25:09.935 INFO: 
2025-07-26 18:25:09.935 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-26 18:25:09.936 INFO: Using ADAM as parameter optimizer
2025-07-26 18:25:09.936 INFO: Batch size: 2
2025-07-26 18:25:09.936 INFO: Number of gradient updates: 174267
2025-07-26 18:25:09.936 INFO: Learning rate: 0.0006, weight decay: 1e-08
2025-07-26 18:25:09.936 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-26 18:25:09.938 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-26 18:25:09.939 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-35.pt
2025-07-26 18:25:09.976 INFO: Using gradient clipping with tolerance=30.000
2025-07-26 18:25:09.976 INFO: 
2025-07-26 18:25:09.977 INFO: ===========TRAINING===========
2025-07-26 18:25:09.977 INFO: Started training, reporting errors on validation set
2025-07-26 18:25:09.977 INFO: Loss metrics on validation set
2025-07-26 18:26:26.303 INFO: Initial: head: Default, loss=0.22974749, RMSE_E_per_atom=   12.78 meV, RMSE_F=   36.05 meV / A
2025-07-26 18:58:42.384 INFO: Epoch 35: head: Default, loss=0.22814085, RMSE_E_per_atom=   12.67 meV, RMSE_F=   35.92 meV / A
2025-07-26 19:30:56.236 INFO: Epoch 36: head: Default, loss=0.21530286, RMSE_E_per_atom=    6.92 meV, RMSE_F=   34.95 meV / A
2025-07-26 20:03:11.364 INFO: Epoch 37: head: Default, loss=0.21913927, RMSE_E_per_atom=    8.66 meV, RMSE_F=   35.20 meV / A
2025-07-26 20:35:25.721 INFO: Epoch 38: head: Default, loss=0.21394251, RMSE_E_per_atom=    5.49 meV, RMSE_F=   34.86 meV / A
2025-07-26 21:07:28.103 INFO: Epoch 39: head: Default, loss=0.21209765, RMSE_E_per_atom=    6.92 meV, RMSE_F=   34.72 meV / A
2025-07-26 21:39:32.267 INFO: Epoch 40: head: Default, loss=0.20721204, RMSE_E_per_atom=    4.72 meV, RMSE_F=   34.32 meV / A
2025-07-26 22:11:34.401 INFO: Epoch 41: head: Default, loss=0.22761355, RMSE_E_per_atom=    9.39 meV, RMSE_F=   35.75 meV / A
2025-07-26 22:43:35.740 INFO: Epoch 42: head: Default, loss=0.20676463, RMSE_E_per_atom=    5.73 meV, RMSE_F=   34.30 meV / A
2025-07-26 22:56:46.222 INFO: ===========VERIFYING SETTINGS===========
2025-07-26 22:56:46.222 INFO: MACE version: 0.3.13
2025-07-26 22:56:46.603 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-26 22:56:47.560 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-26 22:56:47.561 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-26 22:56:47.561 INFO: ===========LOADING INPUT DATA===========
2025-07-26 22:56:47.561 INFO: Using heads: ['Default']
2025-07-26 22:56:47.561 INFO: Using the key specifications to parse data:
2025-07-26 22:56:47.561 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-26 22:56:47.561 INFO: =============    Processing head Default     ===========
2025-07-26 22:57:08.578 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 22:57:08.596 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-26 22:57:11.216 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 22:57:11.218 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-26 22:57:11.218 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-26 22:57:11.512 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-26 22:57:11.512 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-26 22:57:11.512 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-26 22:57:11.512 INFO: Processing datasets for head 'Default'
2025-07-26 22:58:34.780 INFO: Combining 1 list datasets for head 'Default'
2025-07-26 22:58:44.256 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-26 22:58:44.256 INFO: Combined validation datasets for Default
2025-07-26 22:58:44.256 INFO: Head 'Default' training dataset size: 6337
2025-07-26 22:58:44.257 INFO: Computing average number of neighbors
2025-07-26 22:58:52.036 INFO: Average number of neighbors: 68.51643679748439
2025-07-26 22:58:52.037 INFO: During training the following quantities will be reported: energy, forces
2025-07-26 22:58:52.037 INFO: ===========MODEL DETAILS===========
2025-07-26 22:58:59.168 INFO: Loading FOUNDATION model
2025-07-26 22:58:59.169 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-26 22:58:59.170 INFO: Model configuration extracted from foundation model
2025-07-26 22:58:59.170 INFO: Using universal loss function for fine-tuning
2025-07-26 22:58:59.170 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-26 22:58:59.170 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-26 22:58:59.170 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-26 22:58:59.170 INFO: Distance transform for radial basis functions: None
2025-07-26 22:59:00.639 INFO: Total number of parameters: 894362
2025-07-26 22:59:00.639 INFO: 
2025-07-26 22:59:00.639 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-26 22:59:00.639 INFO: Using ADAM as parameter optimizer
2025-07-26 22:59:00.639 INFO: Batch size: 2
2025-07-26 22:59:00.639 INFO: Number of gradient updates: 174267
2025-07-26 22:59:00.639 INFO: Learning rate: 0.0006, weight decay: 1e-08
2025-07-26 22:59:00.639 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-26 22:59:00.642 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-26 22:59:00.642 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-42.pt
2025-07-26 22:59:00.681 INFO: Using gradient clipping with tolerance=30.000
2025-07-26 22:59:00.681 INFO: 
2025-07-26 22:59:00.681 INFO: ===========TRAINING===========
2025-07-26 22:59:00.681 INFO: Started training, reporting errors on validation set
2025-07-26 22:59:00.681 INFO: Loss metrics on validation set
2025-07-26 23:00:15.781 INFO: Initial: head: Default, loss=0.20676463, RMSE_E_per_atom=    5.73 meV, RMSE_F=   34.30 meV / A
2025-07-26 23:32:21.184 INFO: Epoch 42: head: Default, loss=0.22140614, RMSE_E_per_atom=   11.23 meV, RMSE_F=   35.32 meV / A
2025-07-27 00:04:25.233 INFO: Epoch 43: head: Default, loss=0.20047167, RMSE_E_per_atom=    6.51 meV, RMSE_F=   33.74 meV / A
2025-07-27 00:36:29.705 INFO: Epoch 44: head: Default, loss=0.20714907, RMSE_E_per_atom=    9.98 meV, RMSE_F=   34.21 meV / A
2025-07-27 01:08:34.259 INFO: Epoch 45: head: Default, loss=0.20069313, RMSE_E_per_atom=    5.55 meV, RMSE_F=   33.78 meV / A
2025-07-27 01:27:15.213 INFO: ===========VERIFYING SETTINGS===========
2025-07-27 01:27:15.213 INFO: MACE version: 0.3.13
2025-07-27 01:27:15.653 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-27 01:27:16.484 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-27 01:27:16.487 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-27 01:27:16.487 INFO: ===========LOADING INPUT DATA===========
2025-07-27 01:27:16.487 INFO: Using heads: ['Default']
2025-07-27 01:27:16.487 INFO: Using the key specifications to parse data:
2025-07-27 01:27:16.487 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-27 01:27:16.487 INFO: =============    Processing head Default     ===========
2025-07-27 01:27:37.632 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 01:27:37.650 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 01:27:40.269 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 01:27:40.270 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 01:27:40.271 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-27 01:27:40.564 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-27 01:27:40.564 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-27 01:27:40.564 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-27 01:27:40.564 INFO: Processing datasets for head 'Default'
2025-07-27 01:29:03.830 INFO: Combining 1 list datasets for head 'Default'
2025-07-27 01:29:13.289 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-27 01:29:13.289 INFO: Combined validation datasets for Default
2025-07-27 01:29:13.289 INFO: Head 'Default' training dataset size: 6337
2025-07-27 01:29:13.289 INFO: Computing average number of neighbors
2025-07-27 01:29:20.860 INFO: Average number of neighbors: 68.51643679748439
2025-07-27 01:29:20.862 INFO: During training the following quantities will be reported: energy, forces
2025-07-27 01:29:20.862 INFO: ===========MODEL DETAILS===========
2025-07-27 01:29:28.029 INFO: Loading FOUNDATION model
2025-07-27 01:29:28.030 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-27 01:29:28.030 INFO: Model configuration extracted from foundation model
2025-07-27 01:29:28.030 INFO: Using universal loss function for fine-tuning
2025-07-27 01:29:28.031 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-27 01:29:28.031 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-27 01:29:28.031 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-27 01:29:28.031 INFO: Distance transform for radial basis functions: None
2025-07-27 01:29:29.510 INFO: Total number of parameters: 894362
2025-07-27 01:29:29.510 INFO: 
2025-07-27 01:29:29.510 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-27 01:29:29.510 INFO: Using ADAM as parameter optimizer
2025-07-27 01:29:29.510 INFO: Batch size: 2
2025-07-27 01:29:29.510 INFO: Number of gradient updates: 190110
2025-07-27 01:29:29.510 INFO: Learning rate: 0.0006, weight decay: 1e-08
2025-07-27 01:29:29.511 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-27 01:29:29.524 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-27 01:29:29.525 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-43.pt
2025-07-27 01:29:29.564 INFO: Using gradient clipping with tolerance=30.000
2025-07-27 01:29:29.565 INFO: 
2025-07-27 01:29:29.565 INFO: ===========TRAINING===========
2025-07-27 01:29:29.565 INFO: Started training, reporting errors on validation set
2025-07-27 01:29:29.565 INFO: Loss metrics on validation set
2025-07-27 01:30:44.657 INFO: Initial: head: Default, loss=0.20047167, RMSE_E_per_atom=    6.51 meV, RMSE_F=   33.74 meV / A
2025-07-27 02:02:50.120 INFO: Epoch 43: head: Default, loss=0.21577484, RMSE_E_per_atom=   10.91 meV, RMSE_F=   34.89 meV / A
2025-07-27 02:34:53.280 INFO: Epoch 44: head: Default, loss=0.19770522, RMSE_E_per_atom=    6.12 meV, RMSE_F=   33.51 meV / A
2025-07-27 03:06:56.809 INFO: Epoch 45: head: Default, loss=0.20454402, RMSE_E_per_atom=   10.02 meV, RMSE_F=   34.00 meV / A
2025-07-27 03:38:59.936 INFO: Epoch 46: head: Default, loss=0.19801672, RMSE_E_per_atom=    5.40 meV, RMSE_F=   33.56 meV / A
2025-07-27 04:11:02.833 INFO: Epoch 47: head: Default, loss=0.19733374, RMSE_E_per_atom=    5.02 meV, RMSE_F=   33.49 meV / A
2025-07-27 04:43:05.603 INFO: Epoch 48: head: Default, loss=0.19244852, RMSE_E_per_atom=    3.38 meV, RMSE_F=   33.08 meV / A
2025-07-27 05:15:08.863 INFO: Epoch 49: head: Default, loss=0.20409783, RMSE_E_per_atom=    8.24 meV, RMSE_F=   33.97 meV / A
2025-07-27 05:47:12.276 INFO: Epoch 50: head: Default, loss=0.19307762, RMSE_E_per_atom=    5.74 meV, RMSE_F=   33.13 meV / A
2025-07-27 06:19:15.899 INFO: Epoch 51: head: Default, loss=0.19210879, RMSE_E_per_atom=    3.22 meV, RMSE_F=   33.03 meV / A
2025-07-27 06:51:19.733 INFO: Epoch 52: head: Default, loss=0.20098049, RMSE_E_per_atom=    3.47 meV, RMSE_F=   33.89 meV / A
2025-07-27 07:23:23.598 INFO: Epoch 53: head: Default, loss=0.22029181, RMSE_E_per_atom=   15.16 meV, RMSE_F=   35.25 meV / A
2025-07-27 07:55:27.273 INFO: Epoch 54: head: Default, loss=0.19192860, RMSE_E_per_atom=    6.65 meV, RMSE_F=   33.03 meV / A
2025-07-27 08:27:30.780 INFO: Epoch 55: head: Default, loss=0.18619642, RMSE_E_per_atom=   10.82 meV, RMSE_F=   32.55 meV / A
2025-07-27 08:59:34.460 INFO: Epoch 56: head: Default, loss=0.20784261, RMSE_E_per_atom=    4.99 meV, RMSE_F=   34.55 meV / A
2025-07-27 09:31:37.650 INFO: Epoch 57: head: Default, loss=0.18971552, RMSE_E_per_atom=   15.92 meV, RMSE_F=   32.86 meV / A
2025-07-27 10:03:40.597 INFO: Epoch 58: head: Default, loss=0.19464761, RMSE_E_per_atom=    7.32 meV, RMSE_F=   33.33 meV / A
2025-07-27 10:35:44.600 INFO: Epoch 59: head: Default, loss=0.18744542, RMSE_E_per_atom=    3.04 meV, RMSE_F=   32.72 meV / A
2025-07-27 10:35:44.602 INFO: Training complete
2025-07-27 10:35:44.602 INFO: 
2025-07-27 10:35:44.602 INFO: ===========RESULTS===========
2025-07-27 10:35:44.697 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-55.pt
2025-07-27 10:35:44.734 INFO: Loaded Stage one model from epoch 55 for evaluation
2025-07-27 10:35:44.734 INFO: Saving model to checkpoints/mace_T1_finetune_h200_cn10_run-21.model
2025-07-27 10:35:45.006 INFO: Compiling model, saving metadata to mace_T1_finetune_h200_cn10_compiled.model
2025-07-27 10:35:45.984 INFO: Computing metrics for training, validation, and test sets
2025-07-27 10:35:45.984 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-27 10:35:45.985 INFO: Evaluating train_Default ...
2025-07-27 10:47:51.396 INFO: Evaluating valid_Default ...
2025-07-27 10:49:04.939 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+---------------+---------------------+------------------+-------------------+
| train_Default |           10.8      |         32.9     |          9.56     |
| valid_Default |           10.8      |         32.6     |          9.47     |
+---------------+---------------------+------------------+-------------------+
2025-07-27 10:57:29.208 INFO: ===========VERIFYING SETTINGS===========
2025-07-27 10:57:29.209 INFO: MACE version: 0.3.13
2025-07-27 10:57:29.877 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-27 10:57:30.733 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-27 10:57:30.734 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-27 10:57:30.734 INFO: ===========LOADING INPUT DATA===========
2025-07-27 10:57:30.734 INFO: Using heads: ['Default']
2025-07-27 10:57:30.734 INFO: Using the key specifications to parse data:
2025-07-27 10:57:30.734 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-27 10:57:30.734 INFO: =============    Processing head Default     ===========
2025-07-27 10:57:51.831 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 10:57:51.849 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 10:57:54.446 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 10:57:54.448 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 10:57:54.448 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-27 10:57:54.752 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-27 10:57:54.752 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-27 10:57:54.752 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-27 10:57:54.752 INFO: Processing datasets for head 'Default'
2025-07-27 10:59:18.114 INFO: Combining 1 list datasets for head 'Default'
2025-07-27 10:59:27.592 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-27 10:59:27.592 INFO: Combined validation datasets for Default
2025-07-27 10:59:27.592 INFO: Head 'Default' training dataset size: 6337
2025-07-27 10:59:27.593 INFO: Computing average number of neighbors
2025-07-27 10:59:36.002 INFO: Average number of neighbors: 68.51643679748439
2025-07-27 10:59:36.003 INFO: During training the following quantities will be reported: energy, forces
2025-07-27 10:59:36.003 INFO: ===========MODEL DETAILS===========
2025-07-27 10:59:43.151 INFO: Loading FOUNDATION model
2025-07-27 10:59:43.153 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-27 10:59:43.153 INFO: Model configuration extracted from foundation model
2025-07-27 10:59:43.153 INFO: Using universal loss function for fine-tuning
2025-07-27 10:59:43.153 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-27 10:59:43.153 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-27 10:59:43.153 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-27 10:59:43.153 INFO: Distance transform for radial basis functions: None
2025-07-27 10:59:44.577 INFO: Total number of parameters: 894362
2025-07-27 10:59:44.577 INFO: 
2025-07-27 10:59:44.577 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-27 10:59:44.577 INFO: Using ADAM as parameter optimizer
2025-07-27 10:59:44.577 INFO: Batch size: 2
2025-07-27 10:59:44.577 INFO: Number of gradient updates: 221795
2025-07-27 10:59:44.577 INFO: Learning rate: 0.0006, weight decay: 1e-08
2025-07-27 10:59:44.577 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-27 10:59:44.581 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-27 10:59:44.582 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-55.pt
2025-07-27 10:59:44.623 INFO: Using gradient clipping with tolerance=30.000
2025-07-27 10:59:44.623 INFO: 
2025-07-27 10:59:44.623 INFO: ===========TRAINING===========
2025-07-27 10:59:44.623 INFO: Started training, reporting errors on validation set
2025-07-27 10:59:44.623 INFO: Loss metrics on validation set
2025-07-27 11:00:59.370 INFO: Initial: head: Default, loss=0.18619642, RMSE_E_per_atom=   10.82 meV, RMSE_F=   32.55 meV / A
2025-07-27 11:33:02.267 INFO: Epoch 55: head: Default, loss=0.18702559, RMSE_E_per_atom=    9.39 meV, RMSE_F=   32.62 meV / A
2025-07-27 12:05:02.642 INFO: Epoch 56: head: Default, loss=0.18131942, RMSE_E_per_atom=    4.13 meV, RMSE_F=   32.10 meV / A
2025-07-27 12:37:03.413 INFO: Epoch 57: head: Default, loss=0.18887828, RMSE_E_per_atom=    9.48 meV, RMSE_F=   32.69 meV / A
2025-07-27 13:09:03.446 INFO: Epoch 58: head: Default, loss=0.18282595, RMSE_E_per_atom=    4.42 meV, RMSE_F=   32.25 meV / A
2025-07-27 13:41:04.142 INFO: Epoch 59: head: Default, loss=0.18757706, RMSE_E_per_atom=    6.84 meV, RMSE_F=   32.61 meV / A
2025-07-27 14:13:02.112 INFO: Epoch 60: head: Default, loss=0.17812609, RMSE_E_per_atom=    2.56 meV, RMSE_F=   31.84 meV / A
2025-07-27 14:45:00.020 INFO: Epoch 61: head: Default, loss=0.18617300, RMSE_E_per_atom=    6.63 meV, RMSE_F=   32.51 meV / A
2025-07-27 15:17:00.473 INFO: Epoch 62: head: Default, loss=0.18519468, RMSE_E_per_atom=    5.90 meV, RMSE_F=   32.38 meV / A
2025-07-27 15:27:09.715 INFO: ===========VERIFYING SETTINGS===========
2025-07-27 15:27:09.715 INFO: MACE version: 0.3.13
2025-07-27 15:27:10.335 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-27 15:27:11.166 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-27 15:27:11.167 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-27 15:27:11.167 INFO: ===========LOADING INPUT DATA===========
2025-07-27 15:27:11.167 INFO: Using heads: ['Default']
2025-07-27 15:27:11.167 INFO: Using the key specifications to parse data:
2025-07-27 15:27:11.167 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-27 15:27:11.167 INFO: =============    Processing head Default     ===========
2025-07-27 15:27:32.226 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 15:27:32.244 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 15:27:34.912 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 15:27:34.914 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 15:27:34.914 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-27 15:27:35.218 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-27 15:27:35.218 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-27 15:27:35.219 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-27 15:27:35.219 INFO: Processing datasets for head 'Default'
2025-07-27 15:28:58.732 INFO: Combining 1 list datasets for head 'Default'
2025-07-27 15:29:08.236 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-27 15:29:08.236 INFO: Combined validation datasets for Default
2025-07-27 15:29:08.236 INFO: Head 'Default' training dataset size: 6337
2025-07-27 15:29:08.237 INFO: Computing average number of neighbors
2025-07-27 15:29:16.079 INFO: Average number of neighbors: 68.51643679748439
2025-07-27 15:29:16.081 INFO: During training the following quantities will be reported: energy, forces
2025-07-27 15:29:16.081 INFO: ===========MODEL DETAILS===========
2025-07-27 15:29:23.226 INFO: Loading FOUNDATION model
2025-07-27 15:29:23.228 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-27 15:29:23.228 INFO: Model configuration extracted from foundation model
2025-07-27 15:29:23.228 INFO: Using universal loss function for fine-tuning
2025-07-27 15:29:23.228 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-27 15:29:23.228 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-27 15:29:23.228 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-27 15:29:23.228 INFO: Distance transform for radial basis functions: None
2025-07-27 15:29:24.581 INFO: Total number of parameters: 894362
2025-07-27 15:29:24.581 INFO: 
2025-07-27 15:29:24.581 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-27 15:29:24.581 INFO: Using ADAM as parameter optimizer
2025-07-27 15:29:24.581 INFO: Batch size: 2
2025-07-27 15:29:24.581 INFO: Number of gradient updates: 221795
2025-07-27 15:29:24.581 INFO: Learning rate: 0.0006, weight decay: 1e-08
2025-07-27 15:29:24.581 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-27 15:29:24.583 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-27 15:29:24.584 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-60.pt
2025-07-27 15:29:24.631 INFO: Using gradient clipping with tolerance=10.000
2025-07-27 15:29:24.631 INFO: 
2025-07-27 15:29:24.631 INFO: ===========TRAINING===========
2025-07-27 15:29:24.631 INFO: Started training, reporting errors on validation set
2025-07-27 15:29:24.631 INFO: Loss metrics on validation set
2025-07-27 15:30:39.427 INFO: Initial: head: Default, loss=0.17812609, RMSE_E_per_atom=    2.56 meV, RMSE_F=   31.84 meV / A
2025-07-27 16:02:41.157 INFO: Epoch 60: head: Default, loss=0.17985062, RMSE_E_per_atom=    9.05 meV, RMSE_F=   31.99 meV / A
2025-07-27 16:20:23.585 INFO: ===========VERIFYING SETTINGS===========
2025-07-27 16:20:23.585 INFO: MACE version: 0.3.13
2025-07-27 16:20:24.325 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-27 16:20:25.010 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-27 16:20:25.013 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-27 16:20:25.013 INFO: ===========LOADING INPUT DATA===========
2025-07-27 16:20:25.013 INFO: Using heads: ['Default']
2025-07-27 16:20:25.013 INFO: Using the key specifications to parse data:
2025-07-27 16:20:25.014 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-27 16:20:25.014 INFO: =============    Processing head Default     ===========
2025-07-27 16:20:46.065 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 16:20:46.082 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-27 16:20:48.673 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 16:20:48.675 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-27 16:20:48.675 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-27 16:20:48.979 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-27 16:20:48.979 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-27 16:20:48.980 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-27 16:20:48.980 INFO: Processing datasets for head 'Default'
2025-07-27 16:22:12.188 INFO: Combining 1 list datasets for head 'Default'
2025-07-27 16:22:21.623 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-27 16:22:21.623 INFO: Combined validation datasets for Default
2025-07-27 16:22:21.623 INFO: Head 'Default' training dataset size: 6337
2025-07-27 16:22:21.624 INFO: Computing average number of neighbors
2025-07-27 16:22:29.360 INFO: Average number of neighbors: 68.51643679748439
2025-07-27 16:22:29.361 INFO: During training the following quantities will be reported: energy, forces
2025-07-27 16:22:29.361 INFO: ===========MODEL DETAILS===========
2025-07-27 16:22:36.483 INFO: Loading FOUNDATION model
2025-07-27 16:22:36.484 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-27 16:22:36.485 INFO: Model configuration extracted from foundation model
2025-07-27 16:22:36.485 INFO: Using universal loss function for fine-tuning
2025-07-27 16:22:36.485 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-27 16:22:36.485 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-27 16:22:36.485 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-27 16:22:36.485 INFO: Distance transform for radial basis functions: None
2025-07-27 16:22:37.909 INFO: Total number of parameters: 894362
2025-07-27 16:22:37.909 INFO: 
2025-07-27 16:22:37.909 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-27 16:22:37.909 INFO: Using ADAM as parameter optimizer
2025-07-27 16:22:37.909 INFO: Batch size: 2
2025-07-27 16:22:37.909 INFO: Number of gradient updates: 193278
2025-07-27 16:22:37.909 INFO: Learning rate: 0.0006, weight decay: 1e-08
2025-07-27 16:22:37.909 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=200.000)
2025-07-27 16:22:37.914 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-27 16:22:37.914 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-60.pt
2025-07-27 16:22:37.962 INFO: Using gradient clipping with tolerance=10.000
2025-07-27 16:22:37.962 INFO: 
2025-07-27 16:22:37.962 INFO: ===========TRAINING===========
2025-07-27 16:22:37.962 INFO: Started training, reporting errors on validation set
2025-07-27 16:22:37.962 INFO: Loss metrics on validation set
2025-07-27 16:23:52.755 INFO: Initial: head: Default, loss=0.17985062, RMSE_E_per_atom=    9.05 meV, RMSE_F=   31.99 meV / A
2025-07-27 16:55:54.305 INFO: Epoch 60: head: Default, loss=0.17877602, RMSE_E_per_atom=    9.06 meV, RMSE_F=   31.90 meV / A
2025-07-27 16:55:54.411 INFO: Training complete
2025-07-27 16:55:54.411 INFO: 
2025-07-27 16:55:54.411 INFO: ===========RESULTS===========
2025-07-27 16:55:54.415 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_h200_cn10_run-21_epoch-60.pt
2025-07-27 16:55:54.447 INFO: Loaded Stage one model from epoch 60 for evaluation
2025-07-27 16:55:54.447 INFO: Saving model to checkpoints/mace_T1_finetune_h200_cn10_run-21.model
2025-07-27 16:55:54.713 INFO: Compiling model, saving metadata to mace_T1_finetune_h200_cn10_compiled.model
2025-07-27 16:55:55.329 INFO: Computing metrics for training, validation, and test sets
2025-07-27 16:55:55.330 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-27 16:55:55.330 INFO: Evaluating train_Default ...
2025-07-27 17:07:56.375 INFO: Evaluating valid_Default ...
2025-07-27 17:09:09.347 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+---------------+---------------------+------------------+-------------------+
| train_Default |            9.1      |         32.3     |          9.38     |
| valid_Default |            9.1      |         31.9     |          9.28     |
+---------------+---------------------+------------------+-------------------+
