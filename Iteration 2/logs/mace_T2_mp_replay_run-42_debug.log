2025-08-18 01:20:24.666 INFO: ===========VERIFYING SETTINGS===========
2025-08-18 01:20:24.666 INFO: MACE version: 0.3.14
2025-08-18 01:20:24.666 DEBUG: Configuration: Namespace(config=None, name='mace_T2_mp_replay', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_it_2_isolated.extxyz', valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/val_it2.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.9089228666666667, 8: -4.947961005 , 40: -8.54770063 , 57: -4.936007105}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/mp_traj_combinedxyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=40.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0002, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=2.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-18 01:20:25.230 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-18 01:20:25.328 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/Iteration 2, stdin=None, shell=False, universal_newlines=False)
2025-08-18 01:20:25.333 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/Iteration 2, stdin=None, shell=False, universal_newlines=False)
2025-08-18 01:20:25.343 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-18 01:20:25.353 DEBUG: Current Git commit: 1d90e32d2a2ab1a0f37f8f552c105b53a5efa803
2025-08-18 01:20:25.736 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-18 01:20:25.737 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-18 01:20:25.737 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-18 01:20:25.737 INFO: ===========LOADING INPUT DATA===========
2025-08-18 01:20:25.737 INFO: Using heads: ['Default', 'pt_head']
2025-08-18 01:20:25.737 INFO: Using the key specifications to parse data:
2025-08-18 01:20:25.737 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-18 01:20:25.737 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-18 01:20:25.737 INFO: =============    Processing head Default     ===========
2025-08-18 01:20:25.739 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_it_2_isolated.extxyz
2025-08-18 01:20:31.182 INFO: Using isolated atom energies from training file
2025-08-18 01:20:31.399 INFO: Training set 1/1 [energy: 2812, stress: 0, virials: 0, dipole components: 0, head: 2812, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2812, charges: 0]
2025-08-18 01:20:31.409 INFO: Total Training set [energy: 2812, stress: 0, virials: 0, dipole components: 0, head: 2812, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2812, charges: 0]
2025-08-18 01:20:34.075 INFO: Validation set 1/1 [energy: 2505, stress: 0, virials: 0, dipole components: 0, head: 2505, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2505, charges: 0]
2025-08-18 01:20:34.082 INFO: Total Validation set [energy: 2505, stress: 0, virials: 0, dipole components: 0, head: 2505, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2505, charges: 0]
2025-08-18 01:20:34.082 DEBUG: Element 3 found in 1 file. Using E0: -1.908923 eV
2025-08-18 01:20:34.082 DEBUG: Element 8 found in 1 file. Using E0: -4.947961 eV
2025-08-18 01:20:34.082 DEBUG: Element 40 found in 1 file. Using E0: -8.547701 eV
2025-08-18 01:20:34.082 DEBUG: Element 57 found in 1 file. Using E0: -4.936007 eV
2025-08-18 01:20:34.082 INFO: Total number of configurations: train=2812, valid=2505, tests=[],
2025-08-18 01:20:34.082 INFO: =============    Processing head pt_head     ===========
2025-08-18 01:20:34.083 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/mp_traj_combinedxyz
2025-08-18 01:21:17.211 INFO: Training set 1/1 [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 145923, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 01:21:17.622 INFO: Total Training set [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 145923, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 01:21:17.622 INFO: No validation set provided, splitting training data instead.
2025-08-18 01:21:17.634 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_42.txt
2025-08-18 01:21:18.105 INFO: Random Split Training set [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 131331, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 01:21:18.157 INFO: Random Split Validation set [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 14592, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 01:21:18.157 INFO: Total number of configurations: train=131331, valid=14592, tests=[],
2025-08-18 01:21:18.158 INFO: ==================Using multiheads finetuning mode==================
2025-08-18 01:21:18.158 INFO: Total number of configurations in pretraining: train=131331, valid=14592
2025-08-18 01:21:18.159 INFO: Using atomic numbers from command line argument
2025-08-18 01:21:18.159 INFO: Using atomic numbers from command line argument
2025-08-18 01:21:18.159 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-08-18 01:21:18.161 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.9089228666666667, 8: -4.947961005, 40: -8.54770063, 57: -4.936007105}
2025-08-18 01:21:18.161 INFO: Atomic Energies used (z: eV) for head pt_head: {3: -3.482100566595956, 8: -7.28459863421322, 40: -11.846857579882572, 57: -8.933684809576345}
2025-08-18 01:21:18.161 INFO: Processing datasets for head 'Default'
2025-08-18 01:21:37.989 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_it_2_isolated.extxyz']
2025-08-18 01:21:37.989 INFO: Combining 1 list datasets for head 'Default'
2025-08-18 01:21:47.325 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/val_it2.extxyz']
2025-08-18 01:21:47.325 INFO: Combining 1 list datasets for head 'Default_valid'
2025-08-18 01:21:47.325 INFO: Combined validation datasets for Default
2025-08-18 01:21:47.325 INFO: Head 'Default' training dataset size: 2812
2025-08-18 01:21:47.325 INFO: Processing datasets for head 'pt_head'
2025-08-18 02:06:54.023 INFO: ===========VERIFYING SETTINGS===========
2025-08-18 02:06:54.023 INFO: MACE version: 0.3.14
2025-08-18 02:06:54.023 DEBUG: Configuration: Namespace(config=None, name='mace_T2_mp_replay', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_it_2_isolated.extxyz', valid_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/val_it2.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.9089228666666667, 8: -4.947961005 , 40: -8.54770063 , 57: -4.936007105}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file='/home/phanim/harshitrawat/summer/T1_T2_T3_data/mp_traj_LiOZrLa_10k.extxyz', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=40.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0002, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=4, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=130, patience=8, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=2.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-08-18 02:06:54.662 INFO: CUDA version: 12.6, CUDA device: 0
2025-08-18 02:06:54.800 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/Iteration 2, stdin=None, shell=False, universal_newlines=False)
2025-08-18 02:06:54.805 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer/Iteration 2, stdin=None, shell=False, universal_newlines=False)
2025-08-18 02:06:54.813 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-08-18 02:06:54.822 DEBUG: Current Git commit: 1d90e32d2a2ab1a0f37f8f552c105b53a5efa803
2025-08-18 02:06:55.168 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-08-18 02:06:55.169 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-08-18 02:06:55.170 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-08-18 02:06:55.170 INFO: ===========LOADING INPUT DATA===========
2025-08-18 02:06:55.170 INFO: Using heads: ['Default', 'pt_head']
2025-08-18 02:06:55.170 INFO: Using the key specifications to parse data:
2025-08-18 02:06:55.170 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-18 02:06:55.170 INFO: pt_head: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-08-18 02:06:55.170 INFO: =============    Processing head Default     ===========
2025-08-18 02:06:55.171 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_it_2_isolated.extxyz
2025-08-18 02:07:00.595 INFO: Using isolated atom energies from training file
2025-08-18 02:07:00.801 INFO: Training set 1/1 [energy: 2812, stress: 0, virials: 0, dipole components: 0, head: 2812, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2812, charges: 0]
2025-08-18 02:07:00.808 INFO: Total Training set [energy: 2812, stress: 0, virials: 0, dipole components: 0, head: 2812, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2812, charges: 0]
2025-08-18 02:07:03.486 INFO: Validation set 1/1 [energy: 2505, stress: 0, virials: 0, dipole components: 0, head: 2505, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2505, charges: 0]
2025-08-18 02:07:03.493 INFO: Total Validation set [energy: 2505, stress: 0, virials: 0, dipole components: 0, head: 2505, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 2505, charges: 0]
2025-08-18 02:07:03.493 DEBUG: Element 3 found in 1 file. Using E0: -1.908923 eV
2025-08-18 02:07:03.493 DEBUG: Element 8 found in 1 file. Using E0: -4.947961 eV
2025-08-18 02:07:03.493 DEBUG: Element 40 found in 1 file. Using E0: -8.547701 eV
2025-08-18 02:07:03.493 DEBUG: Element 57 found in 1 file. Using E0: -4.936007 eV
2025-08-18 02:07:03.493 INFO: Total number of configurations: train=2812, valid=2505, tests=[],
2025-08-18 02:07:03.493 INFO: =============    Processing head pt_head     ===========
2025-08-18 02:07:03.494 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/T1_T2_T3_data/mp_traj_LiOZrLa_10k.extxyz
2025-08-18 02:07:03.539 INFO: Training set 1/1 [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 02:07:03.539 INFO: Total Training set [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 142, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 02:07:03.539 INFO: No validation set provided, splitting training data instead.
2025-08-18 02:07:03.543 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_42.txt
2025-08-18 02:07:03.543 INFO: Random Split Training set [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 128, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 02:07:03.544 INFO: Random Split Validation set [energy: 0, stress: 0, virials: 0, dipole components: 0, head: 14, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 0, charges: 0]
2025-08-18 02:07:03.544 INFO: Total number of configurations: train=128, valid=14, tests=[],
2025-08-18 02:07:03.544 INFO: ==================Using multiheads finetuning mode==================
2025-08-18 02:07:03.544 INFO: Total number of configurations in pretraining: train=128, valid=14
2025-08-18 02:07:03.544 INFO: Using atomic numbers from command line argument
2025-08-18 02:07:03.544 INFO: Using atomic numbers from command line argument
2025-08-18 02:07:03.544 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-08-18 02:07:03.546 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.9089228666666667, 8: -4.947961005, 40: -8.54770063, 57: -4.936007105}
2025-08-18 02:07:03.546 INFO: Atomic Energies used (z: eV) for head pt_head: {3: -3.482100566595956, 8: -7.28459863421322, 40: -11.846857579882572, 57: -8.933684809576345}
2025-08-18 02:07:03.546 INFO: Processing datasets for head 'Default'
2025-08-18 02:07:23.689 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/T2_it_2_isolated.extxyz']
2025-08-18 02:07:23.690 INFO: Combining 1 list datasets for head 'Default'
2025-08-18 02:07:32.970 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/val_it2.extxyz']
2025-08-18 02:07:32.970 INFO: Combining 1 list datasets for head 'Default_valid'
2025-08-18 02:07:32.970 INFO: Combined validation datasets for Default
2025-08-18 02:07:32.970 INFO: Head 'Default' training dataset size: 2812
2025-08-18 02:07:32.970 INFO: Processing datasets for head 'pt_head'
2025-08-18 02:07:33.071 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/T1_T2_T3_data/mp_traj_LiOZrLa_10k.extxyz']
2025-08-18 02:07:33.071 INFO: Combining 1 list datasets for head 'pt_head'
2025-08-18 02:07:33.075 INFO: Head 'pt_head' training dataset size: 128
2025-08-18 02:07:33.076 INFO: Average number of neighbors: 61.964672446250916
2025-08-18 02:07:33.076 INFO: During training the following quantities will be reported: energy, forces, stress
2025-08-18 02:07:33.076 INFO: ===========MODEL DETAILS===========
2025-08-18 02:07:35.353 WARNING: Standard deviation of the scaling is zero, Changing to no scaling
2025-08-18 02:07:35.356 INFO: Loading FOUNDATION model
2025-08-18 02:07:35.357 INFO: Using filtered elements: [3, 8, 40, 57]
2025-08-18 02:07:35.357 INFO: Model configuration extracted from foundation model
2025-08-18 02:07:35.357 INFO: Using universal loss function for fine-tuning
2025-08-18 02:07:35.357 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-08-18 02:07:35.357 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-08-18 02:07:35.357 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-08-18 02:07:35.357 INFO: Distance transform for radial basis functions: None
2025-08-18 02:07:36.582 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.4821, -7.2846, -11.8469, -8.9337], [-1.9089, -4.9480, -8.5477, -4.9360]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 2x0e | 256 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 32x0e | 4096 weights)
      (non_linearity): Activation [x] (32x0e -> 32x0e)
      (linear_2): Linear(32x0e -> 2x0e | 64 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, 0.8042, shift=0.1641, 0.1641)
)
2025-08-18 02:07:36.583 INFO: Total number of parameters: 896586
2025-08-18 02:07:36.583 INFO: 
2025-08-18 02:07:36.583 INFO: ===========OPTIMIZER INFORMATION===========
2025-08-18 02:07:36.583 INFO: Using ADAM as parameter optimizer
2025-08-18 02:07:36.583 INFO: Batch size: 2
2025-08-18 02:07:36.583 INFO: Using Exponential Moving Average with decay: 0.99999
2025-08-18 02:07:36.583 INFO: Number of gradient updates: 191100
2025-08-18 02:07:36.583 INFO: Learning rate: 0.0001, weight decay: 1e-08
2025-08-18 02:07:36.583 INFO: UniversalLoss(energy_weight=10.000, forces_weight=40.000, stress_weight=1.000)
2025-08-18 02:07:36.591 WARNING: Cannot find checkpoint with tag 'mace_T2_mp_replay_run-42' in './checkpoints'
2025-08-18 02:07:36.592 INFO: Using gradient clipping with tolerance=2.000
2025-08-18 02:07:36.592 INFO: 
2025-08-18 02:07:36.592 INFO: ===========TRAINING===========
2025-08-18 02:07:36.592 INFO: Started training, reporting errors on validation set
2025-08-18 02:07:36.592 INFO: Loss metrics on validation set
2025-08-18 02:07:39.451 INFO: Initial: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 6464.13 meV, RMSE_F=   59.46 meV / A, RMSE_stress=    4.63 meV / A^3
2025-08-18 02:12:10.435 INFO: Initial: head: Default, loss=17908.05805810, RMSE_E_per_atom=194676739.70 meV, RMSE_F=1092913895.41 meV / A, RMSE_stress=11844695.92 meV / A^3
2025-08-18 02:20:50.722 INFO: Epoch 0: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 7713.78 meV, RMSE_F=  252.01 meV / A, RMSE_stress=   28.60 meV / A^3
2025-08-18 02:25:19.731 INFO: Epoch 0: head: Default, loss=122.60236615, RMSE_E_per_atom=979479.64 meV, RMSE_F=5453136.97 meV / A, RMSE_stress=90360.29 meV / A^3
2025-08-18 02:25:19.734 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-0.pt
2025-08-18 02:33:57.047 INFO: Epoch 1: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8032.06 meV, RMSE_F=  225.26 meV / A, RMSE_stress=   50.34 meV / A^3
2025-08-18 02:38:26.391 INFO: Epoch 1: head: Default, loss=39.76872521, RMSE_E_per_atom=302523.09 meV, RMSE_F=1691195.40 meV / A, RMSE_stress=27713.43 meV / A^3
2025-08-18 02:38:26.394 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-0.pt
2025-08-18 02:38:26.417 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-1.pt
2025-08-18 02:47:03.684 INFO: Epoch 2: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8162.63 meV, RMSE_F=  217.77 meV / A, RMSE_stress=   53.94 meV / A^3
2025-08-18 02:51:32.447 INFO: Epoch 2: head: Default, loss=16.99305871, RMSE_E_per_atom=100064.03 meV, RMSE_F=553618.20 meV / A, RMSE_stress=11896.15 meV / A^3
2025-08-18 02:51:32.450 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-1.pt
2025-08-18 02:51:32.483 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-2.pt
2025-08-18 03:00:09.999 INFO: Epoch 3: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8264.11 meV, RMSE_F=  205.75 meV / A, RMSE_stress=   70.25 meV / A^3
2025-08-18 03:04:38.805 INFO: Epoch 3: head: Default, loss=11.28089690, RMSE_E_per_atom=44948.04 meV, RMSE_F=286131.68 meV / A, RMSE_stress= 7471.28 meV / A^3
2025-08-18 03:04:38.808 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-2.pt
2025-08-18 03:04:38.830 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-3.pt
2025-08-18 03:13:16.592 INFO: Epoch 4: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8368.71 meV, RMSE_F=  196.50 meV / A, RMSE_stress=   74.71 meV / A^3
2025-08-18 03:17:44.911 INFO: Epoch 4: head: Default, loss=9.02257265, RMSE_E_per_atom=27787.11 meV, RMSE_F=170317.76 meV / A, RMSE_stress= 5081.02 meV / A^3
2025-08-18 03:17:44.914 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-3.pt
2025-08-18 03:17:44.982 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-4.pt
2025-08-18 03:26:22.374 INFO: Epoch 5: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8453.27 meV, RMSE_F=  168.99 meV / A, RMSE_stress=   79.02 meV / A^3
2025-08-18 03:30:49.753 INFO: Epoch 5: head: Default, loss=7.75411816, RMSE_E_per_atom=12575.12 meV, RMSE_F=103908.07 meV / A, RMSE_stress= 3630.12 meV / A^3
2025-08-18 03:30:49.756 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-4.pt
2025-08-18 03:30:49.808 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-5.pt
2025-08-18 03:39:27.131 INFO: Epoch 6: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8495.59 meV, RMSE_F=  174.62 meV / A, RMSE_stress=   81.17 meV / A^3
2025-08-18 03:43:57.089 INFO: Epoch 6: head: Default, loss=6.41531662, RMSE_E_per_atom=10674.60 meV, RMSE_F=72593.61 meV / A, RMSE_stress= 2826.21 meV / A^3
2025-08-18 03:43:57.092 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-5.pt
2025-08-18 03:43:57.143 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-6.pt
2025-08-18 03:52:34.366 INFO: Epoch 7: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8542.33 meV, RMSE_F=  176.02 meV / A, RMSE_stress=   81.72 meV / A^3
2025-08-18 03:57:06.630 INFO: Epoch 7: head: Default, loss=6.29158229, RMSE_E_per_atom=10410.93 meV, RMSE_F=69366.93 meV / A, RMSE_stress= 2678.96 meV / A^3
2025-08-18 03:57:06.633 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-6.pt
2025-08-18 03:57:06.661 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-7.pt
2025-08-18 04:05:44.254 INFO: Epoch 8: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8570.55 meV, RMSE_F=  189.58 meV / A, RMSE_stress=   77.03 meV / A^3
2025-08-18 04:10:16.781 INFO: Epoch 8: head: Default, loss=6.07641530, RMSE_E_per_atom= 9614.31 meV, RMSE_F=66432.99 meV / A, RMSE_stress= 2512.30 meV / A^3
2025-08-18 04:10:16.784 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-7.pt
2025-08-18 04:10:16.822 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-8.pt
2025-08-18 04:18:54.171 INFO: Epoch 9: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8586.66 meV, RMSE_F=  196.01 meV / A, RMSE_stress=   76.23 meV / A^3
2025-08-18 04:23:25.016 INFO: Epoch 9: head: Default, loss=5.89912468, RMSE_E_per_atom= 9009.38 meV, RMSE_F=66165.98 meV / A, RMSE_stress= 2460.04 meV / A^3
2025-08-18 04:23:25.018 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-8.pt
2025-08-18 04:23:25.080 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-9.pt
2025-08-18 04:32:02.603 INFO: Epoch 10: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8586.88 meV, RMSE_F=  200.56 meV / A, RMSE_stress=   76.35 meV / A^3
2025-08-18 04:36:33.190 INFO: Epoch 10: head: Default, loss=5.74605525, RMSE_E_per_atom= 8883.95 meV, RMSE_F=63734.82 meV / A, RMSE_stress= 2350.59 meV / A^3
2025-08-18 04:36:33.194 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-9.pt
2025-08-18 04:36:33.231 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-10.pt
2025-08-18 04:45:11.216 INFO: Epoch 11: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8587.07 meV, RMSE_F=  213.52 meV / A, RMSE_stress=   68.97 meV / A^3
2025-08-18 04:49:42.384 INFO: Epoch 11: head: Default, loss=5.71513113, RMSE_E_per_atom= 9045.18 meV, RMSE_F=62705.40 meV / A, RMSE_stress= 2312.85 meV / A^3
2025-08-18 04:49:42.387 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-10.pt
2025-08-18 04:49:42.435 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-11.pt
2025-08-18 04:58:19.508 INFO: Epoch 12: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8596.18 meV, RMSE_F=  204.27 meV / A, RMSE_stress=   65.75 meV / A^3
2025-08-18 05:02:50.990 INFO: Epoch 12: head: Default, loss=5.42812787, RMSE_E_per_atom= 9316.04 meV, RMSE_F=61167.95 meV / A, RMSE_stress= 2283.22 meV / A^3
2025-08-18 05:02:50.992 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-11.pt
2025-08-18 05:02:51.015 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-12.pt
2025-08-18 05:11:28.512 INFO: Epoch 13: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8606.86 meV, RMSE_F=  203.05 meV / A, RMSE_stress=   60.61 meV / A^3
2025-08-18 05:15:59.589 INFO: Epoch 13: head: Default, loss=5.18439529, RMSE_E_per_atom= 9127.74 meV, RMSE_F=53557.41 meV / A, RMSE_stress= 2102.03 meV / A^3
2025-08-18 05:15:59.592 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-12.pt
2025-08-18 05:15:59.597 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-13.pt
2025-08-18 05:24:37.637 INFO: Epoch 14: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8610.31 meV, RMSE_F=  206.93 meV / A, RMSE_stress=   57.83 meV / A^3
2025-08-18 05:29:08.584 INFO: Epoch 14: head: Default, loss=4.97210047, RMSE_E_per_atom= 9281.27 meV, RMSE_F=49270.47 meV / A, RMSE_stress= 2022.11 meV / A^3
2025-08-18 05:29:08.587 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-13.pt
2025-08-18 05:29:08.592 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-14.pt
2025-08-18 05:37:46.541 INFO: Epoch 15: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8623.79 meV, RMSE_F=  212.51 meV / A, RMSE_stress=   57.70 meV / A^3
2025-08-18 05:42:17.911 INFO: Epoch 15: head: Default, loss=4.92268821, RMSE_E_per_atom= 9304.01 meV, RMSE_F=49176.40 meV / A, RMSE_stress= 2011.03 meV / A^3
2025-08-18 05:42:17.914 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-14.pt
2025-08-18 05:42:17.949 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-15.pt
2025-08-18 05:50:55.659 INFO: Epoch 16: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8628.89 meV, RMSE_F=  222.01 meV / A, RMSE_stress=   56.16 meV / A^3
2025-08-18 05:55:27.671 INFO: Epoch 16: head: Default, loss=4.76537161, RMSE_E_per_atom= 9579.79 meV, RMSE_F=47578.74 meV / A, RMSE_stress= 1973.67 meV / A^3
2025-08-18 05:55:27.675 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-15.pt
2025-08-18 05:55:27.679 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-16.pt
2025-08-18 06:04:05.515 INFO: Epoch 17: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8623.46 meV, RMSE_F=  230.45 meV / A, RMSE_stress=   51.66 meV / A^3
2025-08-18 06:08:36.655 INFO: Epoch 17: head: Default, loss=4.67510773, RMSE_E_per_atom= 9714.34 meV, RMSE_F=47979.77 meV / A, RMSE_stress= 1946.14 meV / A^3
2025-08-18 06:08:36.657 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-16.pt
2025-08-18 06:08:36.662 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-17.pt
2025-08-18 06:17:14.636 INFO: Epoch 18: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8631.80 meV, RMSE_F=  247.43 meV / A, RMSE_stress=   49.37 meV / A^3
2025-08-18 06:21:47.362 INFO: Epoch 18: head: Default, loss=4.64128617, RMSE_E_per_atom= 9801.22 meV, RMSE_F=47831.02 meV / A, RMSE_stress= 1965.03 meV / A^3
2025-08-18 06:21:47.365 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-17.pt
2025-08-18 06:21:47.370 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-18.pt
2025-08-18 06:30:25.378 INFO: Epoch 19: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8637.37 meV, RMSE_F=  263.31 meV / A, RMSE_stress=   46.28 meV / A^3
2025-08-18 06:34:58.784 INFO: Epoch 19: head: Default, loss=4.55579590, RMSE_E_per_atom=10101.32 meV, RMSE_F=48665.51 meV / A, RMSE_stress= 1989.25 meV / A^3
2025-08-18 06:34:58.787 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-18.pt
2025-08-18 06:34:58.823 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-19.pt
2025-08-18 06:43:36.298 INFO: Epoch 20: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8641.02 meV, RMSE_F=  269.16 meV / A, RMSE_stress=   44.07 meV / A^3
2025-08-18 06:48:05.544 INFO: Epoch 20: head: Default, loss=4.54232832, RMSE_E_per_atom=10098.43 meV, RMSE_F=48059.15 meV / A, RMSE_stress= 1951.93 meV / A^3
2025-08-18 06:48:05.547 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-19.pt
2025-08-18 06:48:05.594 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-20.pt
2025-08-18 06:56:43.337 INFO: Epoch 21: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8641.99 meV, RMSE_F=  273.92 meV / A, RMSE_stress=   43.05 meV / A^3
2025-08-18 07:01:11.814 INFO: Epoch 21: head: Default, loss=4.53107817, RMSE_E_per_atom=10222.51 meV, RMSE_F=47744.36 meV / A, RMSE_stress= 1936.08 meV / A^3
2025-08-18 07:01:11.817 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-20.pt
2025-08-18 07:01:11.821 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-21.pt
2025-08-18 07:09:49.566 INFO: Epoch 22: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8639.77 meV, RMSE_F=  272.04 meV / A, RMSE_stress=   42.46 meV / A^3
2025-08-18 07:14:20.626 INFO: Epoch 22: head: Default, loss=4.42644090, RMSE_E_per_atom=10248.94 meV, RMSE_F=47001.53 meV / A, RMSE_stress= 1912.85 meV / A^3
2025-08-18 07:14:20.629 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T2_mp_replay_run-42_epoch-21.pt
2025-08-18 07:14:20.634 DEBUG: Saving checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-22.pt
2025-08-18 07:22:58.398 INFO: Epoch 23: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8645.35 meV, RMSE_F=  270.26 meV / A, RMSE_stress=   41.19 meV / A^3
2025-08-18 07:27:28.850 INFO: Epoch 23: head: Default, loss=4.49671726, RMSE_E_per_atom=10195.45 meV, RMSE_F=47164.12 meV / A, RMSE_stress= 1897.62 meV / A^3
2025-08-18 07:36:06.501 INFO: Epoch 24: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8650.43 meV, RMSE_F=  265.81 meV / A, RMSE_stress=   40.45 meV / A^3
2025-08-18 07:40:36.899 INFO: Epoch 24: head: Default, loss=4.60010653, RMSE_E_per_atom=10198.85 meV, RMSE_F=48266.26 meV / A, RMSE_stress= 1895.14 meV / A^3
2025-08-18 07:49:14.229 INFO: Epoch 25: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8656.42 meV, RMSE_F=  262.80 meV / A, RMSE_stress=   40.25 meV / A^3
2025-08-18 07:53:44.499 INFO: Epoch 25: head: Default, loss=4.62569206, RMSE_E_per_atom= 9849.55 meV, RMSE_F=47560.92 meV / A, RMSE_stress= 1866.71 meV / A^3
2025-08-18 08:02:21.839 INFO: Epoch 26: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8664.13 meV, RMSE_F=  268.24 meV / A, RMSE_stress=   40.39 meV / A^3
2025-08-18 08:06:52.550 INFO: Epoch 26: head: Default, loss=4.53235229, RMSE_E_per_atom= 9631.92 meV, RMSE_F=46600.32 meV / A, RMSE_stress= 1822.38 meV / A^3
2025-08-18 08:15:29.940 INFO: Epoch 27: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8667.62 meV, RMSE_F=  269.54 meV / A, RMSE_stress=   40.22 meV / A^3
2025-08-18 08:19:59.451 INFO: Epoch 27: head: Default, loss=4.62623444, RMSE_E_per_atom= 9587.17 meV, RMSE_F=47323.28 meV / A, RMSE_stress= 1829.14 meV / A^3
2025-08-18 08:28:36.772 INFO: Epoch 28: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8672.87 meV, RMSE_F=  266.43 meV / A, RMSE_stress=   39.85 meV / A^3
2025-08-18 08:33:07.204 INFO: Epoch 28: head: Default, loss=4.51291062, RMSE_E_per_atom= 9636.29 meV, RMSE_F=47283.06 meV / A, RMSE_stress= 1822.53 meV / A^3
2025-08-18 08:41:44.627 INFO: Epoch 29: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8674.96 meV, RMSE_F=  270.18 meV / A, RMSE_stress=   39.80 meV / A^3
2025-08-18 08:46:17.102 INFO: Epoch 29: head: Default, loss=4.56747422, RMSE_E_per_atom= 9887.47 meV, RMSE_F=48590.12 meV / A, RMSE_stress= 1849.54 meV / A^3
2025-08-18 08:54:54.759 INFO: Epoch 30: head: pt_head, loss=0.00000000, RMSE_E_per_atom= 8676.86 meV, RMSE_F=  272.09 meV / A, RMSE_stress=   40.69 meV / A^3
2025-08-18 08:59:26.416 INFO: Epoch 30: head: Default, loss=4.62503571, RMSE_E_per_atom= 9919.07 meV, RMSE_F=49096.35 meV / A, RMSE_stress= 1849.61 meV / A^3
2025-08-18 08:59:26.418 INFO: Stopping optimization after 8 epochs without improvement
2025-08-18 08:59:26.418 INFO: Training complete
2025-08-18 08:59:26.418 INFO: 
2025-08-18 08:59:26.418 INFO: ===========RESULTS===========
2025-08-18 08:59:26.430 INFO: Loading checkpoint: ./checkpoints/mace_T2_mp_replay_run-42_epoch-22.pt
2025-08-18 08:59:26.467 INFO: Loaded Stage one model from epoch 22 for evaluation
2025-08-18 08:59:26.467 INFO: Saving model to checkpoints/mace_T2_mp_replay_run-42.model
2025-08-18 08:59:26.943 INFO: Compiling model, saving metadata to mace_T2_mp_replay_compiled.model
2025-08-18 08:59:27.522 INFO: Computing metrics for training, validation, and test sets
2025-08-18 08:59:27.522 INFO: Skipping evaluation for heads: ['pt_head']
2025-08-18 08:59:27.522 INFO: Evaluating train_Default ...
2025-08-18 09:03:05.841 INFO: Skipping evaluation of train_pt_head (in skip_heads list)
2025-08-18 09:03:05.843 INFO: Evaluating valid_Default ...
2025-08-18 09:07:35.819 INFO: Skipping evaluation of valid_pt_head (in skip_heads list)
2025-08-18 09:07:35.857 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+---------------------------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % | RMSE Stress (Virials) / meV / A (A^3) |
+---------------+---------------------+------------------+-------------------+---------------------------------------+
| train_Default |          438.0      |       1444.4     |         62.92     |                   215.6               |
| valid_Default |        10248.9      |      47001.5     |       1150.06     |                  1912.8               |
+---------------+---------------------+------------------+-------------------+---------------------------------------+
2025-08-18 09:07:35.857 DEBUG: Running inference on train_Default dataset
2025-08-18 09:11:47.432 DEBUG: Running inference on train_pt_head dataset
2025-08-18 09:11:48.900 DEBUG: Running inference on valid_pt_head dataset
2025-08-18 09:11:49.178 DEBUG: Running inference on valid_Default dataset
2025-08-18 09:19:02.924 INFO: Done
