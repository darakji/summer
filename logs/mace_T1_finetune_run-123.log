2025-07-23 13:42:35.870 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 13:42:35.870 INFO: MACE version: 0.3.13
2025-07-23 13:42:36.358 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 13:42:37.184 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 13:42:37.185 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 13:42:37.185 INFO: ===========LOADING INPUT DATA===========
2025-07-23 13:42:37.185 INFO: Using heads: ['Default']
2025-07-23 13:42:37.185 INFO: Using the key specifications to parse data:
2025-07-23 13:42:37.185 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 13:42:37.185 INFO: =============    Processing head Default     ===========
2025-07-23 13:42:58.332 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 13:42:58.352 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 13:42:58.352 INFO: No validation set provided, splitting training data instead.
2025-07-23 13:42:58.355 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 13:42:58.374 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 13:42:58.376 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 13:42:58.376 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 13:42:58.661 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 13:42:58.661 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 13:42:58.661 INFO: Atomic Energies used (z: eV) for head Default: {3: 0.0, 8: 0.0, 40: 0.0, 57: 0.0}
2025-07-23 13:42:58.661 INFO: Processing datasets for head 'Default'
2025-07-23 13:44:13.405 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 13:44:22.156 INFO: Head 'Default' training dataset size: 5704
2025-07-23 13:44:22.156 INFO: Computing average number of neighbors
2025-07-23 13:44:27.642 INFO: Average number of neighbors: 68.38162827085245
2025-07-23 13:44:27.643 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 13:44:27.643 INFO: ===========MODEL DETAILS===========
2025-07-23 13:44:32.098 INFO: Loading FOUNDATION model
2025-07-23 13:44:32.099 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 13:44:32.100 INFO: Model configuration extracted from foundation model
2025-07-23 13:44:32.100 INFO: Using universal loss function for fine-tuning
2025-07-23 13:44:32.100 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 13:44:32.100 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 13:44:32.100 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 13:44:32.100 INFO: Distance transform for radial basis functions: None
2025-07-23 13:44:33.475 INFO: Total number of parameters: 894362
2025-07-23 13:44:33.475 INFO: 
2025-07-23 13:44:33.475 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 13:44:33.475 INFO: Using ADAM as parameter optimizer
2025-07-23 13:44:33.475 INFO: Batch size: 4
2025-07-23 13:44:33.475 INFO: Number of gradient updates: 427800
2025-07-23 13:44:33.475 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 13:44:33.475 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 13:44:33.476 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 13:44:33.476 INFO: 
2025-07-23 13:44:33.476 INFO: ===========TRAINING===========
2025-07-23 13:44:33.476 INFO: Started training, reporting errors on validation set
2025-07-23 13:44:33.476 INFO: Loss metrics on validation set
2025-07-23 14:17:58.391 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 14:17:58.391 INFO: MACE version: 0.3.13
2025-07-23 14:17:58.928 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 14:17:59.558 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 14:17:59.559 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 14:17:59.559 INFO: ===========LOADING INPUT DATA===========
2025-07-23 14:17:59.559 INFO: Using heads: ['Default']
2025-07-23 14:17:59.559 INFO: Using the key specifications to parse data:
2025-07-23 14:17:59.559 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 14:17:59.559 INFO: =============    Processing head Default     ===========
2025-07-23 14:18:20.638 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:18:20.656 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:18:20.656 INFO: No validation set provided, splitting training data instead.
2025-07-23 14:18:20.659 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 14:18:20.677 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 14:18:20.679 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 14:18:20.679 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 14:18:20.964 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 14:18:20.964 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 14:18:20.964 INFO: Atomic Energies used (z: eV) for head Default: {3: 0.0, 8: 0.0, 40: 0.0, 57: 0.0}
2025-07-23 14:18:20.965 INFO: Processing datasets for head 'Default'
2025-07-23 14:18:45.627 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 14:18:45.628 INFO: MACE version: 0.3.13
2025-07-23 14:18:46.319 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 14:18:46.727 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 14:18:46.728 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 14:18:46.729 INFO: ===========LOADING INPUT DATA===========
2025-07-23 14:18:46.729 INFO: Using heads: ['Default']
2025-07-23 14:18:46.729 INFO: Using the key specifications to parse data:
2025-07-23 14:18:46.729 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 14:18:46.729 INFO: =============    Processing head Default     ===========
2025-07-23 14:19:07.876 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:19:07.894 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:19:07.894 INFO: No validation set provided, splitting training data instead.
2025-07-23 14:19:07.898 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 14:19:07.916 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 14:19:07.918 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 14:19:07.918 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 14:19:08.188 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 14:19:08.188 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 14:19:08.189 INFO: Atomic Energies used (z: eV) for head Default: {3: 0.0, 8: 0.0, 40: 0.0, 57: 0.0}
2025-07-23 14:19:08.189 INFO: Processing datasets for head 'Default'
2025-07-23 14:20:23.200 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 14:20:31.991 INFO: Head 'Default' training dataset size: 5704
2025-07-23 14:20:31.992 INFO: Computing average number of neighbors
2025-07-23 14:20:37.526 INFO: Average number of neighbors: 68.38162827085245
2025-07-23 14:20:37.528 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 14:20:37.528 INFO: ===========MODEL DETAILS===========
2025-07-23 14:20:41.896 INFO: Loading FOUNDATION model
2025-07-23 14:20:41.897 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 14:20:41.897 INFO: Model configuration extracted from foundation model
2025-07-23 14:20:41.897 INFO: Using universal loss function for fine-tuning
2025-07-23 14:20:41.897 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 14:20:41.897 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 14:20:41.897 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 14:20:41.897 INFO: Distance transform for radial basis functions: None
2025-07-23 14:20:43.079 INFO: Total number of parameters: 894362
2025-07-23 14:20:43.079 INFO: 
2025-07-23 14:20:43.079 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 14:20:43.080 INFO: Using ADAM as parameter optimizer
2025-07-23 14:20:43.080 INFO: Batch size: 4
2025-07-23 14:20:43.080 INFO: Number of gradient updates: 427800
2025-07-23 14:20:43.080 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 14:20:43.080 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 14:20:43.080 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 14:20:43.080 INFO: 
2025-07-23 14:20:43.080 INFO: ===========TRAINING===========
2025-07-23 14:20:43.080 INFO: Started training, reporting errors on validation set
2025-07-23 14:20:43.080 INFO: Loss metrics on validation set
2025-07-23 14:45:26.544 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 14:45:26.544 INFO: MACE version: 0.3.13
2025-07-23 14:45:27.126 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 14:45:28.069 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 14:45:28.071 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 14:45:28.071 INFO: ===========LOADING INPUT DATA===========
2025-07-23 14:45:28.071 INFO: Using heads: ['Default']
2025-07-23 14:45:28.071 INFO: Using the key specifications to parse data:
2025-07-23 14:45:28.071 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 14:45:28.071 INFO: =============    Processing head Default     ===========
2025-07-23 14:45:49.183 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:45:49.200 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:45:49.200 INFO: No validation set provided, splitting training data instead.
2025-07-23 14:45:49.204 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 14:45:49.222 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 14:45:49.223 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 14:45:49.223 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 14:45:49.492 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 14:45:49.492 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 14:45:49.492 INFO: Atomic Energies used (z: eV) for head Default: {3: 0.0, 8: 0.0, 40: 0.0, 57: 0.0}
2025-07-23 14:45:49.492 INFO: Processing datasets for head 'Default'
2025-07-23 14:47:03.945 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 14:47:12.655 INFO: Head 'Default' training dataset size: 5704
2025-07-23 14:47:12.656 INFO: Computing average number of neighbors
2025-07-23 14:47:26.071 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 14:47:26.071 INFO: MACE version: 0.3.13
2025-07-23 14:47:26.609 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 14:47:27.218 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 14:47:27.219 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 14:47:27.219 INFO: ===========LOADING INPUT DATA===========
2025-07-23 14:47:27.219 INFO: Using heads: ['Default']
2025-07-23 14:47:27.219 INFO: Using the key specifications to parse data:
2025-07-23 14:47:27.219 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 14:47:27.219 INFO: =============    Processing head Default     ===========
2025-07-23 14:47:48.346 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:47:48.364 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:47:48.364 INFO: No validation set provided, splitting training data instead.
2025-07-23 14:47:48.367 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 14:47:48.385 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 14:47:48.387 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 14:47:48.387 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 14:47:48.657 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 14:47:48.657 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 14:47:48.657 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 14:47:48.657 INFO: Processing datasets for head 'Default'
2025-07-23 14:49:03.186 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 14:49:11.895 INFO: Head 'Default' training dataset size: 5704
2025-07-23 14:49:11.895 INFO: Computing average number of neighbors
2025-07-23 14:49:17.264 INFO: Average number of neighbors: 68.39182382564749
2025-07-23 14:49:17.266 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 14:49:17.266 INFO: ===========MODEL DETAILS===========
2025-07-23 14:49:20.895 INFO: Loading FOUNDATION model
2025-07-23 14:49:20.896 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 14:49:20.896 INFO: Model configuration extracted from foundation model
2025-07-23 14:49:20.897 INFO: Using universal loss function for fine-tuning
2025-07-23 14:49:20.897 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 14:49:20.897 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 14:49:20.897 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 14:49:20.897 INFO: Distance transform for radial basis functions: None
2025-07-23 14:49:22.010 INFO: Total number of parameters: 894362
2025-07-23 14:49:22.010 INFO: 
2025-07-23 14:49:22.010 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 14:49:22.010 INFO: Using ADAM as parameter optimizer
2025-07-23 14:49:22.010 INFO: Batch size: 16
2025-07-23 14:49:22.010 INFO: Number of gradient updates: 106950
2025-07-23 14:49:22.010 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 14:49:22.010 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 14:49:22.011 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 14:49:22.011 INFO: 
2025-07-23 14:49:22.011 INFO: ===========TRAINING===========
2025-07-23 14:49:22.011 INFO: Started training, reporting errors on validation set
2025-07-23 14:49:22.011 INFO: Loss metrics on validation set
2025-07-23 14:49:54.284 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 14:49:54.284 INFO: MACE version: 0.3.13
2025-07-23 14:49:54.871 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 14:49:55.391 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 14:49:55.392 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 14:49:55.392 INFO: ===========LOADING INPUT DATA===========
2025-07-23 14:49:55.392 INFO: Using heads: ['Default']
2025-07-23 14:49:55.392 INFO: Using the key specifications to parse data:
2025-07-23 14:49:55.392 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 14:49:55.392 INFO: =============    Processing head Default     ===========
2025-07-23 14:50:16.485 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:50:16.504 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:50:16.504 INFO: No validation set provided, splitting training data instead.
2025-07-23 14:50:16.508 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 14:50:16.527 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 14:50:16.528 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 14:50:16.528 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 14:50:16.813 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 14:50:16.813 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 14:50:16.814 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 14:50:16.814 INFO: Processing datasets for head 'Default'
2025-07-23 14:51:31.467 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 14:51:40.201 INFO: Head 'Default' training dataset size: 5704
2025-07-23 14:51:40.202 INFO: Computing average number of neighbors
2025-07-23 14:51:45.343 INFO: Average number of neighbors: 68.38714606777741
2025-07-23 14:51:45.345 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 14:51:45.345 INFO: ===========MODEL DETAILS===========
2025-07-23 14:51:49.036 INFO: Loading FOUNDATION model
2025-07-23 14:51:49.038 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 14:51:49.039 INFO: Model configuration extracted from foundation model
2025-07-23 14:51:49.039 INFO: Using universal loss function for fine-tuning
2025-07-23 14:51:49.039 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 14:51:49.039 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 14:51:49.039 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 14:51:49.039 INFO: Distance transform for radial basis functions: None
2025-07-23 14:51:50.152 INFO: Total number of parameters: 894362
2025-07-23 14:51:50.153 INFO: 
2025-07-23 14:51:50.153 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 14:51:50.153 INFO: Using ADAM as parameter optimizer
2025-07-23 14:51:50.153 INFO: Batch size: 10
2025-07-23 14:51:50.153 INFO: Number of gradient updates: 171120
2025-07-23 14:51:50.153 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 14:51:50.153 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 14:51:50.153 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 14:51:50.153 INFO: 
2025-07-23 14:51:50.153 INFO: ===========TRAINING===========
2025-07-23 14:51:50.153 INFO: Started training, reporting errors on validation set
2025-07-23 14:51:50.153 INFO: Loss metrics on validation set
2025-07-23 14:52:15.955 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 14:52:15.955 INFO: MACE version: 0.3.13
2025-07-23 14:52:16.582 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 14:52:17.088 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 14:52:17.092 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 14:52:17.092 INFO: ===========LOADING INPUT DATA===========
2025-07-23 14:52:17.092 INFO: Using heads: ['Default']
2025-07-23 14:52:17.092 INFO: Using the key specifications to parse data:
2025-07-23 14:52:17.092 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 14:52:17.092 INFO: =============    Processing head Default     ===========
2025-07-23 14:52:38.230 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:52:38.250 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:52:38.250 INFO: No validation set provided, splitting training data instead.
2025-07-23 14:52:38.254 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 14:52:38.274 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 14:52:38.276 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 14:52:38.276 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 14:52:38.553 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 14:52:38.554 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 14:52:38.554 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 14:52:38.554 INFO: Processing datasets for head 'Default'
2025-07-23 14:53:53.128 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 14:54:01.840 INFO: Head 'Default' training dataset size: 5704
2025-07-23 14:54:01.841 INFO: Computing average number of neighbors
2025-07-23 14:54:06.863 INFO: Average number of neighbors: 68.38162827085245
2025-07-23 14:54:06.865 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 14:54:06.865 INFO: ===========MODEL DETAILS===========
2025-07-23 14:54:10.402 INFO: Loading FOUNDATION model
2025-07-23 14:54:10.403 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 14:54:10.404 INFO: Model configuration extracted from foundation model
2025-07-23 14:54:10.404 INFO: Using universal loss function for fine-tuning
2025-07-23 14:54:10.404 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 14:54:10.404 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 14:54:10.404 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 14:54:10.404 INFO: Distance transform for radial basis functions: None
2025-07-23 14:54:11.532 INFO: Total number of parameters: 894362
2025-07-23 14:54:11.532 INFO: 
2025-07-23 14:54:11.532 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 14:54:11.532 INFO: Using ADAM as parameter optimizer
2025-07-23 14:54:11.532 INFO: Batch size: 8
2025-07-23 14:54:11.532 INFO: Number of gradient updates: 213900
2025-07-23 14:54:11.532 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 14:54:11.532 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 14:54:11.532 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 14:54:11.533 INFO: 
2025-07-23 14:54:11.533 INFO: ===========TRAINING===========
2025-07-23 14:54:11.533 INFO: Started training, reporting errors on validation set
2025-07-23 14:54:11.533 INFO: Loss metrics on validation set
2025-07-23 14:54:48.965 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 14:54:48.965 INFO: MACE version: 0.3.13
2025-07-23 14:54:49.519 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 14:54:50.011 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 14:54:50.012 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 14:54:50.013 INFO: ===========LOADING INPUT DATA===========
2025-07-23 14:54:50.013 INFO: Using heads: ['Default']
2025-07-23 14:54:50.013 INFO: Using the key specifications to parse data:
2025-07-23 14:54:50.013 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 14:54:50.013 INFO: =============    Processing head Default     ===========
2025-07-23 14:55:11.219 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:55:11.239 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 14:55:11.240 INFO: No validation set provided, splitting training data instead.
2025-07-23 14:55:11.243 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 14:55:11.261 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 14:55:11.263 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 14:55:11.263 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 14:55:11.532 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 14:55:11.532 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 14:55:11.532 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 14:55:11.532 INFO: Processing datasets for head 'Default'
2025-07-23 14:56:25.973 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 14:56:34.677 INFO: Head 'Default' training dataset size: 5704
2025-07-23 14:56:34.677 INFO: Computing average number of neighbors
2025-07-23 14:56:39.739 INFO: Average number of neighbors: 68.38714606777741
2025-07-23 14:56:39.741 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 14:56:39.741 INFO: ===========MODEL DETAILS===========
2025-07-23 14:56:43.584 INFO: Loading FOUNDATION model
2025-07-23 14:56:43.586 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 14:56:43.586 INFO: Model configuration extracted from foundation model
2025-07-23 14:56:43.586 INFO: Using universal loss function for fine-tuning
2025-07-23 14:56:43.586 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 14:56:43.586 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 14:56:43.586 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 14:56:43.586 INFO: Distance transform for radial basis functions: None
2025-07-23 14:56:44.887 INFO: Total number of parameters: 894362
2025-07-23 14:56:44.888 INFO: 
2025-07-23 14:56:44.888 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 14:56:44.888 INFO: Using ADAM as parameter optimizer
2025-07-23 14:56:44.888 INFO: Batch size: 6
2025-07-23 14:56:44.888 INFO: Number of gradient updates: 285200
2025-07-23 14:56:44.888 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 14:56:44.888 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 14:56:44.888 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 14:56:44.888 INFO: 
2025-07-23 14:56:44.888 INFO: ===========TRAINING===========
2025-07-23 14:56:44.888 INFO: Started training, reporting errors on validation set
2025-07-23 14:56:44.888 INFO: Loss metrics on validation set
2025-07-23 15:10:07.799 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 15:10:07.799 INFO: MACE version: 0.3.13
2025-07-23 15:10:08.453 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 15:10:09.598 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 15:10:09.599 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 15:10:09.599 INFO: ===========LOADING INPUT DATA===========
2025-07-23 15:10:09.599 INFO: Using heads: ['Default']
2025-07-23 15:10:09.599 INFO: Using the key specifications to parse data:
2025-07-23 15:10:09.599 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 15:10:09.599 INFO: =============    Processing head Default     ===========
2025-07-23 15:10:30.810 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:10:30.830 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:10:30.830 INFO: No validation set provided, splitting training data instead.
2025-07-23 15:10:30.833 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 15:10:30.853 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 15:10:30.854 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 15:10:30.854 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 15:10:31.140 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 15:10:31.140 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 15:10:31.140 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 15:10:31.140 INFO: Processing datasets for head 'Default'
2025-07-23 15:11:45.649 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 15:11:54.366 INFO: Head 'Default' training dataset size: 5704
2025-07-23 15:11:54.366 INFO: Computing average number of neighbors
2025-07-23 15:11:59.332 INFO: Average number of neighbors: 68.39182382564749
2025-07-23 15:11:59.334 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 15:11:59.334 INFO: ===========MODEL DETAILS===========
2025-07-23 15:12:02.803 INFO: Loading FOUNDATION model
2025-07-23 15:12:02.805 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 15:12:02.805 INFO: Model configuration extracted from foundation model
2025-07-23 15:12:02.805 INFO: Using universal loss function for fine-tuning
2025-07-23 15:12:02.805 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 15:12:02.805 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 15:12:02.805 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 15:12:02.805 INFO: Distance transform for radial basis functions: None
2025-07-23 15:12:03.990 INFO: Total number of parameters: 894362
2025-07-23 15:12:03.990 INFO: 
2025-07-23 15:12:03.990 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 15:12:03.990 INFO: Using ADAM as parameter optimizer
2025-07-23 15:12:03.990 INFO: Batch size: 16
2025-07-23 15:12:03.990 INFO: Number of gradient updates: 106950
2025-07-23 15:12:03.990 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 15:12:03.990 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 15:12:03.990 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 15:12:03.990 INFO: 
2025-07-23 15:12:03.990 INFO: ===========TRAINING===========
2025-07-23 15:12:03.990 INFO: Started training, reporting errors on validation set
2025-07-23 15:12:03.990 INFO: Loss metrics on validation set
2025-07-23 15:12:50.853 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 15:12:50.853 INFO: MACE version: 0.3.13
2025-07-23 15:12:51.518 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 15:12:51.929 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 15:12:51.930 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 15:12:51.930 INFO: ===========LOADING INPUT DATA===========
2025-07-23 15:12:51.930 INFO: Using heads: ['Default']
2025-07-23 15:12:51.930 INFO: Using the key specifications to parse data:
2025-07-23 15:12:51.930 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 15:12:51.930 INFO: =============    Processing head Default     ===========
2025-07-23 15:13:13.019 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:13:13.036 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:13:13.036 INFO: No validation set provided, splitting training data instead.
2025-07-23 15:13:13.040 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 15:13:13.058 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 15:13:13.060 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 15:13:13.060 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 15:13:13.338 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 15:13:13.338 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 15:13:13.338 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 15:13:13.338 INFO: Processing datasets for head 'Default'
2025-07-23 15:14:27.640 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 15:14:36.344 INFO: Head 'Default' training dataset size: 5704
2025-07-23 15:14:36.344 INFO: Computing average number of neighbors
2025-07-23 15:14:41.397 INFO: Average number of neighbors: 68.38704949414533
2025-07-23 15:14:41.398 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 15:14:41.398 INFO: ===========MODEL DETAILS===========
2025-07-23 15:14:45.125 INFO: Loading FOUNDATION model
2025-07-23 15:14:45.126 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 15:14:45.126 INFO: Model configuration extracted from foundation model
2025-07-23 15:14:45.126 INFO: Using universal loss function for fine-tuning
2025-07-23 15:14:45.126 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 15:14:45.126 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 15:14:45.126 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 15:14:45.126 INFO: Distance transform for radial basis functions: None
2025-07-23 15:14:46.228 INFO: Total number of parameters: 894362
2025-07-23 15:14:46.228 INFO: 
2025-07-23 15:14:46.228 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 15:14:46.228 INFO: Using ADAM as parameter optimizer
2025-07-23 15:14:46.228 INFO: Batch size: 7
2025-07-23 15:14:46.228 INFO: Number of gradient updates: 244457
2025-07-23 15:14:46.228 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 15:14:46.228 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 15:14:46.228 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 15:14:46.228 INFO: 
2025-07-23 15:14:46.228 INFO: ===========TRAINING===========
2025-07-23 15:14:46.228 INFO: Started training, reporting errors on validation set
2025-07-23 15:14:46.228 INFO: Loss metrics on validation set
2025-07-23 15:17:20.313 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 15:17:20.313 INFO: MACE version: 0.3.13
2025-07-23 15:17:21.016 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 15:17:21.625 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 15:17:21.626 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 15:17:21.626 INFO: ===========LOADING INPUT DATA===========
2025-07-23 15:17:21.626 INFO: Using heads: ['Default']
2025-07-23 15:17:21.626 INFO: Using the key specifications to parse data:
2025-07-23 15:17:21.626 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 15:17:21.626 INFO: =============    Processing head Default     ===========
2025-07-23 15:17:42.779 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:17:42.796 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:17:42.797 INFO: No validation set provided, splitting training data instead.
2025-07-23 15:17:42.800 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 15:17:42.818 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 15:17:42.820 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 15:17:42.820 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 15:17:43.094 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 15:17:43.094 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 15:17:43.094 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 15:17:43.094 INFO: Processing datasets for head 'Default'
2025-07-23 15:18:57.853 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 15:19:06.618 INFO: Head 'Default' training dataset size: 5704
2025-07-23 15:19:06.619 INFO: Computing average number of neighbors
2025-07-23 15:19:11.975 INFO: Average number of neighbors: 68.38704949414533
2025-07-23 15:19:11.977 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 15:19:11.977 INFO: ===========MODEL DETAILS===========
2025-07-23 15:19:15.908 INFO: Loading FOUNDATION model
2025-07-23 15:19:15.910 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 15:19:15.910 INFO: Model configuration extracted from foundation model
2025-07-23 15:19:15.910 INFO: Using universal loss function for fine-tuning
2025-07-23 15:19:15.910 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 15:19:15.910 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 15:19:15.910 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 15:19:15.910 INFO: Distance transform for radial basis functions: None
2025-07-23 15:19:17.025 INFO: Total number of parameters: 894362
2025-07-23 15:19:17.025 INFO: 
2025-07-23 15:19:17.025 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 15:19:17.026 INFO: Using ADAM as parameter optimizer
2025-07-23 15:19:17.026 INFO: Batch size: 7
2025-07-23 15:19:17.026 INFO: Number of gradient updates: 244457
2025-07-23 15:19:17.026 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 15:19:17.026 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 15:19:17.026 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 15:19:17.026 INFO: 
2025-07-23 15:19:17.026 INFO: ===========TRAINING===========
2025-07-23 15:19:17.026 INFO: Started training, reporting errors on validation set
2025-07-23 15:19:17.026 INFO: Loss metrics on validation set
2025-07-23 15:19:56.171 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 15:19:56.171 INFO: MACE version: 0.3.13
2025-07-23 15:19:56.757 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 15:19:57.286 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 15:19:57.287 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 15:19:57.287 INFO: ===========LOADING INPUT DATA===========
2025-07-23 15:19:57.287 INFO: Using heads: ['Default']
2025-07-23 15:19:57.287 INFO: Using the key specifications to parse data:
2025-07-23 15:19:57.287 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 15:19:57.287 INFO: =============    Processing head Default     ===========
2025-07-23 15:20:18.483 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:20:18.500 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:20:18.500 INFO: No validation set provided, splitting training data instead.
2025-07-23 15:20:18.504 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 15:20:18.522 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 15:20:18.524 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 15:20:18.524 INFO: Total number of configurations: train=5704, valid=633, tests=[],
2025-07-23 15:20:18.796 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 15:20:18.796 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 15:20:18.796 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 15:20:18.796 INFO: Processing datasets for head 'Default'
2025-07-23 15:21:33.602 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 15:21:42.351 INFO: Head 'Default' training dataset size: 5704
2025-07-23 15:21:42.351 INFO: Computing average number of neighbors
2025-07-23 15:21:47.656 INFO: Average number of neighbors: 68.38704949414533
2025-07-23 15:21:47.658 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 15:21:47.658 INFO: ===========MODEL DETAILS===========
2025-07-23 15:21:51.434 INFO: Loading FOUNDATION model
2025-07-23 15:21:51.435 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 15:21:51.436 INFO: Model configuration extracted from foundation model
2025-07-23 15:21:51.436 INFO: Using universal loss function for fine-tuning
2025-07-23 15:21:51.436 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 15:21:51.436 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 15:21:51.436 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 15:21:51.436 INFO: Distance transform for radial basis functions: None
2025-07-23 15:21:52.553 INFO: Total number of parameters: 894362
2025-07-23 15:21:52.553 INFO: 
2025-07-23 15:21:52.553 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 15:21:52.553 INFO: Using ADAM as parameter optimizer
2025-07-23 15:21:52.553 INFO: Batch size: 7
2025-07-23 15:21:52.553 INFO: Number of gradient updates: 244457
2025-07-23 15:21:52.553 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 15:21:52.553 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 15:21:52.553 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 15:21:52.553 INFO: 
2025-07-23 15:21:52.553 INFO: ===========TRAINING===========
2025-07-23 15:21:52.553 INFO: Started training, reporting errors on validation set
2025-07-23 15:21:52.553 INFO: Loss metrics on validation set
2025-07-23 15:27:32.740 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 15:27:32.740 INFO: MACE version: 0.3.13
2025-07-23 15:27:33.455 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 15:27:33.932 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 15:27:33.933 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 15:27:33.933 INFO: ===========LOADING INPUT DATA===========
2025-07-23 15:27:33.933 INFO: Using heads: ['Default']
2025-07-23 15:27:33.933 INFO: Using the key specifications to parse data:
2025-07-23 15:27:33.933 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 15:27:33.933 INFO: =============    Processing head Default     ===========
2025-07-23 15:27:55.061 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:27:55.081 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:27:55.081 INFO: No validation set provided, splitting training data instead.
2025-07-23 15:27:55.084 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 15:27:55.104 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 15:27:55.106 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 15:27:57.741 INFO: Test set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-23 15:27:57.744 INFO: Total Test set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-23 15:27:57.744 INFO: Total number of configurations: train=5704, valid=633, tests=[Default_Default: 705],
2025-07-23 15:27:58.022 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 15:27:58.022 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 15:27:58.022 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 15:27:58.022 INFO: Processing datasets for head 'Default'
2025-07-23 15:29:11.275 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 15:29:19.855 INFO: Head 'Default' training dataset size: 5704
2025-07-23 15:29:19.855 INFO: Computing average number of neighbors
2025-07-23 15:29:24.218 INFO: Average number of neighbors: 68.38705444335938
2025-07-23 15:29:24.222 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 15:29:24.222 INFO: ===========MODEL DETAILS===========
2025-07-23 15:29:27.067 INFO: Loading FOUNDATION model
2025-07-23 15:29:27.068 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 15:29:27.068 INFO: Model configuration extracted from foundation model
2025-07-23 15:29:27.068 INFO: Using universal loss function for fine-tuning
2025-07-23 15:29:27.068 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 15:29:27.068 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 15:29:27.068 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 15:29:27.068 INFO: Distance transform for radial basis functions: None
2025-07-23 15:29:27.961 INFO: Total number of parameters: 894362
2025-07-23 15:29:27.961 INFO: 
2025-07-23 15:29:27.961 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 15:29:27.961 INFO: Using ADAM as parameter optimizer
2025-07-23 15:29:27.961 INFO: Batch size: 7
2025-07-23 15:29:27.961 INFO: Number of gradient updates: 244457
2025-07-23 15:29:27.961 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 15:29:27.961 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 15:29:27.962 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 15:29:27.962 INFO: 
2025-07-23 15:29:27.962 INFO: ===========TRAINING===========
2025-07-23 15:29:27.962 INFO: Started training, reporting errors on validation set
2025-07-23 15:29:27.962 INFO: Loss metrics on validation set
2025-07-23 15:36:12.873 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 15:36:12.873 INFO: MACE version: 0.3.13
2025-07-23 15:36:13.554 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 15:36:14.374 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 15:36:14.375 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 15:36:14.375 INFO: ===========LOADING INPUT DATA===========
2025-07-23 15:36:14.375 INFO: Using heads: ['Default']
2025-07-23 15:36:14.375 INFO: Using the key specifications to parse data:
2025-07-23 15:36:14.376 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 15:36:14.376 INFO: =============    Processing head Default     ===========
2025-07-23 15:36:35.465 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:36:35.483 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:36:35.483 INFO: No validation set provided, splitting training data instead.
2025-07-23 15:36:35.486 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 15:36:35.505 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 15:36:35.506 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 15:36:38.102 INFO: Test set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-23 15:36:38.104 INFO: Total Test set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-23 15:36:38.104 INFO: Total number of configurations: train=5704, valid=633, tests=[Default_Default: 705],
2025-07-23 15:36:38.389 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 15:36:38.389 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 15:36:38.389 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 15:36:38.390 INFO: Processing datasets for head 'Default'
2025-07-23 15:37:51.673 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 15:38:00.237 INFO: Head 'Default' training dataset size: 5704
2025-07-23 15:38:00.238 INFO: Computing average number of neighbors
2025-07-23 15:38:04.527 INFO: Average number of neighbors: 68.38705444335938
2025-07-23 15:38:04.531 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 15:38:04.531 INFO: ===========MODEL DETAILS===========
2025-07-23 15:38:07.605 INFO: Loading FOUNDATION model
2025-07-23 15:38:07.607 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 15:38:07.607 INFO: Model configuration extracted from foundation model
2025-07-23 15:38:07.608 INFO: Using universal loss function for fine-tuning
2025-07-23 15:38:07.608 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 15:38:07.608 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 15:38:07.608 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 15:38:07.608 INFO: Distance transform for radial basis functions: None
2025-07-23 15:38:08.495 INFO: Total number of parameters: 894362
2025-07-23 15:38:08.495 INFO: 
2025-07-23 15:38:08.495 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 15:38:08.495 INFO: Using ADAM as parameter optimizer
2025-07-23 15:38:08.495 INFO: Batch size: 7
2025-07-23 15:38:08.495 INFO: Number of gradient updates: 244457
2025-07-23 15:38:08.495 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 15:38:08.495 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 15:38:08.495 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 15:38:08.495 INFO: 
2025-07-23 15:38:08.495 INFO: ===========TRAINING===========
2025-07-23 15:38:08.495 INFO: Started training, reporting errors on validation set
2025-07-23 15:38:08.495 INFO: Loss metrics on validation set
2025-07-23 15:41:10.029 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 15:41:10.029 INFO: MACE version: 0.3.13
2025-07-23 15:41:10.603 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 15:41:11.074 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 15:41:11.075 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 15:41:11.075 INFO: ===========LOADING INPUT DATA===========
2025-07-23 15:41:11.075 INFO: Using heads: ['Default']
2025-07-23 15:41:11.075 INFO: Using the key specifications to parse data:
2025-07-23 15:41:11.075 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 15:41:11.075 INFO: =============    Processing head Default     ===========
2025-07-23 15:41:32.312 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:41:32.330 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 15:41:32.330 INFO: No validation set provided, splitting training data instead.
2025-07-23 15:41:32.333 INFO: Using random 10% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 15:41:32.351 INFO: Random Split Training set [energy: 5704, stress: 0, virials: 0, dipole components: 0, head: 5704, forces: 5704, charges: 0]
2025-07-23 15:41:32.353 INFO: Random Split Validation set [energy: 633, stress: 0, virials: 0, dipole components: 0, head: 633, forces: 633, charges: 0]
2025-07-23 15:41:34.952 INFO: Test set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-23 15:41:34.954 INFO: Total Test set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-23 15:41:34.955 INFO: Total number of configurations: train=5704, valid=633, tests=[Default_Default: 705],
2025-07-23 15:41:35.232 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 15:41:35.232 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 15:41:35.232 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 15:41:35.232 INFO: Processing datasets for head 'Default'
2025-07-23 15:42:48.366 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 15:42:56.934 INFO: Head 'Default' training dataset size: 5704
2025-07-23 15:42:56.934 INFO: Computing average number of neighbors
2025-07-23 15:43:01.163 INFO: Average number of neighbors: 68.38705444335938
2025-07-23 15:43:01.168 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 15:43:01.168 INFO: ===========MODEL DETAILS===========
2025-07-23 15:43:04.276 INFO: Loading FOUNDATION model
2025-07-23 15:43:04.277 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 15:43:04.278 INFO: Model configuration extracted from foundation model
2025-07-23 15:43:04.278 INFO: Using universal loss function for fine-tuning
2025-07-23 15:43:04.278 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 15:43:04.278 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 15:43:04.278 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 15:43:04.278 INFO: Distance transform for radial basis functions: None
2025-07-23 15:43:05.180 INFO: Total number of parameters: 894362
2025-07-23 15:43:05.180 INFO: 
2025-07-23 15:43:05.180 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 15:43:05.180 INFO: Using ADAM as parameter optimizer
2025-07-23 15:43:05.180 INFO: Batch size: 7
2025-07-23 15:43:05.180 INFO: Number of gradient updates: 244457
2025-07-23 15:43:05.180 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 15:43:05.180 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 15:43:05.180 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 15:43:05.180 INFO: 
2025-07-23 15:43:05.180 INFO: ===========TRAINING===========
2025-07-23 15:43:05.180 INFO: Started training, reporting errors on validation set
2025-07-23 15:43:05.180 INFO: Loss metrics on validation set
2025-07-23 16:06:22.690 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 16:06:22.690 INFO: MACE version: 0.3.13
2025-07-23 16:06:23.264 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 16:06:23.986 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 16:06:23.987 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 16:06:23.987 INFO: ===========LOADING INPUT DATA===========
2025-07-23 16:06:23.987 INFO: Using heads: ['Default']
2025-07-23 16:06:23.987 INFO: Using the key specifications to parse data:
2025-07-23 16:06:23.987 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 16:06:23.987 INFO: =============    Processing head Default     ===========
2025-07-23 16:06:45.044 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:06:45.062 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:06:45.062 INFO: No validation set provided, splitting training data instead.
2025-07-23 16:06:45.066 INFO: Using random 40% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 16:06:45.078 INFO: Random Split Training set [energy: 3803, stress: 0, virials: 0, dipole components: 0, head: 3803, forces: 3803, charges: 0]
2025-07-23 16:06:45.084 INFO: Random Split Validation set [energy: 2534, stress: 0, virials: 0, dipole components: 0, head: 2534, forces: 2534, charges: 0]
2025-07-23 16:07:06.928 INFO: Test set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:07:06.946 INFO: Total Test set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:07:06.947 INFO: Total number of configurations: train=3803, valid=2534, tests=[Default_Default: 6337],
2025-07-23 16:07:07.222 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 16:07:07.222 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 16:07:07.222 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 16:07:07.223 INFO: Processing datasets for head 'Default'
2025-07-23 16:07:56.751 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 16:08:30.613 INFO: Head 'Default' training dataset size: 3803
2025-07-23 16:08:30.613 INFO: Computing average number of neighbors
2025-07-23 16:08:34.334 INFO: Average number of neighbors: 68.68842248270366
2025-07-23 16:08:34.336 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 16:08:34.336 INFO: ===========MODEL DETAILS===========
2025-07-23 16:08:36.915 INFO: Loading FOUNDATION model
2025-07-23 16:08:36.916 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 16:08:36.916 INFO: Model configuration extracted from foundation model
2025-07-23 16:08:36.916 INFO: Using universal loss function for fine-tuning
2025-07-23 16:08:36.916 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 16:08:36.916 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 16:08:36.916 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 16:08:36.916 INFO: Distance transform for radial basis functions: None
2025-07-23 16:08:38.041 INFO: Total number of parameters: 894362
2025-07-23 16:08:38.041 INFO: 
2025-07-23 16:08:38.041 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 16:08:38.041 INFO: Using ADAM as parameter optimizer
2025-07-23 16:08:38.041 INFO: Batch size: 7
2025-07-23 16:08:38.041 INFO: Number of gradient updates: 162985
2025-07-23 16:08:38.041 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 16:08:38.041 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 16:08:38.041 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 16:08:38.042 INFO: 
2025-07-23 16:08:38.042 INFO: ===========TRAINING===========
2025-07-23 16:08:38.042 INFO: Started training, reporting errors on validation set
2025-07-23 16:08:38.042 INFO: Loss metrics on validation set
2025-07-23 16:11:48.646 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 16:11:48.647 INFO: MACE version: 0.3.13
2025-07-23 16:11:49.209 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 16:11:49.798 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 16:11:49.799 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 16:11:49.799 INFO: ===========LOADING INPUT DATA===========
2025-07-23 16:11:49.799 INFO: Using heads: ['Default']
2025-07-23 16:11:49.800 INFO: Using the key specifications to parse data:
2025-07-23 16:11:49.800 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 16:11:49.800 INFO: =============    Processing head Default     ===========
2025-07-23 16:12:10.823 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:12:10.841 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:12:10.841 INFO: No validation set provided, splitting training data instead.
2025-07-23 16:12:10.844 INFO: Using random 40% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 16:12:10.855 INFO: Random Split Training set [energy: 3803, stress: 0, virials: 0, dipole components: 0, head: 3803, forces: 3803, charges: 0]
2025-07-23 16:12:10.862 INFO: Random Split Validation set [energy: 2534, stress: 0, virials: 0, dipole components: 0, head: 2534, forces: 2534, charges: 0]
2025-07-23 16:12:32.555 INFO: Test set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:12:32.573 INFO: Total Test set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:12:32.574 INFO: Total number of configurations: train=3803, valid=2534, tests=[Default_Default: 6337],
2025-07-23 16:12:32.849 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 16:12:32.850 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 16:12:32.850 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 16:12:32.850 INFO: Processing datasets for head 'Default'
2025-07-23 16:13:22.159 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 16:13:55.787 INFO: Head 'Default' training dataset size: 3803
2025-07-23 16:13:55.788 INFO: Computing average number of neighbors
2025-07-23 16:14:00.372 INFO: Average number of neighbors: 68.68529115113631
2025-07-23 16:14:00.373 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 16:14:00.373 INFO: ===========MODEL DETAILS===========
2025-07-23 16:14:03.915 INFO: Loading FOUNDATION model
2025-07-23 16:14:03.916 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 16:14:03.916 INFO: Model configuration extracted from foundation model
2025-07-23 16:14:03.916 INFO: Using universal loss function for fine-tuning
2025-07-23 16:14:03.916 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 16:14:03.916 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 16:14:03.916 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 16:14:03.916 INFO: Distance transform for radial basis functions: None
2025-07-23 16:14:05.029 INFO: Total number of parameters: 894362
2025-07-23 16:14:05.030 INFO: 
2025-07-23 16:14:05.030 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 16:14:05.030 INFO: Using ADAM as parameter optimizer
2025-07-23 16:14:05.030 INFO: Batch size: 2
2025-07-23 16:14:05.030 INFO: Number of gradient updates: 570450
2025-07-23 16:14:05.030 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 16:14:05.030 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 16:14:05.030 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 16:14:05.030 INFO: 
2025-07-23 16:14:05.030 INFO: ===========TRAINING===========
2025-07-23 16:14:05.030 INFO: Started training, reporting errors on validation set
2025-07-23 16:14:05.030 INFO: Loss metrics on validation set
2025-07-23 16:19:36.469 INFO: Initial: head: Default, loss=88559.68875547, RMSE_E_per_atom=297454.74 meV, RMSE_F=  992.98 meV / A
2025-07-23 16:34:48.360 INFO: ===========VERIFYING SETTINGS===========
2025-07-23 16:34:48.360 INFO: MACE version: 0.3.13
2025-07-23 16:34:48.996 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-23 16:34:49.620 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-23 16:34:49.621 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-23 16:34:49.621 INFO: ===========LOADING INPUT DATA===========
2025-07-23 16:34:49.621 INFO: Using heads: ['Default']
2025-07-23 16:34:49.621 INFO: Using the key specifications to parse data:
2025-07-23 16:34:49.621 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-23 16:34:49.621 INFO: =============    Processing head Default     ===========
2025-07-23 16:35:10.742 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:35:10.762 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:35:10.762 INFO: No validation set provided, splitting training data instead.
2025-07-23 16:35:10.765 INFO: Using random 0% of training set for validation with indices saved in: ./valid_indices_123.txt
2025-07-23 16:35:10.788 INFO: Random Split Training set [energy: 6306, stress: 0, virials: 0, dipole components: 0, head: 6306, forces: 6306, charges: 0]
2025-07-23 16:35:10.788 INFO: Random Split Validation set [energy: 31, stress: 0, virials: 0, dipole components: 0, head: 31, forces: 31, charges: 0]
2025-07-23 16:35:32.553 INFO: Test set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:35:32.574 INFO: Total Test set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-23 16:35:32.574 INFO: Total number of configurations: train=6306, valid=31, tests=[Default_Default: 6337],
2025-07-23 16:35:32.849 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-23 16:35:32.849 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-23 16:35:32.850 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-23 16:35:32.850 INFO: Processing datasets for head 'Default'
2025-07-23 16:36:56.261 INFO: Combining 1 list datasets for head 'Default'
2025-07-23 16:36:56.694 INFO: Head 'Default' training dataset size: 6306
2025-07-23 16:36:56.694 INFO: Computing average number of neighbors
2025-07-23 16:37:04.067 INFO: Average number of neighbors: 68.4897665950869
2025-07-23 16:37:04.068 INFO: During training the following quantities will be reported: energy, forces
2025-07-23 16:37:04.068 INFO: ===========MODEL DETAILS===========
2025-07-23 16:37:10.279 INFO: Loading FOUNDATION model
2025-07-23 16:37:10.281 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-23 16:37:10.281 INFO: Model configuration extracted from foundation model
2025-07-23 16:37:10.281 INFO: Using universal loss function for fine-tuning
2025-07-23 16:37:10.281 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-23 16:37:10.281 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-23 16:37:10.281 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-23 16:37:10.281 INFO: Distance transform for radial basis functions: None
2025-07-23 16:37:11.464 INFO: Total number of parameters: 894362
2025-07-23 16:37:11.464 INFO: 
2025-07-23 16:37:11.464 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-23 16:37:11.464 INFO: Using ADAM as parameter optimizer
2025-07-23 16:37:11.464 INFO: Batch size: 2
2025-07-23 16:37:11.464 INFO: Number of gradient updates: 15765
2025-07-23 16:37:11.464 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-23 16:37:11.464 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=100.000)
2025-07-23 16:37:11.465 INFO: Using gradient clipping with tolerance=10.000
2025-07-23 16:37:11.465 INFO: 
2025-07-23 16:37:11.465 INFO: ===========TRAINING===========
2025-07-23 16:37:11.465 INFO: Started training, reporting errors on validation set
2025-07-23 16:37:11.465 INFO: Loss metrics on validation set
2025-07-23 16:37:17.030 INFO: Initial: head: Default, loss=85886.76069403, RMSE_E_per_atom=292873.41 meV, RMSE_F= 1135.66 meV / A
