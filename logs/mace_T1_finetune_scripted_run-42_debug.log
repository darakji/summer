2025-07-24 12:14:49.653 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 12:14:49.656 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 12:14:49.663 INFO: Process group initialized: True
2025-07-24 12:14:49.663 INFO: Processes: 1
2025-07-24 12:14:49.663 INFO: MACE version: 0.3.14
2025-07-24 12:14:49.664 INFO: Process group initialized: True
2025-07-24 12:14:49.664 INFO: Processes: 1
2025-07-24 12:14:49.664 INFO: MACE version: 0.3.14
2025-07-24 12:14:49.664 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e+64x1o+64x2e', edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 12:14:49.664 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 12:14:49.664 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e+64x1o+64x2e', edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 12:14:49.664 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 12:14:49.758 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:14:49.758 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:14:49.761 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:14:49.762 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:14:49.768 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 12:14:49.769 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 12:14:49.786 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 12:14:49.787 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 12:14:50.423 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 12:14:50.424 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 12:14:50.424 INFO: ===========LOADING INPUT DATA===========
2025-07-24 12:14:50.424 INFO: Using heads: ['Default']
2025-07-24 12:14:50.424 INFO: Using the key specifications to parse data:
2025-07-24 12:14:50.424 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 12:14:50.424 INFO: =============    Processing head Default     ===========
2025-07-24 12:14:50.439 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 12:14:50.442 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 12:14:50.442 INFO: ===========LOADING INPUT DATA===========
2025-07-24 12:14:50.442 INFO: Using heads: ['Default']
2025-07-24 12:14:50.443 INFO: Using the key specifications to parse data:
2025-07-24 12:14:50.443 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 12:14:50.443 INFO: =============    Processing head Default     ===========
2025-07-24 12:14:50.443 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 12:14:50.443 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 12:15:11.626 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:15:11.631 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:15:11.647 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:15:11.651 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:15:14.240 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:15:14.242 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:15:14.242 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 12:15:14.306 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:15:14.308 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:15:14.308 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 12:15:14.536 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 12:15:14.536 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 12:15:14.536 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 12:15:14.536 INFO: Processing datasets for head 'Default'
2025-07-24 12:15:14.612 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 12:15:14.612 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 12:15:14.612 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 12:15:14.612 INFO: Processing datasets for head 'Default'
2025-07-24 12:16:36.099 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 12:16:36.099 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 12:16:36.608 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 12:16:36.608 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 12:16:45.333 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 12:16:45.333 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 12:16:45.333 INFO: Combined validation datasets for Default
2025-07-24 12:16:45.333 INFO: Head 'Default' training dataset size: 6337
2025-07-24 12:16:45.333 INFO: Computing average number of neighbors
2025-07-24 12:16:45.901 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 12:16:45.901 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 12:16:45.901 INFO: Combined validation datasets for Default
2025-07-24 12:16:45.901 INFO: Head 'Default' training dataset size: 6337
2025-07-24 12:16:45.901 INFO: Computing average number of neighbors
2025-07-24 12:17:11.769 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 12:17:11.771 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 12:17:11.771 INFO: ===========MODEL DETAILS===========
2025-07-24 12:17:11.772 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 12:17:11.772 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 12:17:11.772 INFO: ===========MODEL DETAILS===========
2025-07-24 12:17:23.279 INFO: Loading FOUNDATION model
2025-07-24 12:17:23.281 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 12:17:23.281 INFO: Model configuration extracted from foundation model
2025-07-24 12:17:23.281 INFO: Using weighted loss function for fine-tuning
2025-07-24 12:17:23.281 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 12:17:23.281 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 12:17:23.281 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 12:17:23.282 INFO: Distance transform for radial basis functions: None
2025-07-24 12:17:23.487 INFO: Loading FOUNDATION model
2025-07-24 12:17:23.489 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 12:17:23.489 INFO: Model configuration extracted from foundation model
2025-07-24 12:17:23.489 INFO: Using weighted loss function for fine-tuning
2025-07-24 12:17:23.489 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 12:17:23.489 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 12:17:23.489 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 12:17:23.489 INFO: Distance transform for radial basis functions: None
2025-07-24 12:17:24.460 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 12:17:24.461 INFO: Total number of parameters: 894362
2025-07-24 12:17:24.461 INFO: 
2025-07-24 12:17:24.461 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 12:17:24.461 INFO: Using ADAM as parameter optimizer
2025-07-24 12:17:24.461 INFO: Batch size: 1
2025-07-24 12:17:24.461 INFO: Number of gradient updates: 126740
2025-07-24 12:17:24.461 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 12:17:24.461 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=30.000)
2025-07-24 12:17:24.471 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 12:17:24.471 INFO: 
2025-07-24 12:17:24.471 INFO: ===========TRAINING===========
2025-07-24 12:17:24.471 INFO: Started training, reporting errors on validation set
2025-07-24 12:17:24.471 INFO: Loss metrics on validation set
2025-07-24 12:17:24.702 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 12:17:24.703 INFO: Total number of parameters: 894362
2025-07-24 12:17:24.703 INFO: 
2025-07-24 12:17:24.703 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 12:17:24.703 INFO: Using ADAM as parameter optimizer
2025-07-24 12:17:24.703 INFO: Batch size: 1
2025-07-24 12:17:24.703 INFO: Number of gradient updates: 126740
2025-07-24 12:17:24.703 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 12:17:24.703 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=30.000)
2025-07-24 12:17:24.714 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 12:17:24.714 INFO: 
2025-07-24 12:17:24.714 INFO: ===========TRAINING===========
2025-07-24 12:17:24.714 INFO: Started training, reporting errors on validation set
2025-07-24 12:17:24.714 INFO: Loss metrics on validation set
2025-07-24 12:31:51.148 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 12:31:51.159 INFO: Process group initialized: True
2025-07-24 12:31:51.205 INFO: Processes: 1
2025-07-24 12:31:51.205 INFO: MACE version: 0.3.14
2025-07-24 12:31:51.205 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 12:31:51.205 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=1, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e+64x1o+64x2e', edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 12:31:51.205 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 12:31:51.213 INFO: Process group initialized: True
2025-07-24 12:31:51.213 INFO: Processes: 1
2025-07-24 12:31:51.213 INFO: MACE version: 0.3.14
2025-07-24 12:31:51.213 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=1, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e+64x1o+64x2e', edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 12:31:51.213 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 12:31:51.286 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:31:51.287 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:31:51.303 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:31:51.304 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:31:51.312 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 12:31:51.313 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 12:31:51.338 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 12:31:51.339 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 12:31:51.905 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 12:31:51.906 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 12:31:51.906 INFO: ===========LOADING INPUT DATA===========
2025-07-24 12:31:51.906 INFO: Using heads: ['Default']
2025-07-24 12:31:51.906 INFO: Using the key specifications to parse data:
2025-07-24 12:31:51.906 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 12:31:51.906 INFO: =============    Processing head Default     ===========
2025-07-24 12:31:51.907 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 12:31:51.915 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 12:31:51.916 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 12:31:51.916 INFO: ===========LOADING INPUT DATA===========
2025-07-24 12:31:51.916 INFO: Using heads: ['Default']
2025-07-24 12:31:51.916 INFO: Using the key specifications to parse data:
2025-07-24 12:31:51.916 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 12:31:51.916 INFO: =============    Processing head Default     ===========
2025-07-24 12:31:51.916 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 12:32:12.986 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:32:13.007 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:32:13.059 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:32:13.078 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:32:15.664 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:32:15.666 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:32:15.666 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 12:32:15.679 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:32:15.680 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:32:15.681 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 12:32:15.961 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 12:32:15.961 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 12:32:15.961 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 12:32:15.961 INFO: Processing datasets for head 'Default'
2025-07-24 12:32:15.974 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 12:32:15.975 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 12:32:15.975 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 12:32:15.975 INFO: Processing datasets for head 'Default'
2025-07-24 12:33:37.523 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 12:33:37.523 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 12:33:37.576 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 12:33:37.576 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 12:33:46.779 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 12:33:46.779 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 12:33:46.779 INFO: Combined validation datasets for Default
2025-07-24 12:33:46.779 INFO: Head 'Default' training dataset size: 6337
2025-07-24 12:33:46.780 INFO: Computing average number of neighbors
2025-07-24 12:33:46.834 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 12:33:46.834 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 12:33:46.834 INFO: Combined validation datasets for Default
2025-07-24 12:33:46.834 INFO: Head 'Default' training dataset size: 6337
2025-07-24 12:33:46.835 INFO: Computing average number of neighbors
2025-07-24 12:34:13.585 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 12:34:13.585 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 12:34:13.586 INFO: ===========MODEL DETAILS===========
2025-07-24 12:34:13.624 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 12:34:13.625 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 12:34:13.625 INFO: ===========MODEL DETAILS===========
2025-07-24 12:34:25.993 INFO: Loading FOUNDATION model
2025-07-24 12:34:25.996 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 12:34:25.996 INFO: Model configuration extracted from foundation model
2025-07-24 12:34:25.996 INFO: Using weighted loss function for fine-tuning
2025-07-24 12:34:25.996 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 12:34:25.996 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 12:34:25.996 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 12:34:25.996 INFO: Distance transform for radial basis functions: None
2025-07-24 12:34:26.057 INFO: Loading FOUNDATION model
2025-07-24 12:34:26.059 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 12:34:26.059 INFO: Model configuration extracted from foundation model
2025-07-24 12:34:26.060 INFO: Using weighted loss function for fine-tuning
2025-07-24 12:34:26.060 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 12:34:26.060 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 12:34:26.060 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 12:34:26.060 INFO: Distance transform for radial basis functions: None
2025-07-24 12:34:27.286 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 12:34:27.287 INFO: Total number of parameters: 894362
2025-07-24 12:34:27.287 INFO: 
2025-07-24 12:34:27.287 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 12:34:27.287 INFO: Using ADAM as parameter optimizer
2025-07-24 12:34:27.287 INFO: Batch size: 1
2025-07-24 12:34:27.287 INFO: Number of gradient updates: 126740
2025-07-24 12:34:27.287 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 12:34:27.287 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=30.000)
2025-07-24 12:34:27.299 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 12:34:27.300 INFO: Total number of parameters: 894362
2025-07-24 12:34:27.300 INFO: 
2025-07-24 12:34:27.300 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 12:34:27.300 INFO: Using ADAM as parameter optimizer
2025-07-24 12:34:27.300 INFO: Batch size: 1
2025-07-24 12:34:27.300 INFO: Number of gradient updates: 126740
2025-07-24 12:34:27.300 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 12:34:27.300 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=30.000)
2025-07-24 12:34:27.318 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 12:34:27.318 INFO: 
2025-07-24 12:34:27.318 INFO: ===========TRAINING===========
2025-07-24 12:34:27.318 INFO: Started training, reporting errors on validation set
2025-07-24 12:34:27.318 INFO: Loss metrics on validation set
2025-07-24 12:34:27.325 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 12:34:27.325 INFO: 
2025-07-24 12:34:27.325 INFO: ===========TRAINING===========
2025-07-24 12:34:27.325 INFO: Started training, reporting errors on validation set
2025-07-24 12:34:27.325 INFO: Loss metrics on validation set
2025-07-24 12:35:29.864 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 12:35:29.868 INFO: Process group initialized: True
2025-07-24 12:35:29.868 INFO: Processes: 1
2025-07-24 12:35:29.868 INFO: MACE version: 0.3.14
2025-07-24 12:35:29.869 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=1, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e+64x1o+64x2e', edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 12:35:29.869 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 12:35:29.961 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:35:30.058 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:35:30.067 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 12:35:30.077 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 12:35:30.394 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 12:35:30.395 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 12:35:30.395 INFO: ===========LOADING INPUT DATA===========
2025-07-24 12:35:30.395 INFO: Using heads: ['Default']
2025-07-24 12:35:30.396 INFO: Using the key specifications to parse data:
2025-07-24 12:35:30.396 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 12:35:30.396 INFO: =============    Processing head Default     ===========
2025-07-24 12:35:30.397 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 12:35:51.392 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:35:51.412 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:35:54.012 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:35:54.014 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:35:54.014 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 12:35:54.318 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 12:35:54.318 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 12:35:54.319 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 12:35:54.319 INFO: Processing datasets for head 'Default'
2025-07-24 12:37:17.686 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 12:37:17.687 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 12:37:27.161 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 12:37:27.161 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 12:37:27.161 INFO: Combined validation datasets for Default
2025-07-24 12:37:27.161 INFO: Head 'Default' training dataset size: 6337
2025-07-24 12:37:27.162 INFO: Computing average number of neighbors
2025-07-24 12:37:43.264 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 12:37:43.264 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 12:37:43.264 INFO: ===========MODEL DETAILS===========
2025-07-24 12:37:52.265 INFO: Loading FOUNDATION model
2025-07-24 12:37:52.267 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 12:37:52.267 INFO: Model configuration extracted from foundation model
2025-07-24 12:37:52.267 INFO: Using weighted loss function for fine-tuning
2025-07-24 12:37:52.267 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 12:37:52.267 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 12:37:52.268 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 12:37:52.268 INFO: Distance transform for radial basis functions: None
2025-07-24 12:37:53.764 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 12:37:53.765 INFO: Total number of parameters: 894362
2025-07-24 12:37:53.765 INFO: 
2025-07-24 12:37:53.765 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 12:37:53.765 INFO: Using ADAM as parameter optimizer
2025-07-24 12:37:53.765 INFO: Batch size: 1
2025-07-24 12:37:53.765 INFO: Number of gradient updates: 126740
2025-07-24 12:37:53.765 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 12:37:53.765 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=30.000)
2025-07-24 12:37:53.775 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 12:37:53.775 INFO: 
2025-07-24 12:37:53.775 INFO: ===========TRAINING===========
2025-07-24 12:37:53.775 INFO: Started training, reporting errors on validation set
2025-07-24 12:37:53.775 INFO: Loss metrics on validation set
2025-07-24 12:40:10.939 INFO: Initial: head: Default, loss=88992.45910932, RMSE_E_per_atom=298278.68 meV, RMSE_F=  959.54 meV / A
2025-07-24 12:42:37.590 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 12:42:37.594 INFO: Process group initialized: True
2025-07-24 12:42:37.594 INFO: Processes: 1
2025-07-24 12:42:37.594 INFO: MACE version: 0.3.14
2025-07-24 12:42:37.595 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='64x0e+64x1o+64x2e', edge_irreps=None, num_channels=64, max_L=2, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 12:42:37.595 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 12:42:37.698 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:42:37.745 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:42:37.755 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 12:42:37.763 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 12:42:38.138 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 12:42:38.139 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 12:42:38.139 INFO: ===========LOADING INPUT DATA===========
2025-07-24 12:42:38.139 INFO: Using heads: ['Default']
2025-07-24 12:42:38.139 INFO: Using the key specifications to parse data:
2025-07-24 12:42:38.139 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 12:42:38.139 INFO: =============    Processing head Default     ===========
2025-07-24 12:42:38.141 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 12:42:59.153 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:42:59.177 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:43:01.775 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:43:01.777 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:43:01.778 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 12:43:02.081 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 12:43:02.081 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 12:43:02.081 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 12:43:02.081 INFO: Processing datasets for head 'Default'
2025-07-24 12:44:31.421 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 12:44:31.422 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 12:44:42.756 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 12:44:42.756 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 12:44:42.756 INFO: Combined validation datasets for Default
2025-07-24 12:44:42.756 INFO: Head 'Default' training dataset size: 6337
2025-07-24 12:44:42.757 INFO: Computing average number of neighbors
2025-07-24 12:45:03.544 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 12:45:03.544 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 12:45:03.544 INFO: ===========MODEL DETAILS===========
2025-07-24 12:45:12.560 INFO: Loading FOUNDATION model
2025-07-24 12:45:12.562 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 12:45:12.562 INFO: Model configuration extracted from foundation model
2025-07-24 12:45:12.562 INFO: Using weighted loss function for fine-tuning
2025-07-24 12:45:12.562 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 12:45:12.562 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 12:45:12.562 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 12:45:12.562 INFO: Distance transform for radial basis functions: None
2025-07-24 12:45:14.024 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 12:45:14.025 INFO: Total number of parameters: 894362
2025-07-24 12:45:14.025 INFO: 
2025-07-24 12:45:14.025 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 12:45:14.025 INFO: Using ADAM as parameter optimizer
2025-07-24 12:45:14.025 INFO: Batch size: 1
2025-07-24 12:45:14.025 INFO: Number of gradient updates: 126740
2025-07-24 12:45:14.026 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 12:45:14.026 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=30.000)
2025-07-24 12:45:14.035 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 12:45:14.035 INFO: 
2025-07-24 12:45:14.035 INFO: ===========TRAINING===========
2025-07-24 12:45:14.035 INFO: Started training, reporting errors on validation set
2025-07-24 12:45:14.035 INFO: Loss metrics on validation set
2025-07-24 12:47:31.766 INFO: Initial: head: Default, loss=88992.45910932, RMSE_E_per_atom=298278.68 meV, RMSE_F=  959.54 meV / A
2025-07-24 12:48:15.915 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 12:48:15.919 INFO: Process group initialized: True
2025-07-24 12:48:15.919 INFO: Processes: 1
2025-07-24 12:48:15.919 INFO: MACE version: 0.3.14
2025-07-24 12:48:15.919 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 12:48:15.919 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 12:48:16.014 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:48:16.018 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 12:48:16.026 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 12:48:16.035 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 12:48:16.367 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 12:48:16.368 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 12:48:16.368 INFO: ===========LOADING INPUT DATA===========
2025-07-24 12:48:16.368 INFO: Using heads: ['Default']
2025-07-24 12:48:16.368 INFO: Using the key specifications to parse data:
2025-07-24 12:48:16.368 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 12:48:16.368 INFO: =============    Processing head Default     ===========
2025-07-24 12:48:16.370 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 12:48:37.394 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:48:37.418 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 12:48:40.018 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:48:40.020 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 12:48:40.021 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 12:48:40.324 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 12:48:40.324 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 12:48:40.324 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 12:48:40.325 INFO: Processing datasets for head 'Default'
2025-07-24 12:50:03.591 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 12:50:03.592 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 12:50:13.055 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 12:50:13.055 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 12:50:13.055 INFO: Combined validation datasets for Default
2025-07-24 12:50:13.055 INFO: Head 'Default' training dataset size: 6337
2025-07-24 12:50:13.056 INFO: Computing average number of neighbors
2025-07-24 12:50:31.821 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 12:50:31.821 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 12:50:31.821 INFO: ===========MODEL DETAILS===========
2025-07-24 12:50:41.135 INFO: Loading FOUNDATION model
2025-07-24 12:50:41.137 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 12:50:41.137 INFO: Model configuration extracted from foundation model
2025-07-24 12:50:41.137 INFO: Using weighted loss function for fine-tuning
2025-07-24 12:50:41.137 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 12:50:41.137 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 12:50:41.137 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 12:50:41.137 INFO: Distance transform for radial basis functions: None
2025-07-24 12:50:42.596 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 12:50:42.597 INFO: Total number of parameters: 894362
2025-07-24 12:50:42.597 INFO: 
2025-07-24 12:50:42.597 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 12:50:42.597 INFO: Using ADAM as parameter optimizer
2025-07-24 12:50:42.597 INFO: Batch size: 1
2025-07-24 12:50:42.597 INFO: Number of gradient updates: 126740
2025-07-24 12:50:42.597 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 12:50:42.597 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=30.000)
2025-07-24 12:50:42.607 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 12:50:42.607 INFO: 
2025-07-24 12:50:42.607 INFO: ===========TRAINING===========
2025-07-24 12:50:42.607 INFO: Started training, reporting errors on validation set
2025-07-24 12:50:42.607 INFO: Loss metrics on validation set
2025-07-24 12:52:59.685 INFO: Initial: head: Default, loss=88992.45910932, RMSE_E_per_atom=298278.68 meV, RMSE_F=  959.54 meV / A
2025-07-24 14:10:37.209 INFO: Epoch 0: head: Default, loss=5.47675331, RMSE_E_per_atom= 2255.48 meV, RMSE_F=  121.32 meV / A
2025-07-24 14:10:37.212 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-0.pt
2025-07-24 15:26:45.072 INFO: Epoch 1: head: Default, loss=4.24057274, RMSE_E_per_atom= 1896.92 meV, RMSE_F=  146.53 meV / A
2025-07-24 15:26:45.074 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-0.pt
2025-07-24 15:26:45.211 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-1.pt
2025-07-24 16:42:46.828 INFO: Epoch 2: head: Default, loss=16.24643962, RMSE_E_per_atom= 4006.59 meV, RMSE_F=   84.09 meV / A
2025-07-24 17:58:07.667 INFO: Epoch 3: head: Default, loss=1.16893659, RMSE_E_per_atom=  995.70 meV, RMSE_F=   81.29 meV / A
2025-07-24 17:58:07.668 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-1.pt
2025-07-24 17:58:07.717 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-24 19:14:15.837 INFO: Epoch 4: head: Default, loss=4.59643208, RMSE_E_per_atom= 2109.61 meV, RMSE_F=   73.61 meV / A
2025-07-24 20:29:36.189 INFO: Epoch 5: head: Default, loss=10.45463253, RMSE_E_per_atom= 3217.57 meV, RMSE_F=   61.59 meV / A
2025-07-24 21:44:55.633 INFO: Epoch 6: head: Default, loss=3.12179175, RMSE_E_per_atom= 1727.74 meV, RMSE_F=   71.57 meV / A
2025-07-24 22:06:20.693 INFO: ===========VERIFYING SETTINGS===========
2025-07-24 22:06:20.697 INFO: Process group initialized: True
2025-07-24 22:06:20.697 INFO: Processes: 1
2025-07-24 22:06:20.697 INFO: MACE version: 0.3.14
2025-07-24 22:06:20.697 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.005, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=20.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=1, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-24 22:06:20.697 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-24 22:06:21.104 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 22:06:21.320 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-24 22:06:21.451 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-24 22:06:21.537 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-24 22:06:22.118 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-24 22:06:22.123 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-24 22:06:22.123 INFO: ===========LOADING INPUT DATA===========
2025-07-24 22:06:22.123 INFO: Using heads: ['Default']
2025-07-24 22:06:22.123 INFO: Using the key specifications to parse data:
2025-07-24 22:06:22.123 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-24 22:06:22.123 INFO: =============    Processing head Default     ===========
2025-07-24 22:06:22.174 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-24 22:06:43.237 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 22:06:43.256 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-24 22:06:45.840 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 22:06:45.842 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-24 22:06:45.842 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-24 22:06:46.146 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-24 22:06:46.146 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-24 22:06:46.146 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-24 22:06:46.146 INFO: Processing datasets for head 'Default'
2025-07-24 22:08:09.338 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-24 22:08:09.339 INFO: Combining 1 list datasets for head 'Default'
2025-07-24 22:08:18.799 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-24 22:08:18.799 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-24 22:08:18.800 INFO: Combined validation datasets for Default
2025-07-24 22:08:18.800 INFO: Head 'Default' training dataset size: 6337
2025-07-24 22:08:18.800 INFO: Computing average number of neighbors
2025-07-24 22:08:35.751 INFO: Average number of neighbors: 68.51401860530092
2025-07-24 22:08:35.752 INFO: During training the following quantities will be reported: energy, forces
2025-07-24 22:08:35.752 INFO: ===========MODEL DETAILS===========
2025-07-24 22:08:44.802 INFO: Loading FOUNDATION model
2025-07-24 22:08:44.805 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-24 22:08:44.805 INFO: Model configuration extracted from foundation model
2025-07-24 22:08:44.805 INFO: Using weighted loss function for fine-tuning
2025-07-24 22:08:44.805 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-24 22:08:44.805 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-24 22:08:44.805 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-24 22:08:44.805 INFO: Distance transform for radial basis functions: None
2025-07-24 22:08:46.678 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-24 22:08:46.679 INFO: Total number of parameters: 894362
2025-07-24 22:08:46.679 INFO: 
2025-07-24 22:08:46.679 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-24 22:08:46.679 INFO: Using ADAM as parameter optimizer
2025-07-24 22:08:46.679 INFO: Batch size: 1
2025-07-24 22:08:46.679 INFO: Number of gradient updates: 126740
2025-07-24 22:08:46.679 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-24 22:08:46.679 INFO: WeightedEnergyForcesLoss(energy_weight=20.000, forces_weight=30.000)
2025-07-24 22:08:46.767 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-24 22:08:46.768 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-24 22:08:48.767 INFO: Using gradient clipping with tolerance=10.000
2025-07-24 22:08:48.767 INFO: 
2025-07-24 22:08:48.767 INFO: ===========TRAINING===========
2025-07-24 22:08:48.767 INFO: Started training, reporting errors on validation set
2025-07-24 22:08:48.767 INFO: Loss metrics on validation set
2025-07-24 22:11:05.360 INFO: Initial: head: Default, loss=20.00597204, RMSE_E_per_atom=  995.70 meV, RMSE_F=   81.29 meV / A
2025-07-24 23:27:08.141 INFO: Epoch 3: head: Default, loss=54.92157216, RMSE_E_per_atom= 1654.58 meV, RMSE_F=   78.69 meV / A
2025-07-24 23:27:08.143 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-25 00:08:18.226 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 00:08:18.378 INFO: Process group initialized: True
2025-07-25 00:08:18.378 INFO: Processes: 1
2025-07-25 00:08:18.378 INFO: MACE version: 0.3.14
2025-07-25 00:08:18.379 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{3:-201.7093,8:-431.6112,40:-1275.9529,57:-857.6754}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='weighted', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=30.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 00:08:18.379 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 00:08:18.480 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 00:08:18.483 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 00:08:18.491 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 00:08:18.501 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 00:08:18.869 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 00:08:18.870 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 00:08:18.870 INFO: ===========LOADING INPUT DATA===========
2025-07-25 00:08:18.870 INFO: Using heads: ['Default']
2025-07-25 00:08:18.870 INFO: Using the key specifications to parse data:
2025-07-25 00:08:18.870 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 00:08:18.871 INFO: =============    Processing head Default     ===========
2025-07-25 00:08:18.871 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 00:08:39.925 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-25 00:08:39.946 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-25 00:08:42.577 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-25 00:08:42.580 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-25 00:08:42.580 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 00:08:42.883 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 00:08:42.883 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 00:08:42.883 INFO: Atomic Energies used (z: eV) for head Default: {3: -201.7093, 8: -431.6112, 40: -1275.9529, 57: -857.6754}
2025-07-25 00:08:42.883 INFO: Processing datasets for head 'Default'
2025-07-25 00:10:06.513 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 00:10:06.514 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 00:10:16.060 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 00:10:16.060 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 00:10:16.060 INFO: Combined validation datasets for Default
2025-07-25 00:10:16.060 INFO: Head 'Default' training dataset size: 6337
2025-07-25 00:10:16.060 INFO: Computing average number of neighbors
2025-07-25 00:10:24.757 INFO: Average number of neighbors: 68.51401860530092
2025-07-25 00:10:24.757 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 00:10:24.758 INFO: ===========MODEL DETAILS===========
2025-07-25 00:10:32.207 INFO: Loading FOUNDATION model
2025-07-25 00:10:32.209 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 00:10:32.209 INFO: Model configuration extracted from foundation model
2025-07-25 00:10:32.209 INFO: Using weighted loss function for fine-tuning
2025-07-25 00:10:32.209 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 00:10:32.209 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 00:10:32.209 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 00:10:32.209 INFO: Distance transform for radial basis functions: None
2025-07-25 00:10:33.583 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-201.7093, -431.6112, -1275.9529, -857.6754]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 00:10:33.585 INFO: Total number of parameters: 894362
2025-07-25 00:10:33.585 INFO: 
2025-07-25 00:10:33.585 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 00:10:33.585 INFO: Using ADAM as parameter optimizer
2025-07-25 00:10:33.585 INFO: Batch size: 2
2025-07-25 00:10:33.585 INFO: Number of gradient updates: 63370
2025-07-25 00:10:33.585 INFO: Learning rate: 0.01, weight decay: 5e-07
2025-07-25 00:10:33.585 INFO: WeightedEnergyForcesLoss(energy_weight=30.000, forces_weight=30.000)
2025-07-25 00:10:33.588 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 00:10:33.588 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-25 00:10:33.640 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 00:10:33.640 INFO: 
2025-07-25 00:10:33.640 INFO: ===========TRAINING===========
2025-07-25 00:10:33.640 INFO: Started training, reporting errors on validation set
2025-07-25 00:10:33.640 INFO: Loss metrics on validation set
2025-07-25 00:11:48.732 INFO: Initial: head: Default, loss=82.29808241, RMSE_E_per_atom= 1654.58 meV, RMSE_F=   78.69 meV / A
2025-07-25 00:43:59.388 INFO: Epoch 3: head: Default, loss=219.03969845, RMSE_E_per_atom= 2700.67 meV, RMSE_F=   91.49 meV / A
2025-07-25 00:43:59.389 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-25 01:03:23.619 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 01:03:23.801 INFO: Process group initialized: True
2025-07-25 01:03:23.801 INFO: Processes: 1
2025-07-25 01:03:23.801 INFO: MACE version: 0.3.14
2025-07-25 01:03:23.801 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=True, launcher='slurm', log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', apply_cutoff=True, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, use_reduced_cg=True, use_so3=False, use_agnostic_product=False, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', edge_irreps=None, num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', elec_temp_key='elec_temp', total_spin_key='total_spin', total_charge_key='total_charge', embedding_specs=None, skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=True, only_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 01:03:23.801 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 01:03:24.113 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:03:24.117 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:03:24.199 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 01:03:24.302 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 01:03:24.706 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 01:03:24.711 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 01:03:24.711 INFO: ===========LOADING INPUT DATA===========
2025-07-25 01:03:24.711 INFO: Using heads: ['Default']
2025-07-25 01:03:24.711 INFO: Using the key specifications to parse data:
2025-07-25 01:03:24.711 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head', 'elec_temp': 'elec_temp', 'total_charge': 'total_charge', 'total_spin': 'total_spin'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 01:03:24.712 INFO: =============    Processing head Default     ===========
2025-07-25 01:03:24.729 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 01:03:45.715 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-25 01:03:45.734 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 6337, charges: 0]
2025-07-25 01:03:48.324 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-25 01:03:48.326 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, elec_temp: 0, total_charge: 0, total_spin: 0, forces: 705, charges: 0]
2025-07-25 01:03:48.326 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 01:03:48.629 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 01:03:48.629 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 01:03:48.630 INFO: Computing average Atomic Energies using least squares regression
2025-07-25 01:03:48.739 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 01:03:48.739 INFO: Processing datasets for head 'Default'
2025-07-25 01:05:12.768 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 01:05:12.769 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 01:05:22.278 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 01:05:22.278 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 01:05:22.278 INFO: Combined validation datasets for Default
2025-07-25 01:05:22.278 INFO: Head 'Default' training dataset size: 6337
2025-07-25 01:05:22.279 INFO: Computing average number of neighbors
2025-07-25 01:05:31.042 INFO: Average number of neighbors: 68.51401860530092
2025-07-25 01:05:31.042 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 01:05:31.042 INFO: ===========MODEL DETAILS===========
2025-07-25 01:05:40.530 INFO: Loading FOUNDATION model
2025-07-25 01:05:40.532 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 01:05:40.532 INFO: Model configuration extracted from foundation model
2025-07-25 01:05:40.532 INFO: Using universal loss function for fine-tuning
2025-07-25 01:05:40.532 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 01:05:40.532 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 01:05:40.532 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 01:05:40.532 INFO: Distance transform for radial basis functions: None
2025-07-25 01:05:41.964 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 01:05:41.966 INFO: Total number of parameters: 894362
2025-07-25 01:05:41.966 INFO: 
2025-07-25 01:05:41.966 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 01:05:41.966 INFO: Using ADAM as parameter optimizer
2025-07-25 01:05:41.966 INFO: Batch size: 2
2025-07-25 01:05:41.966 INFO: Number of gradient updates: 63370
2025-07-25 01:05:41.966 INFO: Learning rate: 0.0001, weight decay: 5e-07
2025-07-25 01:05:41.966 INFO: UniversalLoss(energy_weight=1.000, forces_weight=10.000, stress_weight=1.000)
2025-07-25 01:05:41.966 INFO: Converting model to CUEQ for accelerated training
2025-07-25 01:05:42.044 INFO: Creating new model with cuequivariance settings
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.1.linear_up.output_mask
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.1.conv_tp.output_mask
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.0.conv_tp.weight
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.1.linear_up.bias
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: readouts.1.linear_1.bias
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: radial_embedding.cutoff_fn.p
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.1.linear.bias
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.1.conv_tp.weight
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: products.0.linear.output_mask
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.1.skip_tp.output_mask
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: radial_embedding.bessel_fn.r_max
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_1_2
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: num_interactions
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: products.1.linear.output_mask
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: readouts.0.linear.output_mask
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: radial_embedding.cutoff_fn.r_max
2025-07-25 01:05:43.435 DEBUG: Transferring additional key: atomic_numbers
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: products.0.linear.bias
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: node_embedding.linear.bias
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_3_3
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_2_3
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: r_max
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.linear.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.0.linear.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: readouts.0.linear.bias
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_2_2
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: readouts.1.linear_1.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_3_2
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_2_1
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_3_1
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.0.skip_tp.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.0.linear_up.bias
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: readouts.1.linear_2.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: radial_embedding.bessel_fn.prefactor
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_1_3
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.0.conv_tp.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: products.1.linear.bias
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_1_1
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.0.linear.bias
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: interactions.0.linear_up.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: node_embedding.linear.output_mask
2025-07-25 01:05:43.436 DEBUG: Transferring additional key: readouts.1.linear_2.bias
2025-07-25 01:11:50.960 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 01:11:50.960 INFO: MACE version: 0.3.13
2025-07-25 01:11:50.960 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=4, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=True, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 01:11:51.622 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 01:11:51.897 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:11:51.900 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:11:51.920 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 01:11:51.941 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 01:11:52.299 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 01:11:52.302 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 01:11:52.302 INFO: ===========LOADING INPUT DATA===========
2025-07-25 01:11:52.302 INFO: Using heads: ['Default']
2025-07-25 01:11:52.302 INFO: Using the key specifications to parse data:
2025-07-25 01:11:52.302 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 01:11:52.302 INFO: =============    Processing head Default     ===========
2025-07-25 01:11:52.303 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 01:12:13.297 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 01:12:13.315 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 01:12:15.913 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 01:12:15.915 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 01:12:15.915 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 01:12:16.218 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 01:12:16.218 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 01:12:16.218 INFO: Computing average Atomic Energies using least squares regression
2025-07-25 01:12:16.257 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 01:12:16.257 INFO: Processing datasets for head 'Default'
2025-07-25 01:13:39.274 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 01:13:39.274 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 01:13:48.735 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 01:13:48.735 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 01:13:48.736 INFO: Combined validation datasets for Default
2025-07-25 01:13:48.736 INFO: Head 'Default' training dataset size: 6337
2025-07-25 01:13:48.736 INFO: Computing average number of neighbors
2025-07-25 01:13:54.613 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 01:13:54.614 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 01:13:54.614 INFO: ===========MODEL DETAILS===========
2025-07-25 01:14:00.188 INFO: Loading FOUNDATION model
2025-07-25 01:14:00.189 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 01:14:00.189 INFO: Model configuration extracted from foundation model
2025-07-25 01:14:00.190 INFO: Using universal loss function for fine-tuning
2025-07-25 01:14:00.190 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 01:14:00.190 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 01:14:00.190 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 01:14:00.190 INFO: Distance transform for radial basis functions: None
2025-07-25 01:14:01.605 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 01:14:01.606 INFO: Total number of parameters: 894362
2025-07-25 01:14:01.606 INFO: 
2025-07-25 01:14:01.606 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 01:14:01.606 INFO: Using ADAM as parameter optimizer
2025-07-25 01:14:01.606 INFO: Batch size: 4
2025-07-25 01:14:01.606 INFO: Number of gradient updates: 31685
2025-07-25 01:14:01.606 INFO: Learning rate: 0.0001, weight decay: 5e-07
2025-07-25 01:14:01.606 INFO: UniversalLoss(energy_weight=1.000, forces_weight=10.000, stress_weight=1.000)
2025-07-25 01:14:01.606 INFO: Converting model to CUEQ for accelerated training
2025-07-25 01:14:01.684 INFO: Creating new model with cuequivariance settings
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_3_3
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: num_interactions
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: r_max
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: radial_embedding.bessel_fn.r_max
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_2_1
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.0.linear.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: readouts.1.linear_2.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: atomic_numbers
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: readouts.1.linear_2.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.0.linear_up.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.0.linear_up.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.linear_up.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_2_3
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: node_embedding.linear.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: readouts.0.linear.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp.weight
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: radial_embedding.cutoff_fn.r_max
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.0.linear.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: readouts.1.linear_1.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: products.0.linear.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_1_2
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: products.1.linear.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.0.skip_tp.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: node_embedding.linear.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_1_1
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: readouts.0.linear.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.0.conv_tp.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: radial_embedding.cutoff_fn.p
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.linear_up.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.linear.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: products.1.linear.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_2_2
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: products.0.linear.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.linear.bias
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.0.conv_tp.weight
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: radial_embedding.bessel_fn.prefactor
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_3_1
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_1_3
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.skip_tp.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: readouts.1.linear_1.output_mask
2025-07-25 01:14:03.055 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_3_2
2025-07-25 01:27:13.058 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 01:27:13.058 INFO: MACE version: 0.3.13
2025-07-25 01:27:13.058 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='average', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file='mp', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=4, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=True, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 01:27:13.778 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 01:27:14.068 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:27:14.072 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:27:14.080 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 01:27:14.088 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 01:27:15.396 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 01:59:43.304 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 01:59:43.304 INFO: MACE version: 0.3.13
2025-07-25 01:59:43.304 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3:-3.4821, 8:-7.2846, 40:-11.8470, 57:-15.2830}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file='mp', pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=4, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=True, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 01:59:43.713 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 01:59:43.950 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:59:43.955 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 01:59:43.980 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 01:59:44.004 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 01:59:44.366 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 01:59:44.367 INFO: Multihead finetuning mode, setting learning rate to 0.0001 and EMA to True. To use a different learning rate, set --force_mh_ft_lr=True.
2025-07-25 01:59:44.367 INFO: Using multiheads finetuning mode, setting learning rate to 0.0001 and EMA to True
2025-07-25 01:59:44.367 INFO: Using foundation model for multiheads finetuning with Materials Project data
2025-07-25 01:59:44.367 INFO: ===========LOADING INPUT DATA===========
2025-07-25 01:59:44.367 INFO: Using heads: ['Default', 'pt_head']
2025-07-25 01:59:44.367 INFO: Using the key specifications to parse data:
2025-07-25 01:59:44.367 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 01:59:44.367 INFO: pt_head: KeySpecification(info_keys={'energy': 'energy', 'stress': 'stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'forces', 'charges': 'REF_charges'})
2025-07-25 01:59:44.367 INFO: =============    Processing head Default     ===========
2025-07-25 01:59:44.370 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 02:00:05.338 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:00:05.357 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:00:07.991 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:00:07.993 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:00:07.993 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 02:00:07.993 INFO: =============    Processing head pt_head     ===========
2025-07-25 02:00:07.993 INFO: Using the full Materials Project data for replay. You can construct a different subset using `fine_tuning_select.py` script.
2025-07-25 02:00:07.995 INFO: Downloading MP structures for finetuning
2025-07-25 02:02:56.636 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 02:02:56.636 INFO: MACE version: 0.3.13
2025-07-25 02:02:56.637 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3:-3.4821, 8:-7.2846, 40:-11.8470, 57:-15.2830}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=4, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=True, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 02:02:57.044 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 02:02:57.124 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 02:02:57.128 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 02:02:57.137 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 02:02:57.146 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 02:02:57.496 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 02:02:57.497 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 02:02:57.497 INFO: ===========LOADING INPUT DATA===========
2025-07-25 02:02:57.497 INFO: Using heads: ['Default']
2025-07-25 02:02:57.497 INFO: Using the key specifications to parse data:
2025-07-25 02:02:57.497 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 02:02:57.497 INFO: =============    Processing head Default     ===========
2025-07-25 02:02:57.499 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 02:03:18.489 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:03:18.507 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:03:21.127 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:03:21.129 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:03:21.129 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 02:03:21.130 INFO: Using atomic numbers from command line argument
2025-07-25 02:03:21.130 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 02:03:21.130 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 02:03:21.130 INFO: Atomic Energies used (z: eV) for head Default: {3: -3.4821, 8: -7.2846, 40: -11.847, 57: -15.283}
2025-07-25 02:03:21.130 INFO: Processing datasets for head 'Default'
2025-07-25 02:04:44.173 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 02:04:44.173 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 02:04:53.644 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 02:04:53.644 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 02:04:53.644 INFO: Combined validation datasets for Default
2025-07-25 02:04:53.644 INFO: Head 'Default' training dataset size: 6337
2025-07-25 02:04:53.645 INFO: Computing average number of neighbors
2025-07-25 02:04:59.406 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 02:04:59.407 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 02:04:59.407 INFO: ===========MODEL DETAILS===========
2025-07-25 02:05:04.964 INFO: Loading FOUNDATION model
2025-07-25 02:05:04.965 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 02:05:04.966 INFO: Model configuration extracted from foundation model
2025-07-25 02:05:04.966 INFO: Using universal loss function for fine-tuning
2025-07-25 02:05:04.966 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 02:05:04.966 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 02:05:04.966 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 02:05:04.966 INFO: Distance transform for radial basis functions: None
2025-07-25 02:05:06.353 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.4821, -7.2846, -11.8470, -15.2830]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 02:05:06.354 INFO: Total number of parameters: 894362
2025-07-25 02:05:06.354 INFO: 
2025-07-25 02:05:06.354 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 02:05:06.354 INFO: Using ADAM as parameter optimizer
2025-07-25 02:05:06.354 INFO: Batch size: 4
2025-07-25 02:05:06.354 INFO: Number of gradient updates: 31685
2025-07-25 02:05:06.354 INFO: Learning rate: 0.0001, weight decay: 5e-07
2025-07-25 02:05:06.354 INFO: UniversalLoss(energy_weight=1.000, forces_weight=10.000, stress_weight=1.000)
2025-07-25 02:05:06.354 INFO: Converting model to CUEQ for accelerated training
2025-07-25 02:05:06.432 INFO: Creating new model with cuequivariance settings
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: radial_embedding.cutoff_fn.r_max
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: radial_embedding.cutoff_fn.p
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: node_embedding.linear.output_mask
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_1_1
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.skip_tp.output_mask
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: readouts.1.linear_1.bias
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.linear.output_mask
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_3_1
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_1_2
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_1_3
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: readouts.1.linear_2.output_mask
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: readouts.0.linear.output_mask
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: readouts.0.linear.bias
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.0.conv_tp.output_mask
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: products.1.linear.bias
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_2_2
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: num_interactions
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.0.skip_tp.output_mask
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: atomic_numbers
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.0.linear_up.bias
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_2_3
2025-07-25 02:05:07.728 DEBUG: Transferring additional key: interactions.1.linear_up.output_mask
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: readouts.1.linear_1.output_mask
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.1.linear.bias
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.0.linear.output_mask
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_2_1
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.0.conv_tp.weight
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: readouts.1.linear_2.bias
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: products.0.linear.output_mask
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: radial_embedding.bessel_fn.r_max
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.1.conv_tp.weight
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: products.0.linear.bias
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: products.1.linear.output_mask
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.1.conv_tp.output_mask
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: node_embedding.linear.bias
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_1_3_2
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: r_max
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.1.linear_up.bias
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.0.linear_up.output_mask
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: radial_embedding.bessel_fn.prefactor
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.1.conv_tp._compiled_main_left_right._w3j_2_3_3
2025-07-25 02:05:07.729 DEBUG: Transferring additional key: interactions.0.linear.bias
2025-07-25 02:10:21.700 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 02:10:21.700 INFO: MACE version: 0.3.13
2025-07-25 02:10:21.700 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3:-3.4821, 8:-7.2846, 40:-11.8470, 57:-15.2830}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=4, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 02:10:22.142 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 02:10:22.205 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 02:10:22.209 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 02:10:22.215 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 02:10:22.220 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 02:10:22.555 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 02:10:22.556 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 02:10:22.556 INFO: ===========LOADING INPUT DATA===========
2025-07-25 02:10:22.556 INFO: Using heads: ['Default']
2025-07-25 02:10:22.556 INFO: Using the key specifications to parse data:
2025-07-25 02:10:22.556 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 02:10:22.556 INFO: =============    Processing head Default     ===========
2025-07-25 02:10:22.556 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 02:10:43.632 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:10:43.650 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:10:46.249 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:10:46.251 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:10:46.251 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 02:10:46.252 INFO: Using atomic numbers from command line argument
2025-07-25 02:10:46.252 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 02:10:46.252 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 02:10:46.252 INFO: Atomic Energies used (z: eV) for head Default: {3: -3.4821, 8: -7.2846, 40: -11.847, 57: -15.283}
2025-07-25 02:10:46.252 INFO: Processing datasets for head 'Default'
2025-07-25 02:12:10.414 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 02:12:10.414 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 02:12:19.885 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 02:12:19.885 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 02:12:19.885 INFO: Combined validation datasets for Default
2025-07-25 02:12:19.885 INFO: Head 'Default' training dataset size: 6337
2025-07-25 02:12:19.886 INFO: Computing average number of neighbors
2025-07-25 02:12:25.576 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 02:12:25.577 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 02:12:25.578 INFO: ===========MODEL DETAILS===========
2025-07-25 02:12:31.272 INFO: Loading FOUNDATION model
2025-07-25 02:12:31.273 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 02:12:31.274 INFO: Model configuration extracted from foundation model
2025-07-25 02:12:31.274 INFO: Using universal loss function for fine-tuning
2025-07-25 02:12:31.274 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 02:12:31.274 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 02:12:31.274 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 02:12:31.274 INFO: Distance transform for radial basis functions: None
2025-07-25 02:12:32.676 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.4821, -7.2846, -11.8470, -15.2830]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 02:12:32.677 INFO: Total number of parameters: 894362
2025-07-25 02:12:32.677 INFO: 
2025-07-25 02:12:32.677 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 02:12:32.677 INFO: Using ADAM as parameter optimizer
2025-07-25 02:12:32.677 INFO: Batch size: 4
2025-07-25 02:12:32.677 INFO: Number of gradient updates: 31685
2025-07-25 02:12:32.677 INFO: Learning rate: 0.0001, weight decay: 5e-07
2025-07-25 02:12:32.677 INFO: UniversalLoss(energy_weight=1.000, forces_weight=10.000, stress_weight=1.000)
2025-07-25 02:12:32.678 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 02:12:32.679 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-25 02:12:32.715 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 02:12:32.715 INFO: 
2025-07-25 02:12:32.715 INFO: ===========TRAINING===========
2025-07-25 02:12:32.715 INFO: Started training, reporting errors on validation set
2025-07-25 02:12:32.715 INFO: Loss metrics on validation set
2025-07-25 02:14:04.230 INFO: Initial: head: Default, loss=0.03163981, RMSE_E_per_atom= 2700.67 meV, RMSE_F=   91.49 meV / A, RMSE_stress=    6.60 meV / A^3
2025-07-25 02:15:05.930 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 02:15:05.930 INFO: MACE version: 0.3.13
2025-07-25 02:15:05.930 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3:-3.4821, 8:-7.2846, 40:-11.8470, 57:-15.2830}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 02:15:06.283 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 02:15:06.371 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 02:15:06.375 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 02:15:06.384 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 02:15:06.391 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 02:15:06.774 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 02:15:06.775 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 02:15:06.775 INFO: ===========LOADING INPUT DATA===========
2025-07-25 02:15:06.775 INFO: Using heads: ['Default']
2025-07-25 02:15:06.775 INFO: Using the key specifications to parse data:
2025-07-25 02:15:06.775 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 02:15:06.775 INFO: =============    Processing head Default     ===========
2025-07-25 02:15:06.776 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 02:15:27.746 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:15:27.765 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 02:15:30.366 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:15:30.368 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 02:15:30.368 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 02:15:30.368 INFO: Using atomic numbers from command line argument
2025-07-25 02:15:30.368 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 02:15:30.368 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 02:15:30.368 INFO: Atomic Energies used (z: eV) for head Default: {3: -3.4821, 8: -7.2846, 40: -11.847, 57: -15.283}
2025-07-25 02:15:30.368 INFO: Processing datasets for head 'Default'
2025-07-25 02:16:53.194 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 02:16:53.195 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 02:17:02.631 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 02:17:02.631 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 02:17:02.631 INFO: Combined validation datasets for Default
2025-07-25 02:17:02.631 INFO: Head 'Default' training dataset size: 6337
2025-07-25 02:17:02.632 INFO: Computing average number of neighbors
2025-07-25 02:17:10.646 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 02:17:10.647 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 02:17:10.647 INFO: ===========MODEL DETAILS===========
2025-07-25 02:17:17.549 INFO: Loading FOUNDATION model
2025-07-25 02:17:17.551 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 02:17:17.551 INFO: Model configuration extracted from foundation model
2025-07-25 02:17:17.551 INFO: Using universal loss function for fine-tuning
2025-07-25 02:17:17.551 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 02:17:17.551 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 02:17:17.551 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 02:17:17.551 INFO: Distance transform for radial basis functions: None
2025-07-25 02:17:18.946 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-3.4821, -7.2846, -11.8470, -15.2830]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 02:17:18.947 INFO: Total number of parameters: 894362
2025-07-25 02:17:18.947 INFO: 
2025-07-25 02:17:18.947 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 02:17:18.947 INFO: Using ADAM as parameter optimizer
2025-07-25 02:17:18.947 INFO: Batch size: 2
2025-07-25 02:17:18.947 INFO: Number of gradient updates: 63370
2025-07-25 02:17:18.948 INFO: Learning rate: 0.0001, weight decay: 5e-07
2025-07-25 02:17:18.948 INFO: UniversalLoss(energy_weight=1.000, forces_weight=10.000, stress_weight=1.000)
2025-07-25 02:17:18.951 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 02:17:18.952 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-25 02:17:18.995 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 02:17:18.995 INFO: 
2025-07-25 02:17:18.995 INFO: ===========TRAINING===========
2025-07-25 02:17:18.995 INFO: Started training, reporting errors on validation set
2025-07-25 02:17:18.995 INFO: Loss metrics on validation set
2025-07-25 02:18:48.960 INFO: Initial: head: Default, loss=0.03163981, RMSE_E_per_atom= 2700.67 meV, RMSE_F=   91.49 meV / A, RMSE_stress=    6.60 meV / A^3
2025-07-25 02:52:48.287 INFO: Epoch 3: head: Default, loss=0.00851291, RMSE_E_per_atom=  517.23 meV, RMSE_F=   88.35 meV / A, RMSE_stress=    5.75 meV / A^3
2025-07-25 02:52:48.289 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-25 03:26:46.050 INFO: Epoch 4: head: Default, loss=0.00829273, RMSE_E_per_atom=  495.94 meV, RMSE_F=   87.53 meV / A, RMSE_stress=    5.45 meV / A^3
2025-07-25 03:26:46.052 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-3.pt
2025-07-25 03:26:46.089 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-4.pt
2025-07-25 04:00:44.654 INFO: Epoch 5: head: Default, loss=0.00822647, RMSE_E_per_atom=  498.69 meV, RMSE_F=   86.96 meV / A, RMSE_stress=    5.29 meV / A^3
2025-07-25 04:00:44.656 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-4.pt
2025-07-25 04:00:44.754 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-5.pt
2025-07-25 04:34:42.816 INFO: Epoch 6: head: Default, loss=0.00819309, RMSE_E_per_atom=  504.01 meV, RMSE_F=   86.48 meV / A, RMSE_stress=    5.18 meV / A^3
2025-07-25 04:34:42.818 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-5.pt
2025-07-25 04:34:42.906 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-6.pt
2025-07-25 05:08:40.792 INFO: Epoch 7: head: Default, loss=0.00814681, RMSE_E_per_atom=  480.73 meV, RMSE_F=   86.06 meV / A, RMSE_stress=    5.10 meV / A^3
2025-07-25 05:08:40.795 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-6.pt
2025-07-25 05:08:40.843 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-7.pt
2025-07-25 05:42:38.119 INFO: Epoch 8: head: Default, loss=0.00809922, RMSE_E_per_atom=  489.92 meV, RMSE_F=   85.69 meV / A, RMSE_stress=    5.04 meV / A^3
2025-07-25 05:42:38.121 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-7.pt
2025-07-25 05:42:38.194 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-8.pt
2025-07-25 06:16:35.920 INFO: Epoch 9: head: Default, loss=0.00806594, RMSE_E_per_atom=  482.31 meV, RMSE_F=   85.35 meV / A, RMSE_stress=    4.99 meV / A^3
2025-07-25 06:16:35.921 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-8.pt
2025-07-25 06:16:36.132 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-9.pt
2025-07-25 06:50:34.173 INFO: Epoch 10: head: Default, loss=0.00803337, RMSE_E_per_atom=  481.17 meV, RMSE_F=   85.02 meV / A, RMSE_stress=    4.95 meV / A^3
2025-07-25 06:50:34.175 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-9.pt
2025-07-25 06:50:34.221 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-10.pt
2025-07-25 07:24:32.240 INFO: Epoch 11: head: Default, loss=0.00799911, RMSE_E_per_atom=  488.58 meV, RMSE_F=   84.73 meV / A, RMSE_stress=    4.92 meV / A^3
2025-07-25 07:24:32.242 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-10.pt
2025-07-25 07:24:32.315 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-11.pt
2025-07-25 07:58:30.585 INFO: Epoch 12: head: Default, loss=0.00797018, RMSE_E_per_atom=  489.33 meV, RMSE_F=   84.45 meV / A, RMSE_stress=    4.89 meV / A^3
2025-07-25 07:58:30.587 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-11.pt
2025-07-25 07:58:30.631 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-12.pt
2025-07-25 08:32:28.646 INFO: Epoch 13: head: Default, loss=0.00794118, RMSE_E_per_atom=  487.84 meV, RMSE_F=   84.18 meV / A, RMSE_stress=    4.87 meV / A^3
2025-07-25 08:32:28.648 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-12.pt
2025-07-25 08:32:28.800 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-13.pt
2025-07-25 09:02:00.516 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 09:02:00.516 INFO: MACE version: 0.3.13
2025-07-25 09:02:00.516 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='average', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=10000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=10.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 09:02:01.148 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 09:02:01.254 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 09:02:01.258 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 09:02:01.270 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 09:02:01.281 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 09:02:01.629 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 09:02:01.630 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 09:02:01.630 INFO: ===========LOADING INPUT DATA===========
2025-07-25 09:02:01.630 INFO: Using heads: ['Default']
2025-07-25 09:02:01.630 INFO: Using the key specifications to parse data:
2025-07-25 09:02:01.630 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 09:02:01.630 INFO: =============    Processing head Default     ===========
2025-07-25 09:02:01.631 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 09:02:47.075 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 09:02:47.075 INFO: MACE version: 0.3.13
2025-07-25 09:02:47.075 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='average', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=10.0, swa_forces_weight=100.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0001, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.99999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 09:02:47.620 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 09:02:47.696 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 09:02:47.700 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 09:02:47.706 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 09:02:47.711 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 09:02:48.107 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 09:02:48.108 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 09:02:48.108 INFO: ===========LOADING INPUT DATA===========
2025-07-25 09:02:48.108 INFO: Using heads: ['Default']
2025-07-25 09:02:48.108 INFO: Using the key specifications to parse data:
2025-07-25 09:02:48.108 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 09:02:48.108 INFO: =============    Processing head Default     ===========
2025-07-25 09:02:48.108 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 09:03:09.263 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 09:03:09.280 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 09:03:11.914 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 09:03:11.916 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 09:03:11.916 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 09:03:11.916 INFO: Using atomic numbers from command line argument
2025-07-25 09:03:11.916 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 09:03:11.917 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 09:03:11.917 INFO: Computing average Atomic Energies using least squares regression
2025-07-25 09:03:11.968 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 09:03:11.968 INFO: Processing datasets for head 'Default'
2025-07-25 09:04:34.906 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 09:04:34.906 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 09:04:44.320 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 09:04:44.320 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 09:04:44.320 INFO: Combined validation datasets for Default
2025-07-25 09:04:44.320 INFO: Head 'Default' training dataset size: 6337
2025-07-25 09:04:44.320 INFO: Computing average number of neighbors
2025-07-25 09:04:51.976 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 09:04:51.977 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 09:04:51.977 INFO: ===========MODEL DETAILS===========
2025-07-25 09:04:58.860 INFO: Loading FOUNDATION model
2025-07-25 09:04:58.862 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 09:04:58.862 INFO: Model configuration extracted from foundation model
2025-07-25 09:04:58.862 INFO: Using universal loss function for fine-tuning
2025-07-25 09:04:58.862 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 09:04:58.862 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 09:04:58.862 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 09:04:58.862 INFO: Distance transform for radial basis functions: None
2025-07-25 09:05:00.266 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 09:05:00.267 INFO: Total number of parameters: 894362
2025-07-25 09:05:00.267 INFO: 
2025-07-25 09:05:00.267 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 09:05:00.267 INFO: Using ADAM as parameter optimizer
2025-07-25 09:05:00.267 INFO: Batch size: 2
2025-07-25 09:05:00.267 INFO: Number of gradient updates: 63370
2025-07-25 09:05:00.267 INFO: Learning rate: 0.0001, weight decay: 5e-07
2025-07-25 09:05:00.267 INFO: UniversalLoss(energy_weight=1.000, forces_weight=10.000, stress_weight=1.000)
2025-07-25 09:05:00.269 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 09:05:00.270 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-13.pt
2025-07-25 09:05:00.556 INFO: Using gradient clipping with tolerance=10.000
2025-07-25 09:05:00.556 INFO: 
2025-07-25 09:05:00.556 INFO: ===========TRAINING===========
2025-07-25 09:05:00.556 INFO: Started training, reporting errors on validation set
2025-07-25 09:05:00.556 INFO: Loss metrics on validation set
2025-07-25 09:06:30.807 INFO: Initial: head: Default, loss=0.00794118, RMSE_E_per_atom=  487.84 meV, RMSE_F=   84.18 meV / A, RMSE_stress=    4.87 meV / A^3
2025-07-25 09:40:29.235 INFO: Epoch 13: head: Default, loss=0.00793038, RMSE_E_per_atom=  499.21 meV, RMSE_F=   83.93 meV / A, RMSE_stress=    4.85 meV / A^3
2025-07-25 09:40:29.238 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-13.pt
2025-07-25 10:14:24.086 INFO: Epoch 14: head: Default, loss=0.00788934, RMSE_E_per_atom=  479.05 meV, RMSE_F=   83.68 meV / A, RMSE_stress=    4.83 meV / A^3
2025-07-25 10:14:24.088 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-13.pt
2025-07-25 10:14:24.145 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-14.pt
2025-07-25 10:48:18.978 INFO: Epoch 15: head: Default, loss=0.00787378, RMSE_E_per_atom=  494.62 meV, RMSE_F=   83.45 meV / A, RMSE_stress=    4.81 meV / A^3
2025-07-25 10:48:18.979 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-14.pt
2025-07-25 10:48:19.091 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-15.pt
2025-07-25 11:22:14.557 INFO: Epoch 16: head: Default, loss=0.00785254, RMSE_E_per_atom=  495.51 meV, RMSE_F=   83.23 meV / A, RMSE_stress=    4.80 meV / A^3
2025-07-25 11:22:14.559 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-15.pt
2025-07-25 11:22:14.640 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-16.pt
2025-07-25 11:36:05.631 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 11:36:05.632 INFO: MACE version: 0.3.13
2025-07-25 11:36:05.632 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='average', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=30.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.001, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=3, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.9999, max_num_epochs=20, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=100.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 11:36:06.278 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 11:36:06.499 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 11:36:06.503 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 11:36:06.583 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 11:36:06.664 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 11:36:07.138 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 11:36:07.139 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 11:36:07.139 INFO: ===========LOADING INPUT DATA===========
2025-07-25 11:36:07.140 INFO: Using heads: ['Default']
2025-07-25 11:36:07.140 INFO: Using the key specifications to parse data:
2025-07-25 11:36:07.140 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 11:36:07.140 INFO: =============    Processing head Default     ===========
2025-07-25 11:36:07.142 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 11:36:28.495 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 11:36:28.513 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 11:36:31.170 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 11:36:31.172 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 11:36:31.172 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 11:36:31.172 INFO: Using atomic numbers from command line argument
2025-07-25 11:36:31.173 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 11:36:31.173 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 11:36:31.173 INFO: Computing average Atomic Energies using least squares regression
2025-07-25 11:36:31.226 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 11:36:31.226 INFO: Processing datasets for head 'Default'
2025-07-25 11:37:54.804 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 11:37:54.804 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 11:38:04.327 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 11:38:04.327 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 11:38:04.327 INFO: Combined validation datasets for Default
2025-07-25 11:38:04.327 INFO: Head 'Default' training dataset size: 6337
2025-07-25 11:38:04.328 INFO: Computing average number of neighbors
2025-07-25 11:38:12.174 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 11:38:12.176 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 11:38:12.176 INFO: ===========MODEL DETAILS===========
2025-07-25 11:38:19.146 INFO: Loading FOUNDATION model
2025-07-25 11:38:19.148 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 11:38:19.148 INFO: Model configuration extracted from foundation model
2025-07-25 11:38:19.148 INFO: Using universal loss function for fine-tuning
2025-07-25 11:38:19.148 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 11:38:19.148 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 11:38:19.148 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 11:38:19.148 INFO: Distance transform for radial basis functions: None
2025-07-25 11:38:20.503 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 11:38:20.504 INFO: Total number of parameters: 894362
2025-07-25 11:38:20.505 INFO: 
2025-07-25 11:38:20.505 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 11:38:20.505 INFO: Using ADAM as parameter optimizer
2025-07-25 11:38:20.505 INFO: Batch size: 2
2025-07-25 11:38:20.505 INFO: Number of gradient updates: 63370
2025-07-25 11:38:20.505 INFO: Learning rate: 0.001, weight decay: 1e-08
2025-07-25 11:38:20.505 INFO: UniversalLoss(energy_weight=100.000, forces_weight=30.000, stress_weight=1.000)
2025-07-25 11:38:20.524 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 11:38:20.525 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-16.pt
2025-07-25 11:38:20.562 INFO: Using gradient clipping with tolerance=100.000
2025-07-25 11:38:20.562 INFO: 
2025-07-25 11:38:20.562 INFO: ===========TRAINING===========
2025-07-25 11:38:20.562 INFO: Started training, reporting errors on validation set
2025-07-25 11:38:20.562 INFO: Loss metrics on validation set
2025-07-25 11:39:50.297 INFO: Initial: head: Default, loss=0.35828787, RMSE_E_per_atom=  495.51 meV, RMSE_F=   83.23 meV / A, RMSE_stress=    4.80 meV / A^3
2025-07-25 12:13:48.864 INFO: Epoch 16: head: Default, loss=0.31850428, RMSE_E_per_atom=  439.86 meV, RMSE_F=   84.37 meV / A, RMSE_stress=    6.12 meV / A^3
2025-07-25 12:13:48.866 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-16.pt
2025-07-25 12:47:44.686 INFO: Epoch 17: head: Default, loss=0.26792789, RMSE_E_per_atom=  367.54 meV, RMSE_F=   84.06 meV / A, RMSE_stress=    5.26 meV / A^3
2025-07-25 12:47:44.688 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-16.pt
2025-07-25 12:47:44.708 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-17.pt
2025-07-25 13:21:39.622 INFO: Epoch 18: head: Default, loss=0.56962896, RMSE_E_per_atom=  617.63 meV, RMSE_F=   85.06 meV / A, RMSE_stress=    5.35 meV / A^3
2025-07-25 13:55:38.946 INFO: Epoch 19: head: Default, loss=0.20694374, RMSE_E_per_atom=  231.34 meV, RMSE_F=   83.79 meV / A, RMSE_stress=    5.33 meV / A^3
2025-07-25 13:55:38.948 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-17.pt
2025-07-25 13:55:38.975 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-19.pt
2025-07-25 13:55:39.079 INFO: Training complete
2025-07-25 13:55:39.079 INFO: 
2025-07-25 13:55:39.079 INFO: ===========RESULTS===========
2025-07-25 13:55:39.082 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-19.pt
2025-07-25 13:55:39.116 INFO: Loaded Stage one model from epoch 19 for evaluation
2025-07-25 13:55:39.116 INFO: Saving model to checkpoints/mace_T1_finetune_scripted_run-42.model
2025-07-25 13:55:39.366 INFO: Compiling model, saving metadata to mace_T1_finetune_scripted_compiled.model
2025-07-25 13:55:39.956 INFO: Computing metrics for training, validation, and test sets
2025-07-25 13:55:39.957 INFO: Skipping evaluation for heads: ['pt_head']
2025-07-25 13:55:39.957 INFO: Evaluating train_Default ...
2025-07-25 14:10:28.513 INFO: Evaluating valid_Default ...
2025-07-25 14:11:56.393 INFO: Error-table on TRAIN and VALID:
+---------------+---------------------+------------------+-------------------+---------------------------------------+
|  config_type  | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % | RMSE Stress (Virials) / meV / A (A^3) |
+---------------+---------------------+------------------+-------------------+---------------------------------------+
| train_Default |          230.0      |         85.4     |         24.79     |                     5.7               |
| valid_Default |          231.3      |         83.8     |         24.38     |                     5.3               |
+---------------+---------------------+------------------+-------------------+---------------------------------------+
2025-07-25 14:11:56.394 DEBUG: Running inference on train_Default dataset
2025-07-25 14:25:50.372 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 14:25:50.373 INFO: MACE version: 0.3.13
2025-07-25 14:25:50.373 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='universal', forces_weight=50.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0003, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=3, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=40, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=30.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 14:25:51.092 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 14:25:51.201 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 14:25:51.205 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 14:25:51.212 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 14:25:51.221 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 14:25:51.632 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 14:25:51.633 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 14:25:51.634 INFO: ===========LOADING INPUT DATA===========
2025-07-25 14:25:51.634 INFO: Using heads: ['Default']
2025-07-25 14:25:51.634 INFO: Using the key specifications to parse data:
2025-07-25 14:25:51.634 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 14:25:51.634 INFO: =============    Processing head Default     ===========
2025-07-25 14:25:51.657 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 14:26:12.797 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 14:26:12.815 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 14:26:15.442 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 14:26:15.444 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 14:26:15.444 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 14:26:15.444 INFO: Using atomic numbers from command line argument
2025-07-25 14:26:15.444 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 14:26:15.444 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 14:26:15.444 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 14:26:15.444 INFO: Processing datasets for head 'Default'
2025-07-25 14:27:38.838 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 14:27:38.838 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 14:27:48.343 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 14:27:48.343 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 14:27:48.344 INFO: Combined validation datasets for Default
2025-07-25 14:27:48.344 INFO: Head 'Default' training dataset size: 6337
2025-07-25 14:27:48.344 INFO: Computing average number of neighbors
2025-07-25 14:27:55.960 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 14:27:55.962 INFO: During training the following quantities will be reported: energy, forces, stress
2025-07-25 14:27:55.962 INFO: ===========MODEL DETAILS===========
2025-07-25 14:28:02.959 INFO: Loading FOUNDATION model
2025-07-25 14:28:02.961 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 14:28:02.962 INFO: Model configuration extracted from foundation model
2025-07-25 14:28:02.962 INFO: Using universal loss function for fine-tuning
2025-07-25 14:28:02.962 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 14:28:02.962 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 14:28:02.962 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 14:28:02.962 INFO: Distance transform for radial basis functions: None
2025-07-25 14:28:04.347 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 14:28:04.349 INFO: Total number of parameters: 894362
2025-07-25 14:28:04.349 INFO: 
2025-07-25 14:28:04.349 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 14:28:04.349 INFO: Using ADAM as parameter optimizer
2025-07-25 14:28:04.349 INFO: Batch size: 2
2025-07-25 14:28:04.349 INFO: Number of gradient updates: 126740
2025-07-25 14:28:04.349 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 14:28:04.349 INFO: UniversalLoss(energy_weight=100.000, forces_weight=50.000, stress_weight=1.000)
2025-07-25 14:28:04.352 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 14:28:04.352 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-19.pt
2025-07-25 14:28:04.396 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 14:28:04.396 INFO: 
2025-07-25 14:28:04.396 INFO: ===========TRAINING===========
2025-07-25 14:28:04.396 INFO: Started training, reporting errors on validation set
2025-07-25 14:28:04.396 INFO: Loss metrics on validation set
2025-07-25 14:29:34.018 INFO: Initial: head: Default, loss=0.21565373, RMSE_E_per_atom=  231.34 meV, RMSE_F=   83.79 meV / A, RMSE_stress=    5.33 meV / A^3
2025-07-25 15:03:32.156 INFO: Epoch 19: head: Default, loss=0.18629218, RMSE_E_per_atom=  236.60 meV, RMSE_F=   84.61 meV / A, RMSE_stress=    6.15 meV / A^3
2025-07-25 15:03:32.158 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-19.pt
2025-07-25 15:37:27.787 INFO: Epoch 20: head: Default, loss=0.19035592, RMSE_E_per_atom=  198.57 meV, RMSE_F=   84.40 meV / A, RMSE_stress=    6.51 meV / A^3
2025-07-25 15:39:20.227 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 15:39:20.227 INFO: MACE version: 0.3.13
2025-07-25 15:39:20.227 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=50.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0003, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=3, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=40, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=30.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 15:39:20.837 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 15:39:21.147 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 15:39:21.151 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 15:39:21.234 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 15:39:21.334 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 15:39:21.723 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 15:39:21.724 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 15:39:21.724 INFO: ===========LOADING INPUT DATA===========
2025-07-25 15:39:21.724 INFO: Using heads: ['Default']
2025-07-25 15:39:21.724 INFO: Using the key specifications to parse data:
2025-07-25 15:39:21.724 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 15:39:21.724 INFO: =============    Processing head Default     ===========
2025-07-25 15:39:21.727 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 15:39:43.106 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 15:39:43.124 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 15:39:45.767 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 15:39:45.768 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 15:39:45.769 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 15:39:45.769 INFO: Using atomic numbers from command line argument
2025-07-25 15:39:45.769 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 15:39:45.769 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 15:39:45.769 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 15:39:45.769 INFO: Processing datasets for head 'Default'
2025-07-25 15:41:09.456 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 15:41:09.457 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 15:41:18.981 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 15:41:18.981 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 15:41:18.982 INFO: Combined validation datasets for Default
2025-07-25 15:41:18.982 INFO: Head 'Default' training dataset size: 6337
2025-07-25 15:41:18.982 INFO: Computing average number of neighbors
2025-07-25 15:41:27.052 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 15:41:27.053 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 15:41:27.053 INFO: ===========MODEL DETAILS===========
2025-07-25 15:41:33.900 INFO: Loading FOUNDATION model
2025-07-25 15:41:33.902 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 15:41:33.902 INFO: Model configuration extracted from foundation model
2025-07-25 15:41:33.903 INFO: Using universal loss function for fine-tuning
2025-07-25 15:41:33.903 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 15:41:33.903 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 15:41:33.903 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 15:41:33.903 INFO: Distance transform for radial basis functions: None
2025-07-25 15:41:35.284 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 15:41:35.285 INFO: Total number of parameters: 894362
2025-07-25 15:41:35.285 INFO: 
2025-07-25 15:41:35.285 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 15:41:35.285 INFO: Using ADAM as parameter optimizer
2025-07-25 15:41:35.285 INFO: Batch size: 2
2025-07-25 15:41:35.286 INFO: Number of gradient updates: 126740
2025-07-25 15:41:35.286 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 15:41:35.286 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=50.000)
2025-07-25 15:41:35.301 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 15:41:35.302 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-19.pt
2025-07-25 15:41:35.341 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 15:41:35.341 INFO: 
2025-07-25 15:41:35.341 INFO: ===========TRAINING===========
2025-07-25 15:41:35.341 INFO: Started training, reporting errors on validation set
2025-07-25 15:41:35.341 INFO: Loss metrics on validation set
2025-07-25 15:42:50.518 INFO: Initial: head: Default, loss=5.92628973, RMSE_E_per_atom=  236.60 meV, RMSE_F=   84.61 meV / A
2025-07-25 16:14:53.716 INFO: Epoch 19: head: Default, loss=4.24862951, RMSE_E_per_atom=  198.44 meV, RMSE_F=   82.18 meV / A
2025-07-25 16:14:53.718 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-19.pt
2025-07-25 16:46:54.219 INFO: Epoch 20: head: Default, loss=2.39036209, RMSE_E_per_atom=  144.46 meV, RMSE_F=   81.18 meV / A
2025-07-25 16:46:54.221 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-19.pt
2025-07-25 16:46:54.364 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-20.pt
2025-07-25 17:18:55.052 INFO: Epoch 21: head: Default, loss=2.40084339, RMSE_E_per_atom=  145.25 meV, RMSE_F=   79.53 meV / A
2025-07-25 17:50:55.997 INFO: Epoch 22: head: Default, loss=1.50461055, RMSE_E_per_atom=  110.78 meV, RMSE_F=   77.75 meV / A
2025-07-25 17:50:55.999 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-20.pt
2025-07-25 17:50:56.067 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-22.pt
2025-07-25 18:05:24.280 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 18:05:24.280 INFO: MACE version: 0.3.13
2025-07-25 18:05:24.280 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=20.0, swa_forces_weight=100.0, energy_weight=100.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0003, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=3, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=40, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=30.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 18:05:24.909 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 18:05:25.020 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 18:05:25.024 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 18:05:25.033 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 18:05:25.041 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 18:05:25.426 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 18:05:25.427 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 18:05:25.428 INFO: ===========LOADING INPUT DATA===========
2025-07-25 18:05:25.428 INFO: Using heads: ['Default']
2025-07-25 18:05:25.428 INFO: Using the key specifications to parse data:
2025-07-25 18:05:25.428 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 18:05:25.428 INFO: =============    Processing head Default     ===========
2025-07-25 18:05:25.430 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 18:05:46.717 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 18:05:46.735 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 18:05:49.375 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 18:05:49.377 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 18:05:49.377 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 18:05:49.378 INFO: Using atomic numbers from command line argument
2025-07-25 18:05:49.378 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 18:05:49.378 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 18:05:49.378 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 18:05:49.378 INFO: Processing datasets for head 'Default'
2025-07-25 18:07:12.968 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 18:07:12.969 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 18:07:22.480 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 18:07:22.480 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 18:07:22.480 INFO: Combined validation datasets for Default
2025-07-25 18:07:22.480 INFO: Head 'Default' training dataset size: 6337
2025-07-25 18:07:22.480 INFO: Computing average number of neighbors
2025-07-25 18:07:30.258 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 18:07:30.260 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 18:07:30.260 INFO: ===========MODEL DETAILS===========
2025-07-25 18:07:37.207 INFO: Loading FOUNDATION model
2025-07-25 18:07:37.209 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 18:07:37.209 INFO: Model configuration extracted from foundation model
2025-07-25 18:07:37.209 INFO: Using universal loss function for fine-tuning
2025-07-25 18:07:37.209 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 18:07:37.209 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 18:07:37.209 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 18:07:37.209 INFO: Distance transform for radial basis functions: None
2025-07-25 18:07:38.603 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 18:07:38.604 INFO: Total number of parameters: 894362
2025-07-25 18:07:38.604 INFO: 
2025-07-25 18:07:38.604 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 18:07:38.604 INFO: Using ADAM as parameter optimizer
2025-07-25 18:07:38.604 INFO: Batch size: 2
2025-07-25 18:07:38.604 INFO: Number of gradient updates: 126740
2025-07-25 18:07:38.604 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 18:07:38.604 INFO: WeightedEnergyForcesLoss(energy_weight=100.000, forces_weight=20.000)
2025-07-25 18:07:38.608 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 18:07:38.608 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-22.pt
2025-07-25 18:07:38.647 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 18:07:38.647 INFO: 
2025-07-25 18:07:38.647 INFO: ===========TRAINING===========
2025-07-25 18:07:38.647 INFO: Started training, reporting errors on validation set
2025-07-25 18:07:38.647 INFO: Loss metrics on validation set
2025-07-25 18:08:53.521 INFO: Initial: head: Default, loss=1.33823674, RMSE_E_per_atom=  110.78 meV, RMSE_F=   77.75 meV / A
2025-07-25 18:40:55.118 INFO: Epoch 22: head: Default, loss=2.14916819, RMSE_E_per_atom=  142.55 meV, RMSE_F=   79.64 meV / A
2025-07-25 18:40:55.120 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-22.pt
2025-07-25 19:12:54.194 INFO: Epoch 23: head: Default, loss=0.91708009, RMSE_E_per_atom=   89.58 meV, RMSE_F=   78.73 meV / A
2025-07-25 19:12:54.196 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-22.pt
2025-07-25 19:12:54.250 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-23.pt
2025-07-25 19:44:53.400 INFO: Epoch 24: head: Default, loss=0.19077654, RMSE_E_per_atom=   28.67 meV, RMSE_F=   76.79 meV / A
2025-07-25 19:44:53.402 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-23.pt
2025-07-25 19:44:53.498 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-24.pt
2025-07-25 20:16:53.390 INFO: Epoch 25: head: Default, loss=0.25923859, RMSE_E_per_atom=   39.59 meV, RMSE_F=   74.75 meV / A
2025-07-25 20:48:53.223 INFO: Epoch 26: head: Default, loss=0.15633438, RMSE_E_per_atom=   24.32 meV, RMSE_F=   72.93 meV / A
2025-07-25 20:48:53.225 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-24.pt
2025-07-25 20:48:53.268 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-26.pt
2025-07-25 21:16:42.586 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 21:16:42.586 INFO: MACE version: 0.3.13
2025-07-25 21:16:42.586 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=20.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0003, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=3, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=40, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=30.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 21:16:43.192 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 21:16:43.429 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 21:16:43.433 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 21:16:43.527 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 21:16:43.611 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 21:16:44.095 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 21:16:44.100 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 21:16:44.100 INFO: ===========LOADING INPUT DATA===========
2025-07-25 21:16:44.100 INFO: Using heads: ['Default']
2025-07-25 21:16:44.100 INFO: Using the key specifications to parse data:
2025-07-25 21:16:44.100 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 21:16:44.100 INFO: =============    Processing head Default     ===========
2025-07-25 21:16:44.118 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 21:17:05.217 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:17:05.236 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:17:07.835 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:17:07.837 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:17:07.837 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 21:17:07.838 INFO: Using atomic numbers from command line argument
2025-07-25 21:17:07.838 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 21:17:07.838 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 21:17:07.838 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 21:17:07.838 INFO: Processing datasets for head 'Default'
2025-07-25 21:18:31.483 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 21:18:31.483 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 21:18:40.983 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 21:18:40.983 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 21:18:40.983 INFO: Combined validation datasets for Default
2025-07-25 21:18:40.983 INFO: Head 'Default' training dataset size: 6337
2025-07-25 21:18:40.984 INFO: Computing average number of neighbors
2025-07-25 21:18:49.271 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 21:18:49.272 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 21:18:49.272 INFO: ===========MODEL DETAILS===========
2025-07-25 21:19:14.214 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 21:19:14.214 INFO: MACE version: 0.3.13
2025-07-25 21:19:14.214 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=20.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0003, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=3, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=40, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=30.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 21:19:14.923 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 21:19:15.022 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 21:19:15.025 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 21:19:15.032 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 21:19:15.040 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 21:19:15.418 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 21:19:15.419 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 21:19:15.419 INFO: ===========LOADING INPUT DATA===========
2025-07-25 21:19:15.419 INFO: Using heads: ['Default']
2025-07-25 21:19:15.419 INFO: Using the key specifications to parse data:
2025-07-25 21:19:15.419 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 21:19:15.419 INFO: =============    Processing head Default     ===========
2025-07-25 21:19:15.419 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 21:19:36.762 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:19:36.780 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:19:39.432 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:19:39.434 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:19:39.434 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 21:19:39.434 INFO: Using atomic numbers from command line argument
2025-07-25 21:19:39.434 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 21:19:39.435 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 21:19:39.435 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 21:19:39.435 INFO: Processing datasets for head 'Default'
2025-07-25 21:21:02.997 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 21:21:02.997 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 21:21:12.510 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 21:21:12.510 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 21:21:12.510 INFO: Combined validation datasets for Default
2025-07-25 21:21:12.510 INFO: Head 'Default' training dataset size: 6337
2025-07-25 21:21:12.510 INFO: Computing average number of neighbors
2025-07-25 21:21:20.270 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 21:21:20.271 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 21:21:20.271 INFO: ===========MODEL DETAILS===========
2025-07-25 21:21:27.343 INFO: Loading FOUNDATION model
2025-07-25 21:21:27.345 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 21:21:27.345 INFO: Model configuration extracted from foundation model
2025-07-25 21:21:27.345 INFO: Using universal loss function for fine-tuning
2025-07-25 21:21:27.345 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 21:21:27.345 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 21:21:27.345 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 21:21:27.345 INFO: Distance transform for radial basis functions: None
2025-07-25 21:21:28.733 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 21:21:28.734 INFO: Total number of parameters: 894362
2025-07-25 21:21:28.734 INFO: 
2025-07-25 21:21:28.735 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 21:21:28.735 INFO: Using ADAM as parameter optimizer
2025-07-25 21:21:28.735 INFO: Batch size: 2
2025-07-25 21:21:28.735 INFO: Number of gradient updates: 126740
2025-07-25 21:21:28.735 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 21:21:28.735 INFO: WeightedEnergyForcesLoss(energy_weight=20.000, forces_weight=100.000)
2025-07-25 21:21:28.737 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 21:21:28.738 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-26.pt
2025-07-25 21:21:28.783 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 21:21:28.783 INFO: 
2025-07-25 21:21:28.783 INFO: ===========TRAINING===========
2025-07-25 21:21:28.783 INFO: Started training, reporting errors on validation set
2025-07-25 21:21:28.783 INFO: Loss metrics on validation set
2025-07-25 21:22:43.973 INFO: Initial: head: Default, loss=0.49772447, RMSE_E_per_atom=   24.32 meV, RMSE_F=   72.93 meV / A
2025-07-25 21:25:41.353 INFO: ===========VERIFYING SETTINGS===========
2025-07-25 21:25:41.354 INFO: MACE version: 0.3.13
2025-07-25 21:25:41.354 DEBUG: Configuration: Namespace(config=None, name='mace_T1_finetune_scripted', seed=42, work_dir='.', log_dir='./logs', model_dir='.', checkpoints_dir='./checkpoints', results_dir='./results', downloads_dir='./downloads', device='cuda', default_dtype='float64', distributed=False, log_level='INFO', plot=True, plot_frequency=0, error_table='PerAtomRMSE', model='MACE', r_max=5.0, radial_type='bessel', num_radial_basis=8, num_cutoff_basis=5, pair_repulsion=False, distance_transform='None', interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', radial_MLP='[64, 64, 64]', hidden_irreps='128x0e + 128x1o', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz', valid_file='/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz', valid_fraction=0.1, test_file=None, test_dir=None, multi_processed_test=False, num_workers=0, pin_memory=True, atomic_numbers='[3,8,40,57]', mean=None, std=None, statistics_file=None, E0s='{3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}', foundation_filter_elements=True, heads=None, multiheads_finetuning=True, foundation_head=None, weight_pt_head=1.0, num_samples_pt=100000, force_mh_ft_lr=False, subselect_pt='random', filter_type_pt='none', pt_train_file=None, pt_valid_file=None, foundation_model_elements=False, keep_isolated_atoms=False, energy_key='REF_energy', forces_key='REF_forces', virials_key='REF_virials', stress_key='REF_stress', dipole_key='dipole', head_key='head', charges_key='REF_charges', skip_evaluate_heads='pt_head', loss='weighted', forces_weight=100.0, swa_forces_weight=100.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', huber_delta=0.01, optimizer='adam', beta=0.9, batch_size=2, valid_batch_size=1, lr=0.0003, swa_lr=0.001, weight_decay=1e-08, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=3, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, lbfgs=False, ema=False, ema_decay=0.999, max_num_epochs=40, patience=2048, foundation_model='/home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model', foundation_model_readout=False, eval_interval=1, keep_checkpoints=False, save_all_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=30.0, dry_run=False, enable_cueq=False, wandb=False, wandb_dir=None, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'], key_specification=KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'}))
2025-07-25 21:25:42.057 INFO: CUDA version: 12.6, CUDA device: 0
2025-07-25 21:25:42.159 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 21:25:42.163 DEBUG: Popen(['git', 'version'], cwd=/home/phanim/harshitrawat/summer, stdin=None, shell=False, universal_newlines=False)
2025-07-25 21:25:42.172 DEBUG: Popen(['git', 'cat-file', '--batch-check'], cwd=/home/phanim/harshitrawat/summer, stdin=<valid stream>, shell=False, universal_newlines=False)
2025-07-25 21:25:42.181 DEBUG: Current Git commit: 3e8417370b94173b2692e5be9381128eb3c4758f
2025-07-25 21:25:42.574 INFO: Using foundation model /home/phanim/harshitrawat/summer/mace_models/universal_new/2024-01-07-mace-128-L2_epoch-199.model as initial checkpoint.
2025-07-25 21:25:42.575 WARNING: Using multiheads finetuning with a foundation model that is not a Materials Project model, need to provied a path to a pretraining file with --pt_train_file.
2025-07-25 21:25:42.575 INFO: ===========LOADING INPUT DATA===========
2025-07-25 21:25:42.575 INFO: Using heads: ['Default']
2025-07-25 21:25:42.575 INFO: Using the key specifications to parse data:
2025-07-25 21:25:42.575 INFO: Default: KeySpecification(info_keys={'energy': 'REF_energy', 'stress': 'REF_stress', 'virials': 'REF_virials', 'dipole': 'dipole', 'head': 'head'}, arrays_keys={'forces': 'REF_forces', 'charges': 'REF_charges'})
2025-07-25 21:25:42.575 INFO: =============    Processing head Default     ===========
2025-07-25 21:25:42.576 DEBUG: Loading training file: /home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz
2025-07-25 21:26:03.716 INFO: Training set 1/1 [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:26:03.734 INFO: Total Training set [energy: 6337, stress: 0, virials: 0, dipole components: 0, head: 6337, forces: 6337, charges: 0]
2025-07-25 21:26:06.357 INFO: Validation set 1/1 [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:26:06.359 INFO: Total Validation set [energy: 705, stress: 0, virials: 0, dipole components: 0, head: 705, forces: 705, charges: 0]
2025-07-25 21:26:06.359 INFO: Total number of configurations: train=6337, valid=705, tests=[],
2025-07-25 21:26:06.359 INFO: Using atomic numbers from command line argument
2025-07-25 21:26:06.360 INFO: Atomic Numbers used: [3, 8, 40, 57]
2025-07-25 21:26:06.360 INFO: Isolated Atomic Energies (E0s) not in training file, using command line argument
2025-07-25 21:26:06.360 INFO: Atomic Energies used (z: eV) for head Default: {3: -1.2302615750354944, 8: -23.049110738413006, 40: 23.367646191010394, 57: 15.192898072498549}
2025-07-25 21:26:06.360 INFO: Processing datasets for head 'Default'
2025-07-25 21:27:29.815 DEBUG: Successfully loaded dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T1_chgnet_labeled.extxyz']
2025-07-25 21:27:29.815 INFO: Combining 1 list datasets for head 'Default'
2025-07-25 21:27:39.309 DEBUG: Successfully loaded validation dataset from ASE files: ['/home/phanim/harshitrawat/summer/final_work/T2_chgnet_labeled.extxyz']
2025-07-25 21:27:39.309 INFO: Combining 1 list datasets for head 'Default_valid'
2025-07-25 21:27:39.309 INFO: Combined validation datasets for Default
2025-07-25 21:27:39.309 INFO: Head 'Default' training dataset size: 6337
2025-07-25 21:27:39.310 INFO: Computing average number of neighbors
2025-07-25 21:27:47.491 INFO: Average number of neighbors: 68.51557639403025
2025-07-25 21:27:47.492 INFO: During training the following quantities will be reported: energy, forces
2025-07-25 21:27:47.492 INFO: ===========MODEL DETAILS===========
2025-07-25 21:27:54.433 INFO: Loading FOUNDATION model
2025-07-25 21:27:54.435 INFO: Using filtered elements: [3, 8, 40, 57]
2025-07-25 21:27:54.435 INFO: Model configuration extracted from foundation model
2025-07-25 21:27:54.435 INFO: Using universal loss function for fine-tuning
2025-07-25 21:27:54.435 INFO: Message passing with hidden irreps 128x0e+128x1o+128x2e)
2025-07-25 21:27:54.435 INFO: 2 layers, each with correlation order: 3 (body order: 4) and spherical harmonics up to: l=3
2025-07-25 21:27:54.435 INFO: Radial cutoff: 6.0 A (total receptive field for each atom: 12.0 A)
2025-07-25 21:27:54.435 INFO: Distance transform for radial basis functions: None
2025-07-25 21:27:55.854 DEBUG: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 128x0e | 512 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=6.0, num_basis=10, trainable=True)
    (cutoff_fn): PolynomialCutoff(p=5, r_max=6.0)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[[-1.2303, -23.0491, 23.3676, 15.1929]])
  (interactions): ModuleList(
    (0): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
      (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 512]
      (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e x 4x0e -> 128x0e+128x1o+128x2e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
      (conv_tp): TensorProduct(128x0e+128x1o+128x2e x 1x0e+1x1o+1x2e+1x3o -> 384x0e+640x1o+640x2e+512x3o | 2176 paths | 2176 weights)
      (conv_tp_weights): FullyConnectedNet[10, 64, 64, 64, 2176]
      (linear): Linear(128x0e+128x0e+128x0e+128x1o+128x1o+128x1o+128x1o+128x1o+128x2e+128x2e+128x2e+128x2e+128x2e+128x3o+128x3o+128x3o+128x3o -> 128x0e+128x1o+128x2e+128x3o | 278528 weights)
      (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o+128x2e x 4x0e -> 128x0e | 65536 paths | 65536 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (1): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x6x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
          (2): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x7x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e+128x1o+128x2e -> 128x0e+128x1o+128x2e | 49152 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x128 (cuda:0)]
                (1): Parameter containing: [torch.float64 of size 4x1x128 (cuda:0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(128x0e -> 128x0e | 16384 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(128x0e+128x1o+128x2e -> 1x0e | 128 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=0.8042, shift=0.1641)
)
2025-07-25 21:27:55.855 INFO: Total number of parameters: 894362
2025-07-25 21:27:55.855 INFO: 
2025-07-25 21:27:55.855 INFO: ===========OPTIMIZER INFORMATION===========
2025-07-25 21:27:55.855 INFO: Using ADAM as parameter optimizer
2025-07-25 21:27:55.855 INFO: Batch size: 2
2025-07-25 21:27:55.855 INFO: Number of gradient updates: 126740
2025-07-25 21:27:55.855 INFO: Learning rate: 0.0003, weight decay: 1e-08
2025-07-25 21:27:55.855 INFO: WeightedEnergyForcesLoss(energy_weight=5.000, forces_weight=100.000)
2025-07-25 21:27:55.860 WARNING: No SWA checkpoint found, while SWA is enabled. Compare the swa_start parameter and the latest checkpoint.
2025-07-25 21:27:55.860 INFO: Loading checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-26.pt
2025-07-25 21:27:55.906 INFO: Using gradient clipping with tolerance=30.000
2025-07-25 21:27:55.906 INFO: 
2025-07-25 21:27:55.906 INFO: ===========TRAINING===========
2025-07-25 21:27:55.906 INFO: Started training, reporting errors on validation set
2025-07-25 21:27:55.906 INFO: Loss metrics on validation set
2025-07-25 21:29:10.714 INFO: Initial: head: Default, loss=0.48885111, RMSE_E_per_atom=   24.32 meV, RMSE_F=   72.93 meV / A
2025-07-25 22:01:13.528 INFO: Epoch 26: head: Default, loss=0.35001886, RMSE_E_per_atom=   28.68 meV, RMSE_F=   62.00 meV / A
2025-07-25 22:01:13.531 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-26.pt
2025-07-25 22:33:12.861 INFO: Epoch 27: head: Default, loss=0.30569820, RMSE_E_per_atom=   15.26 meV, RMSE_F=   58.27 meV / A
2025-07-25 22:33:12.863 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-26.pt
2025-07-25 22:33:12.914 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-27.pt
2025-07-25 23:05:12.998 INFO: Epoch 28: head: Default, loss=0.28681651, RMSE_E_per_atom=   15.91 meV, RMSE_F=   56.54 meV / A
2025-07-25 23:05:13.001 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-27.pt
2025-07-25 23:05:13.041 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-28.pt
2025-07-25 23:37:13.170 INFO: Epoch 29: head: Default, loss=0.26539503, RMSE_E_per_atom=   11.62 meV, RMSE_F=   54.47 meV / A
2025-07-25 23:37:13.172 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-28.pt
2025-07-25 23:37:13.244 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-29.pt
2025-07-26 00:09:12.959 INFO: Epoch 30: head: Default, loss=0.24962891, RMSE_E_per_atom=    8.25 meV, RMSE_F=   52.78 meV / A
2025-07-26 00:09:12.961 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-29.pt
2025-07-26 00:09:12.986 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-30.pt
2025-07-26 00:41:14.056 INFO: Epoch 31: head: Default, loss=0.23721244, RMSE_E_per_atom=   12.99 meV, RMSE_F=   51.41 meV / A
2025-07-26 00:41:14.059 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-30.pt
2025-07-26 00:41:14.092 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-31.pt
2025-07-26 01:14:37.543 INFO: Epoch 32: head: Default, loss=0.22752978, RMSE_E_per_atom=   11.02 meV, RMSE_F=   50.46 meV / A
2025-07-26 01:14:37.545 DEBUG: Deleting old checkpoint file: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-31.pt
2025-07-26 01:14:37.580 DEBUG: Saving checkpoint: ./checkpoints/mace_T1_finetune_scripted_run-42_epoch-32.pt
